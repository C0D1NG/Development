!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Rf){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,u,n,i=t(Rf),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(n=u=u||{})[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";function h(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+r+"]  "+t.name+":"],n))}}var c={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},l=u.INFO,f=((e={})[u.DEBUG]="log",e[u.VERBOSE]="log",e[u.INFO]="info",e[u.WARN]="warn",e[u.ERROR]="error",e),p=(Object.defineProperty(v.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),v.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(v.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),v.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},v.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},v.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},v.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},v.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},v);function v(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var m,w="FirebaseError",b=(o(E,m=Error),E);function E(t,e){var n=m.call(this,e)||this;return n.code=t,n.name=w,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(A.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(T,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new b(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},A);function A(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var k,S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_={},O=S||self;function L(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),U=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:q).apply(null,arguments)}function j(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function G(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,C)&&t[C]||(t[C]=++U))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var W=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function $(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function X(t){return/^[\s\xa0]*$/.test(t)}var Q,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var J=O.navigator;if(J){var tt=J.userAgent;if(tt){Q=tt;break t}}Q=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e={};for(var n in t)e[n]=t[n];return e}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=L;var st,ut,at=K(Q,"Opera"),ht=K(Q,"Trident")||K(Q,"MSIE"),ct=K(Q,"Edge"),lt=ct||ht,ft=K(Q,"Gecko")&&!(K(Q.toLowerCase(),"webkit")&&!K(Q,"Edge"))&&!(K(Q,"Trident")||K(Q,"MSIE"))&&!K(Q,"Edge"),pt=K(Q.toLowerCase(),"webkit")&&!K(Q,"Edge");function dt(){var t=O.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=Q,ft?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt={};function wt(u){return t=u,e=function(){for(var t=0,e=Y(String(st)).split("."),n=Y(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=mt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var bt=O.document&&ht?dt()||(parseInt(st,10)||void 0):void 0,Et=!ht||9<=Number(bt),It=ht&&!wt("9"),At=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",L,e),O.removeEventListener("test",L,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Rt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},G(Nt,Tt);var Rt={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var kt="closure_listenable_"+(1e6*Math.random()|0),St=0;function _t(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++St,this.Y=this.Z=!1}function Ot(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Lt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=W(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(Ot(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}Lt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Vt="closure_lm_"+(1e6*Math.random()|0),Ct={};function Ut(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Wt(i);return e&&e[kt]?e.wa(n,i,V(r)?!!r.capture:!!r,o):Mt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ut(t,e[o],n,i,r);return null}return n=Wt(n),t&&t[kt]?t.va(e,n,V(i)?!!i.capture:!!i,r):Mt(t,e,n,!1,i,r)}function Mt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=V(r)?!!r.capture:!!r;if(s&&!Et)return null;var u,a,h=Gt(t);if(h||(t[Vt]=h=new Lt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=Ft,i=a=Et?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)At||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(xt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function qt(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[kt]?Dt(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(xt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Gt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Vt]=null)):Ot(t)))}function xt(t){return t in Ct?Ct[t]:Ct[t]="on"+t}function jt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&qt(t),n.call(i,e)}function Ft(t,e){if(t.Y)return!0;if(Et)return jt(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=O,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return jt(t,e=new Nt(e,this))}function Gt(t){return(t=t[Vt])instanceof Lt?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wt(e){return"function"==D(e)?e:(e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)}),e[Bt])}function zt(){B.call(this),this.c=new Lt(this),(this.J=this).C=null}function $t(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Dt(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}G(zt,B),zt.prototype[kt]=!0,(k=zt.prototype).addEventListener=function(t,e,n,i){Ut(this,t,e,n,i)},k.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=V(r)?!!r.capture:!!r,i=Wt(i),e&&e[kt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Pt(s=e.a[n],i,r,o))&&(Ot(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Gt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,i,r,o)),(i=-1<e?n[e]:null)&&qt(i))}(this,t,e,n,i)},k.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,rt(t=new Tt(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=$t(o,i,!0,t)&&s;if(s=$t(o=t.a=n,i,!0,t)&&s,s=$t(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=$t(o=t.a=e[r],i,!1,t)&&s;return s},k.G=function(){if(zt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Ot(n[i]);delete e.a[t],e.b--}}this.C=null},k.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},k.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Ht=O.JSON.stringify;function Xt(){this.b=this.a=null}var Qt,Yt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Zt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Zt(){this.next=this.b=this.a=null}function Jt(t,e){var n;Qt||(n=O.Promise.resolve(void 0),Qt=function(){n.then(ne)}),te||(Qt(),te=!0),ee.add(t,e)}Xt.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Xt;function ne(){for(var t,e,n;n=e=void 0,n=null,(e=ee).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var i=Yt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}te=!1}function ie(t,e){zt.call(this),this.b=t||1,this.a=e||O,this.f=x(this.Ya,this),this.g=F()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function oe(t,e,n){if("function"==D(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}G(ie,zt),(k=ie.prototype).aa=!1,k.M=null,k.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},k.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},k.G=function(){ie.S.G.call(this),re(this),delete this.a};var se,ue,ae,he=(N(ue=le,ae=se=B),ue.prototype=null===ae?Object.create(ae):(ce.prototype=ae.prototype,new ce),le.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=oe(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},le.prototype.G=function(){se.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},le);function ce(){this.constructor=ue}function le(t,e,n){var i=se.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function fe(t){B.call(this),this.b=t,this.a={}}G(fe,B);var pe=[];function de(t,e,n,i){Array.isArray(n)||(n&&(pe[0]=n.toString()),n=pe);for(var r=0;r<n.length;r++){var o=Ut(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ye(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&qt(t)},t),t.a={}}function ve(){this.a=!0}function ge(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}fe.prototype.G=function(){fe.S.G.call(this),ye(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var me=null;function we(){return me=me||new zt}function be(t){Tt.call(this,"serverreachability",t)}function Ee(t){var e=we();e.dispatchEvent(new be(e))}function Ie(t){Tt.call(this,"statevent",t)}function Ae(t){var e=we();e.dispatchEvent(new Ie(e))}function Te(t){Tt.call(this,"timingevent",t)}function Ne(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}G(be,Tt),G(Ie,Tt),G(Te,Tt);var Re={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ke={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Se.prototype.a=null;var Le,De={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Pe(){Tt.call(this,"d")}function Ve(){Tt.call(this,"c")}function Ce(){}function Ue(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new fe(this),this.P=Me,t=lt?125:void 0,this.R=new ie(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}G(Pe,Tt),G(Ve,Tt),G(Ce,Se),Le=new Ce;var Me=45e3,qe={},xe={};function je(t,e,n){t.H=1,t.i=an(en(e)),t.j=n,t.I=!0,Fe(t,null)}function Fe(t,e){t.u=F(),Be(t),t.l=en(t.i);var s,u,a,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),En(n.b,"t",i),t.D=0,t.a=di(t.g,t.g.C?e:null),0<t.O&&(t.F=new he(x(t.Ca,t,t.a),t.O)),de(t.J,t.a,"readystatechange",t.Wa),e=t.B?nt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ee(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ge(t,e,n){for(var i,r,o,s,u=!0;!t.A&&t.D<n.length;){var a=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?xe:(o=Number(r.substring(o,s)),isNaN(o)?qe:(s+=1)+o>r.length?xe:(r=r.substr(s,o),i.D=s+o,r)));if(a==xe){4==e&&(t.h=4,Ae(14),u=!1),ge(t.c,t.f,null,"[Incomplete Response]");break}if(a==qe){t.h=4,Ae(15),ge(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ge(t.c,t.f,a,null),Xe(t,a)}4==e&&0==n.length&&(t.h=1,Ae(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),si(e),e.F=!0)):(ge(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),$e(t))}function Be(t){t.U=F()+t.P,We(t,t.P)}function We(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ne(x(t.Ua,t),e)}function ze(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function $e(t){0==t.g.v||t.A||hi(t.g,t)}function He(t){ze(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),ye(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Xe(t,e){try{var n,i,r,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ai(p),Kn(p)}oi(p),Ae(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ne(x(p.Ra,p),6e3));if(kn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else li(p,11)}else if(!t.C&&p.a!=t||ai(p),!X(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(K(u,"spdy")||K(u,"quic")||K(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(_n(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,un(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=F()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=pi(o,o.C?o.ga:null,o.fa),c.C?(On(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(ze(l),Be(l)),o.a=c):ri(o),0<p.g.length&&ti(p)):"stop"!=y[0]&&"close"!=y[0]||li(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?li(p,7):Yn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}Ee(4)}catch(t){}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ye)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ze(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Ze(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(k=Ue.prototype).setTimeout=function(t){this.P=t},k.Wa=function(t){t=t.target;var e=this.F;e&&3==$n(t)?e.f():this.Ca(t)},k.Ca=function(t){try{if(t==this.a)t:{var e=$n(this.a),n=this.a.ua(),i=this.a.X();if(!(e<3||3==e&&!lt&&!this.a.$())){this.A||4!=e||7==n||Ee(8==n||i<=0?3:2),ze(this);var r=this.a.X();this.N=r;var o=this.a.$();if(this.b=200==r,h=this.c,c=this.m,l=this.l,f=this.f,p=this.T,d=e,y=r,h.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+p+"]: "+c+"\n"+l+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Ae(12),He(this),$e(this);break t}ge(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Xe(this,a)}this.I?(Ge(this,e,o),lt&&this.b&&3==e&&(de(this.J,this.R,"tick",this.Va),this.R.start())):(ge(this.c,this.f,o,null),Xe(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?hi(this.g,this):(this.b=!1,Be(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.h=3,Ae(12)):(this.h=0,Ae(13)),He(this),$e(this)}}}catch(t){}var h,c,l,f,p,d,y},k.Va=function(){var t,e;this.a&&(t=$n(this.a),e=this.a.$(),this.D<e.length&&(ze(this),Ge(this,t,e),this.b&&4!=t&&Be(this)))},k.cancel=function(){this.A=!0,He(this)},k.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(Ee(3),Ae(17)),He(this),this.h=2,$e(this)):We(this,this.U-n)},(k=Ye.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},k.L=function(){return Ke(this),this.a.concat()},k.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},k.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},k.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof tn?(this.a=void 0!==e?e:t.a,nn(this,t.f),this.j=t.j,rn(this,t.c),on(this,t.h),this.g=t.g,e=t.b,(n=new gn).c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),sn(this,n),this.i=t.i):t&&(n=String(t).match(Je))?(this.a=!!e,nn(this,n[1]||"",!0),this.j=hn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.g=hn(n[5]||"",!0),sn(this,n[6]||"",!0),this.i=hn(n[7]||"")):(this.a=!!e,this.b=new gn(null,this.a))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?hn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.c=n?hn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function sn(t,e,n){var i,r;e instanceof gn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(mn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},i)),i.f=r):(n||(e=cn(e,yn)),t.b=new gn(e,t.a))}function un(t,e,n){t.b.set(e,n)}function an(t){return un(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,vn)),t.join("")};var fn=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,yn=/[#\?@]/g,vn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new Ye,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i,r=t[n].indexOf("="),o=null;0<=r?(i=t[n].substring(0,r),o=t[n].substring(r+1)):i=t[n],e(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function bn(t,e){return mn(t),e=In(t,e),Ze(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),H(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function An(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||Nn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(k=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},k.forEach=function(n,i){mn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(i,t,e,this)},this)},this)},k.L=function(){mn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},k.K=function(t){mn(this);var e=[];if("string"==typeof t)bn(this,t)&&(e=$(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=$(e,t[n])}return e},k.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},k.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},k.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var Nn=10;function Rn(t){return t.b||t.a&&t.a.size>=t.f}function kn(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function On(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var i=t.c;try{for(var r=R(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Dn(){}function Pn(){this.a=new Dn}function Vn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}Tn.prototype.cancel=function(){var e,t;if(this.c=Ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Cn=O.JSON.parse;function Un(t){zt.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Mn,this.D=this.F=!1}G(Un,zt);var Mn="",qn=/^https?$/i,xn=["POST","PUT"];function jn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Gn(t),Wn(t)}function Gn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Bn(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=$n(t)||2!=t.X()))if(t.l&&4==$n(t))oe(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==$n(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Je)[1]||null)&&O.self&&O.self.location&&(r=(i=O.self.location.protocol).substr(0,i.length-1)),n=!qn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<$n(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Gn(t)}}finally{Wn(t)}}}function Wn(t,e){if(t.a){zn(t);var n=t.a,i=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function $n(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):un(t,e,n))}function Xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Qn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Xn("baseRetryDelayMs",5e3,t),this.Ma=Xn("retryDelaySeedMs",1e4,t),this.Ja=Xn("forwardChannelMaxRetries",2,t),this.ma=Xn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ka=new Pn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Yn(t){var e,n;Zn(t),3==t.v&&(e=t.R++,un(n=en(t.B),"SID",t.J),un(n,"RID",e),un(n,"TYPE","terminate"),ni(t,n),(e=new Ue(t,t.c,e,void 0)).H=2,e.i=an(en(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=di(e.g,null),e.a.ba(e.i)),e.u=F(),Be(e)),fi(t)}function Kn(t){t.a&&(si(t),t.a.cancel(),t.a=null)}function Zn(t){Kn(t),t.j&&(O.clearTimeout(t.j),t.j=null),ai(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new An(t.La++,e)),3==t.v&&ti(t)}function ti(t){Rn(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function ei(t,e){var n=e?e.f:t.R++,i=en(t.B);un(i,"SID",t.J),un(i,"RID",n),un(i,"AID",t.P),ni(t,i),t.i&&t.l&&Hn(i,t.i,t.l),n=new Ue(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ii(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),je(n,i,e)}function ni(t,n){t.f&&Qe({},function(t,e){un(n,e,t)})}function ii(t,e,n){n=Math.min(t.g.length,n);var i=t.f?x(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{!function(t,i,e){var r=e||"";try{Qe(t,function(t,e){var n=t;V(t)&&(n=Ht(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ri(t){t.a||t.j||(t.U=1,Jt(t.Aa,t),t.o=0)}function oi(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ne(x(t.Aa,t),ci(t,t.o)),t.o++,1)}function si(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function ui(t){t.a=new Ue(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=en(t.la);un(e,"RID","rpc"),un(e,"SID",t.J),un(e,"CI",t.H?"0":"1"),un(e,"AID",t.P),ni(t,e),un(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(en(e)),n.j=null,n.I=!0,Fe(n,t)}function ai(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function hi(t,e){var n,i=null;if(t.a==e){ai(t),si(t),t.a=null;var r=2}else{if(!Sn(t.b,e))return;i=e.s,On(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b){1==r?(i=e.j?e.j.length:0,e=F()-e.u,n=t.u,(r=we()).dispatchEvent(new Te(r)),ti(t)):ri(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(kn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ne(x(t.Ba,t,e),ci(t,t.u)),t.u++,1}}(t,e)||2==r&&oi(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:li(t,5);break;case 4:li(t,10);break;case 3:li(t,6);break;default:li(t,2)}}function ci(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function li(t,e){var n,i,r,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=x(t.Xa,t),n||(n=new tn("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||nn(n,"https"),an(n)),r=n.toString(),o=i,u=new ve,O.Image?((s=new Image).onload=j(Vn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=j(Vn,u,s,"TestLoadImage: error",!1,o),s.onabort=j(Vn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=j(Vn,u,s,"TestLoadImage: timeout",!1,o),O.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):Ae(2),t.v=0,t.f&&t.f.ra(e),fi(t),Zn(t)}function fi(t){t.v=0,t.I=-1,t.f&&(0==Ln(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function pi(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof tn?en(i):new tn(i,void 0);return""!=c.c?(e&&rn(c,e+"."+c.c),on(c,c.h)):(r=O.location,o=r.protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new tn(null,void 0),o&&nn(h,o),s&&rn(h,s),u&&on(h,u),a&&(h.g=a),c=h),t.W&&et(t.W,function(t,e){un(c,e,t)}),e=t.A,n=t.na,e&&n&&un(c,e,n),un(c,"VER",t.ha),ni(t,c),c}function di(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Un(t.Ka)).F=t.C,e}function yi(){}function vi(){if(ht&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function gi(t,e){zt.call(this),this.a=new Qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!X(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!X(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new bi(this)}function mi(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wi(){Ve.call(this),this.status=1}function bi(t){this.a=t}(k=Un.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Le),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Fn(this,t)}t=n||"";var r,o=new Ye(this.headers);i&&Qe(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=jn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=W(xn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zn(this),0<this.o&&((this.D=(r=this.a,ht&&wt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=oe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fn(this,t)}},k.xa=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},k.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Wn(this))},k.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Wn(this,!0)),Un.S.G.call(this)},k.za=function(){this.j||(this.A||this.l||this.g?Bn(this):this.Ta())},k.Ta=function(){Bn(this)},k.X=function(){try{return 2<$n(this)?this.a.status:-1}catch(t){return-1}},k.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},k.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},k.ua=function(){return this.h},k.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(k=Qn.prototype).ha=8,k.v=1,k.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ue(this,this.c,t,void 0),i=this.l;if(this.O&&(i?rt(i=nt(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ii(this,n,e),un(r=en(this.B),"RID",t),un(r,"CVER",22),this.A&&un(r,"X-HTTP-Session-Id",this.A),ni(this,r),this.i&&i&&Hn(r,this.i,i),_n(this.b,n),this.Ga&&un(r,"TYPE","init"),this.da?(un(r,"$req",e),un(r,"SID","null"),n.V=!0,je(n,r,null)):je(n,r,e),this.v=2}}else 3==this.v&&(t?ei(this,t):0==this.g.length||Rn(this.b)||ei(this))},k.Aa=function(){var t;this.j=null,ui(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ne(x(this.Sa,this),t))},k.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Kn(this),ui(this))},k.Ra=function(){null!=this.m&&(this.m=null,Kn(this),oi(this),Ae(19))},k.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Ae(2)):(this.c.info("Failed to ping google.com"),Ae(1))},(k=yi.prototype).ta=function(){},k.sa=function(){},k.ra=function(){},k.qa=function(){},k.Ha=function(){},vi.prototype.a=function(t,e){return new gi(t,e)},G(gi,zt),(k=gi.prototype).addEventListener=function(t,e,n,i){gi.S.addEventListener.call(this,t,e,n,i)},k.removeEventListener=function(t,e,n,i){gi.S.removeEventListener.call(this,t,e,n,i)},k.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ae(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=pi(t,null,t.fa),ti(t)},k.close=function(){Yn(this.a)},k.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Jn(this.a,e)):this.g?((e={}).__data__=Ht(t),Jn(this.a,e)):Jn(this.a,t)},k.G=function(){this.a.f=null,delete this.f,Yn(this.a),delete this.a,gi.S.G.call(this)},G(mi,Pe),G(wi,Ve),G(bi,yi),bi.prototype.ta=function(){this.a.dispatchEvent("a")},bi.prototype.sa=function(t){this.a.dispatchEvent(new mi(t))},bi.prototype.ra=function(t){this.a.dispatchEvent(new wi)},bi.prototype.qa=function(){this.a.dispatchEvent("b")},vi.prototype.createWebChannel=vi.prototype.a,gi.prototype.send=gi.prototype.Pa,gi.prototype.open=gi.prototype.Oa,Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,ke.COMPLETE="complete",(Oe.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",zt.prototype.listen=zt.prototype.va,Un.prototype.listenOnce=Un.prototype.wa,Un.prototype.getLastError=Un.prototype.Qa,Un.prototype.getLastErrorCode=Un.prototype.ua,Un.prototype.getStatus=Un.prototype.X,Un.prototype.getResponseJson=Un.prototype.Na,Un.prototype.getResponseText=Un.prototype.$,Un.prototype.send=Un.prototype.ba;var Ei={createWebChannelTransport:function(){return new vi},ErrorCode:Re,EventType:ke,WebChannel:Oe,XhrIo:Un},Ii=Ei.createWebChannelTransport,Ai=Ei.ErrorCode,Ti=Ei.EventType,Ni=Ei.WebChannel,Ri=Ei.XhrIo,ki=(Si.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Si.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Si.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Si);function Si(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var _i=new p("@firebase/firestore");function Oi(){return _i.logLevel}function Li(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=u.DEBUG&&(e=n.map(Vi),_i.debug.apply(_i,s(["Firestore (7.19.1): "+t],e)))}function Di(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=u.ERROR&&(e=n.map(Vi),_i.error.apply(_i,s(["Firestore (7.19.1): "+t],e)))}function Pi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];_i.logLevel<=u.WARN&&(e=n.map(Vi),_i.warn.apply(_i,s(["Firestore (7.19.1): "+t],e)))}function Vi(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ci(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw Di(e),new Error(e)}function Ui(t){t||Ci()}var Mi=(qi.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},qi);function qi(){}function xi(t,e){return t<e?-1:e<t?1:0}function ji(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Fi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Gi=(Object.defineProperty(Bi.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Bi.prototype.isEqual=function(t){return t instanceof Bi&&t.projectId===this.projectId&&t.database===this.database},Bi.prototype.o=function(t){return xi(this.projectId,t.projectId)||xi(this.database,t.database)},Bi);function Bi(t,e){this.projectId=t,this.database=e||"(default)"}function Wi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $i(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Hi,Xi,Qi,Yi=(pr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(this.u(s,t))return u}},pr.prototype.has=function(t){return void 0!==this.get(t)},pr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},pr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},pr.prototype.forEach=function(u){zi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},pr.prototype._=function(){return $i(this.l)},pr),Ki={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Zi=(o(fr,Qi=Error),fr),Ji=(lr.now=function(){return lr.fromMillis(Date.now())},lr.fromDate=function(t){return lr.fromMillis(t.getTime())},lr.fromMillis=function(t){var e=Math.floor(t/1e3);return new lr(e,1e6*(t-1e3*e))},lr.prototype.toDate=function(){return new Date(this.toMillis())},lr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},lr.prototype.m=function(t){return this.seconds===t.seconds?xi(this.nanoseconds,t.nanoseconds):xi(this.seconds,t.seconds)},lr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},lr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},lr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},lr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},lr),tr=(cr.T=function(t){return new cr(t)},cr.min=function(){return new cr(new Ji(0,0))},cr.prototype.o=function(t){return this.timestamp.m(t.timestamp)},cr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},cr.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},cr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},cr.prototype.R=function(){return this.timestamp},cr),er=(Object.defineProperty(hr.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),hr.prototype.isEqual=function(t){return 0===hr.P(this,t)},hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hr?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},hr.prototype.limit=function(){return this.offset+this.length},hr.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},hr.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},hr.prototype.v=function(){return this.segments[this.offset]},hr.prototype.S=function(){return this.get(this.length-1)},hr.prototype.get=function(t){return this.segments[this.offset+t]},hr.prototype._=function(){return 0===this.length},hr.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hr.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hr.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},hr.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hr),nr=(o(ar,Xi=er),ar.prototype.V=function(t,e,n){return new ar(t,e,n)},ar.prototype.N=function(){return this.F().join("/")},ar.prototype.toString=function(){return this.N()},ar.$=function(t){if(0<=t.indexOf("//"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ar(t.split("/").filter(function(t){return 0<t.length}))},ar.k=function(){return new ar([])},ar),ir=/^[_a-zA-Z][_a-zA-Z0-9]*$/,rr=(o(ur,Hi=er),ur.prototype.V=function(t,e,n){return new ur(t,e,n)},ur.O=function(t){return ir.test(t)},ur.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ur.O(t)||(t="`"+t+"`"),t}).join(".")},ur.prototype.toString=function(){return this.N()},ur.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},ur.M=function(){return new ur(["__name__"])},ur.q=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Zi(Ki.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Zi(Ki.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Zi(Ki.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ur(e)},ur.k=function(){return new ur([])},ur),or=(sr.U=function(t){return new sr(nr.$(t))},sr.B=function(t){return new sr(nr.$(t).p(5))},sr.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},sr.prototype.isEqual=function(t){return null!==t&&0===nr.P(this.path,t.path)},sr.prototype.toString=function(){return this.path.toString()},sr.P=function(t,e){return nr.P(t.path,e.path)},sr.j=function(t){return t.length%2==0},sr.G=function(t){return new sr(new nr(t.slice()))},sr);function sr(t){this.path=t}function ur(){return null!==Hi&&Hi.apply(this,arguments)||this}function ar(){return null!==Xi&&Xi.apply(this,arguments)||this}function hr(t,e,n){void 0===e?e=0:e>t.length&&Ci(),void 0===n?n=t.length-e:n>t.length-e&&Ci(),this.segments=t,this.offset=e,this.A=n}function cr(t){this.timestamp=t}function lr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Zi(Ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function fr(t,e){var n=this;return(n=Qi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function pr(t,e){this.h=t,this.u=e,this.l={}}function dr(t){return null==t}function yr(t){return-0===t&&1/t==-1/0}var vr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.K=null};function gr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new vr(t,e,n,i,r,o,s)}function mr(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+Eo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),dr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=zu(n.startAt)),n.endAt&&(e+="|ub:",e+=zu(n.endAt)),n.K=e),n.K}function wr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!go(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Hu(t.startAt,e.startAt)&&Hu(t.endAt,e.endAt)}function br(t){return or.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Er=(Ir.fromBase64String=function(t){return new Ir(atob(t))},Ir.fromUint8Array=function(t){return new Ir(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ir.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Ir.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Ir.prototype.Y=function(){return 2*this.H.length},Ir.prototype.o=function(t){return xi(this.H,t.H)},Ir.prototype.isEqual=function(t){return this.H===t.H},Ir);function Ir(t){this.H=t}Er.J=new Er("");function Ar(t){this.count=t}var Tr,Nr,Rr=(kr.prototype.tt=function(t){return new kr(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},kr.prototype.et=function(t,e){return new kr(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},kr.prototype.nt=function(t){return new kr(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},kr);function kr(t,e,n,i,r,o,s){void 0===r&&(r=tr.min()),void 0===o&&(o=tr.min()),void 0===s&&(s=Er.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.Z=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Sr(t){switch(t){case Ki.OK:return Ci(),0;case Ki.CANCELLED:case Ki.UNKNOWN:case Ki.DEADLINE_EXCEEDED:case Ki.RESOURCE_EXHAUSTED:case Ki.INTERNAL:case Ki.UNAVAILABLE:case Ki.UNAUTHENTICATED:return;case Ki.INVALID_ARGUMENT:case Ki.NOT_FOUND:case Ki.ALREADY_EXISTS:case Ki.PERMISSION_DENIED:case Ki.FAILED_PRECONDITION:case Ki.ABORTED:case Ki.OUT_OF_RANGE:case Ki.UNIMPLEMENTED:case Ki.DATA_LOSS:return 1;default:return Ci(),0}}function _r(t){if(void 0===t)return Di("GRPC error has no .code"),Ki.UNKNOWN;switch(t){case Tr.OK:return Ki.OK;case Tr.CANCELLED:return Ki.CANCELLED;case Tr.UNKNOWN:return Ki.UNKNOWN;case Tr.DEADLINE_EXCEEDED:return Ki.DEADLINE_EXCEEDED;case Tr.RESOURCE_EXHAUSTED:return Ki.RESOURCE_EXHAUSTED;case Tr.INTERNAL:return Ki.INTERNAL;case Tr.UNAVAILABLE:return Ki.UNAVAILABLE;case Tr.UNAUTHENTICATED:return Ki.UNAUTHENTICATED;case Tr.INVALID_ARGUMENT:return Ki.INVALID_ARGUMENT;case Tr.NOT_FOUND:return Ki.NOT_FOUND;case Tr.ALREADY_EXISTS:return Ki.ALREADY_EXISTS;case Tr.PERMISSION_DENIED:return Ki.PERMISSION_DENIED;case Tr.FAILED_PRECONDITION:return Ki.FAILED_PRECONDITION;case Tr.ABORTED:return Ki.ABORTED;case Tr.OUT_OF_RANGE:return Ki.OUT_OF_RANGE;case Tr.UNIMPLEMENTED:return Ki.UNIMPLEMENTED;case Tr.DATA_LOSS:return Ki.DATA_LOSS;default:return Ci()}}(Nr=Tr=Tr||{})[Nr.OK=0]="OK",Nr[Nr.CANCELLED=1]="CANCELLED",Nr[Nr.UNKNOWN=2]="UNKNOWN",Nr[Nr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nr[Nr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nr[Nr.NOT_FOUND=5]="NOT_FOUND",Nr[Nr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nr[Nr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nr[Nr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nr[Nr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nr[Nr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nr[Nr.ABORTED=10]="ABORTED",Nr[Nr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nr[Nr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nr[Nr.INTERNAL=13]="INTERNAL",Nr[Nr.UNAVAILABLE=14]="UNAVAILABLE",Nr[Nr.DATA_LOSS=15]="DATA_LOSS";var Or=(Cr.prototype.st=function(t,e){return new Cr(this.P,this.root.st(t,e,this.P).copy(null,null,Dr.it,null,null))},Cr.prototype.remove=function(t){return new Cr(this.P,this.root.remove(t,this.P).copy(null,null,Dr.it,null,null))},Cr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Cr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Cr.prototype._=function(){return this.root._()},Object.defineProperty(Cr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Cr.prototype.rt=function(){return this.root.rt()},Cr.prototype.ot=function(){return this.root.ot()},Cr.prototype.ht=function(t){return this.root.ht(t)},Cr.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Cr.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Cr.prototype.at=function(t){return this.root.at(t)},Cr.prototype.ut=function(){return new Lr(this.root,null,this.P,!1)},Cr.prototype.ct=function(t){return new Lr(this.root,t,this.P,!1)},Cr.prototype.lt=function(){return new Lr(this.root,null,this.P,!0)},Cr.prototype._t=function(t){return new Lr(this.root,t,this.P,!0)},Cr),Lr=(Vr.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Vr.prototype.Tt=function(){return 0<this.dt.length},Vr.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Vr),Dr=(Pr.prototype.copy=function(t,e,n,i,r){return new Pr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Pr.prototype._=function(){return!1},Pr.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Pr.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Pr.prototype.min=function(){return this.left._()?this:this.left.min()},Pr.prototype.rt=function(){return this.min().key},Pr.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Pr.prototype.st=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.st(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.st(t,e,n))).It()},Pr.prototype.Rt=function(){if(this.left._())return Pr.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.Rt(),null)).It()},Pr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.At()||i.left.left.At()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.At()&&(i=i.Vt()),i.right._()||i.right.At()||i.right.left.At()||(i=i.yt()),0===e(t,i.key)){if(i.right._())return Pr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.Rt())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.It()},Pr.prototype.At=function(){return this.color},Pr.prototype.It=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.pt()),t.left.At()&&t.left.left.At()&&(t=t.Vt()),t.left.At()&&t.right.At()&&(t=t.gt()),t},Pr.prototype.Pt=function(){var t=this.gt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).pt()).gt()),t},Pr.prototype.yt=function(){var t=this.gt();return t.left.left.At()&&(t=(t=t.Vt()).gt()),t},Pr.prototype.pt=function(){var t=this.copy(null,null,Pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pr.prototype.Vt=function(){var t=this.copy(null,null,Pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pr.prototype.gt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pr.prototype.vt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Pr.prototype.bt=function(){if(this.At()&&this.left.At())throw Ci();if(this.right.At())throw Ci();var t=this.left.bt();if(t!==this.right.bt())throw Ci();return t+(this.At()?0:1)},Pr);function Pr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Pr.RED,this.left=null!=i?i:Pr.EMPTY,this.right=null!=r?r:Pr.EMPTY,this.size=this.left.size+1+this.right.size}function Vr(t,e,n,i){this.ft=i,this.dt=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.ft?t.left:t.right;else{if(0===r){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Cr(t,e){this.P=t,this.root=e||Dr.EMPTY}function Ur(){this.size=0}Dr.EMPTY=null,Dr.RED=!0,Dr.it=!1,Dr.EMPTY=(Object.defineProperty(Ur.prototype,"key",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"value",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"color",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"left",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Object.defineProperty(Ur.prototype,"right",{get:function(){throw Ci()},enumerable:!1,configurable:!0}),Ur.prototype.copy=function(t,e,n,i,r){return this},Ur.prototype.st=function(t,e,n){return new Dr(t,e)},Ur.prototype.remove=function(t,e){return this},Ur.prototype._=function(){return!0},Ur.prototype.ht=function(t){return!1},Ur.prototype.at=function(t){return!1},Ur.prototype.rt=function(){return null},Ur.prototype.ot=function(){return null},Ur.prototype.At=function(){return!1},Ur.prototype.vt=function(){return!0},Ur.prototype.bt=function(){return 0},new Ur);var Mr=(Fr.prototype.has=function(t){return null!==this.data.get(t)},Fr.prototype.first=function(){return this.data.rt()},Fr.prototype.last=function(){return this.data.ot()},Object.defineProperty(Fr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fr.prototype.indexOf=function(t){return this.data.indexOf(t)},Fr.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Fr.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var i=n.wt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},Fr.prototype.Ct=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},Fr.prototype.Dt=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},Fr.prototype.ut=function(){return new qr(this.data.ut())},Fr.prototype.ct=function(t){return new qr(this.data.ct(t))},Fr.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},Fr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fr.prototype._=function(){return this.data._()},Fr.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fr.prototype.isEqual=function(t){if(!(t instanceof Fr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(0!==this.P(i,r))return!1}return!0},Fr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fr.prototype.copy=function(t){var e=new Fr(this.P);return e.data=t,e},Fr),qr=(jr.prototype.wt=function(){return this.Nt.wt().key},jr.prototype.Tt=function(){return this.Nt.Tt()},jr),xr=new Or(or.P);function jr(t){this.Nt=t}function Fr(t){this.P=t,this.data=new Or(this.P)}var Gr=new Or(or.P);var Br=new Or(or.P),Wr=new Mr(or.P);function zr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Wr,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var $r=new Mr(xi);function Hr(t,e,n,i){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=i}function Xr(t,e){this.targetId=t,this.ne=e}function Qr(t,e,n,i){void 0===n&&(n=Er.J),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Yr=(ho.Ot=function(t){return new ho(t.P)},ho.prototype.has=function(t){return null!=this.$t.get(t)},ho.prototype.get=function(t){return this.$t.get(t)},ho.prototype.first=function(){return this.kt.rt()},ho.prototype.last=function(){return this.kt.ot()},ho.prototype._=function(){return this.kt._()},ho.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(ho.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),ho.prototype.forEach=function(n){this.kt.ht(function(t,e){return n(t),!1})},ho.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.st(t.key,t),e.kt.st(t,null))},ho.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.kt.remove(e)):this},ho.prototype.isEqual=function(t){if(!(t instanceof ho))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.ut(),n=t.kt.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(!i.isEqual(r))return!1}return!0},ho.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ho.prototype.copy=function(t,e){var n=new ho;return n.P=this.P,n.$t=t,n.kt=e,n},ho),Kr=(ao.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.st(e,t):3===t.type&&1!==n.type?this.xt=this.xt.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):Ci()},ao.prototype.Lt=function(){var n=[];return this.xt.ht(function(t,e){n.push(e)}),n},ao),Zr=(uo.Wt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new uo(t,e,Yr.Ot(e),r,n,i,!0,!1)},Object.defineProperty(uo.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ut===t.Ut&&this.qt.isEqual(t.qt)&&du(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Mt.isEqual(t.Mt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},uo),Jr=(so.zt=function(t,e){var n=new Map;return n.set(t,to.Ht(t,e)),new so(tr.min(),n,$r,xr,zr())},so),to=(oo.Ht=function(t,e){return new oo(Er.J,e,zr(),zr(),zr())},oo),eo=(Object.defineProperty(ro.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),ro.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},ro.prototype.le=function(){var n=zr(),i=zr(),r=zr();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Ci()}}),new to(this.re,this.oe,n,i,r)},ro.prototype._e=function(){this.he=!1,this.ie=lo()},ro.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},ro.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},ro.prototype.we=function(){this.se+=1},ro.prototype.me=function(){--this.se},ro.prototype.Te=function(){this.he=!0,this.oe=!0},ro),no=(io.prototype.Ve=function(t){for(var e=0,n=t.te;e<n.length;e++){var i=n[e];t.ee instanceof Zs?this.ye(i,t.ee):t.ee instanceof Js&&this.pe(i,t.key,t.ee)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.ee)}},io.prototype.ge=function(n){var i=this;this.ve(n,function(t){var e=i.be(t);switch(n.state){case 0:i.Se(t)&&e.ce(n.resumeToken);break;case 1:e.me(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.me(),e.ae||i.removeTarget(t);break;case 3:i.Se(t)&&(e.Te(),e.ce(n.resumeToken));break;case 4:i.Se(t)&&(i.Ce(t),e.ce(n.resumeToken));break;default:Ci()}})},io.prototype.ve=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){i.Se(e)&&n(e)})},io.prototype.De=function(t){var e,n,i=t.targetId,r=t.ne.count,o=this.Fe(i);o&&(br(e=o.target)?0===r?(n=new or(e.path),this.pe(i,n,new Js(n,tr.min()))):Ui(1===r):this.Ne(i)!==r&&(this.Ce(i),this.Pe=this.Pe.add(i)))},io.prototype.$e=function(r){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,i=o.Fe(e);i&&(t.Yt&&br(i.target)&&(n=new or(i.target.path),null!==o.Re.get(n)||o.ke(e,n)||o.pe(e,n,new Js(n,r))),t.ue&&(s.set(e,t.le()),t._e()))});var i=zr();this.Ae.forEach(function(t,e){var n=!0;e.Ct(function(t){var e=o.Fe(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Jr(r,s,this.Pe,this.Re,i);return this.Re=xr,this.Ae=co(),this.Pe=new Mr(xi),t},io.prototype.ye=function(t,e){var n;this.Se(t)&&(n=this.ke(t,e.key)?2:0,this.be(t).fe(e.key,n),this.Re=this.Re.st(e.key,e),this.Ae=this.Ae.st(e.key,this.Oe(e.key).add(t)))},io.prototype.pe=function(t,e,n){var i;this.Se(t)&&(i=this.be(t),this.ke(t,e)?i.fe(e,1):i.de(e),this.Ae=this.Ae.st(e,this.Oe(e).delete(t)),n&&(this.Re=this.Re.st(e,n)))},io.prototype.removeTarget=function(t){this.Ie.delete(t)},io.prototype.Ne=function(t){var e=this.be(t).le();return this.Ee.xe(t).size+e.Jt.size-e.Zt.size},io.prototype.we=function(t){this.be(t).we()},io.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new eo,this.Ie.set(t,e)),e},io.prototype.Oe=function(t){var e=this.Ae.get(t);return e||(e=new Mr(xi),this.Ae=this.Ae.st(t,e)),e},io.prototype.Se=function(t){var e=null!==this.Fe(t);return e||Li("WatchChangeAggregator","Detected inactive target",t),e},io.prototype.Fe=function(t){var e=this.Ie.get(t);return e&&e.ae?null:this.Ee.Le(t)},io.prototype.Ce=function(e){var n=this;this.Ie.set(e,new eo),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},io.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},io);function io(t){this.Ee=t,this.Ie=new Map,this.Re=xr,this.Ae=co(),this.Pe=new Mr(xi)}function ro(){this.se=0,this.ie=lo(),this.re=Er.J,this.oe=!1,this.he=!0}function oo(t,e,n,i,r){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=i,this.Zt=r}function so(t,e,n,i,r){this.Z=t,this.Qt=e,this.jt=n,this.Gt=i,this.Kt=r}function uo(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.Mt=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Ut=s,this.Bt=u}function ao(){this.xt=new Or(or.P)}function ho(n){this.P=n?function(t,e){return n(t,e)||or.P(t.key,e.key)}:function(t,e){return or.P(t.key,e.key)},this.$t=Gr,this.kt=new Or(this.P)}function co(){return new Or(or.P)}function lo(){return new Or(or.P)}function fo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function po(t){var e=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new Ji(e.seconds,e.nanos)}var yo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:Ci()}function go(i,r){var t,e,n,o=vo(i);if(o!==vo(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return po(i).isEqual(po(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=Io(i.timestampValue),n=Io(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,To(i.bytesValue).isEqual(To(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,Ao((t=i).geoPointValue.latitude)===Ao(e.geoPointValue.latitude)&&Ao(t.geoPointValue.longitude)===Ao(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ao(t.integerValue)===Ao(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ao(t.doubleValue),i=Ao(e.doubleValue);return n===i?yr(n)===yr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return ji(i.arrayValue.values||[],r.arrayValue.values||[],go);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Wi(t)!==Wi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!go(t[n],e[n])))return!1;return!0}();default:return Ci()}}function mo(t,e){return void 0!==(t.values||[]).find(function(t){return go(t,e)})}function wo(t,e){var n,i,r,o,s,u,a,h,c,l,f=vo(t),p=vo(e);if(f!==p)return xi(f,p);switch(f){case 0:return 0;case 1:return xi(t.booleanValue,e.booleanValue);case 2:return h=e,c=Ao(t.integerValue||t.doubleValue),l=Ao(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return bo(t.timestampValue,e.timestampValue);case 4:return bo(po(t),po(e));case 5:return xi(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=To(o),a=To(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=xi(n[r],i[r]);if(0!==o)return o}return xi(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=xi(Ao(n.latitude),Ao(i.latitude)))?r:xi(Ao(n.longitude),Ao(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=wo(n[r],i[r]);if(o)return o}return xi(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=xi(i[s],o[s]);if(0!==u)return u;var a=wo(n[i[s]],r[o[s]]);if(0!==a)return a}return xi(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Ci()}}function bo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xi(t,e);var n=Io(t),i=Io(e),r=xi(n.seconds,i.seconds);return 0!==r?r:xi(n.nanos,i.nanos)}function Eo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Io(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?To(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,or.B(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Ci();var t,e,n}(t)}function Io(t){if(Ui(!!t),"string"!=typeof t)return{seconds:Ao(t.seconds),nanos:Ao(t.nanos)};var e,n=0,i=yo.exec(t);Ui(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function Ao(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?Er.fromBase64String(t):Er.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function Ro(t){return t&&"integerValue"in t}function ko(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function _o(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Oo(t){return t&&"mapValue"in t}var Lo={asc:"ASCENDING",desc:"DESCENDING"},Do={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this.s=t,this.Me=e};function Vo(t){return{integerValue:""+t}}function Co(t,e){if(t.Me){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yr(e)?"-0":e}}function Uo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!yr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Vo(e):Co(t,e);var n}function Mo(t,e){return t.Me?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qo(t,e){return t.Me?e.toBase64():e.toUint8Array()}function xo(t){return Ui(!!t),tr.T((e=Io(t),new Ji(e.seconds,e.nanos)));var e}function jo(t,e){return new nr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Fo(t,e){return jo(t.s,e.path)}function Go(t,e){var n,i,r=(Ui(Yo(i=nr.$(e))),i);return Ui(r.get(1)===t.s.projectId),Ui(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new or((Ui(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function Bo(t,e){return jo(t.s,e)}function Wo(t){return new nr(["projects",t.s.projectId,"databases",t.s.database]).N()}function zo(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function $o(t,e){var n,i,r,o,s,u;if(e instanceof _s)n={update:zo(t,e.key,e.value)};else if(e instanceof js)n={delete:Fo(t,e.key)};else if(e instanceof Os)n={update:zo(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Cs)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof es)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof ns)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof ls)return{fieldPath:t.field.N(),increment:e.Ue};throw Ci()})}};else{if(!(e instanceof Fs))return Ci();n={verify:Fo(t,e.key)}}return e.We.Be||(n.currentDocument=void 0!==(o=e.We).updateTime?{updateTime:(s=t,u=o.updateTime,Mo(s,u.R()))}:void 0!==o.exists?{exists:o.exists}:Ci()),n}function Ho(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Bo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(_o(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(_o(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qo(t.field),op:(e=t.op,Do[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Qo((e=t).field),direction:(n=e.dir,Lo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Me||dr(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Xo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Xo(e.endAt)),n}function Xo(t){return{before:t.before,values:t.position}}function Qo(t){return{fieldPath:t.N()}}function Yo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ko(){this.Qe=void 0}function Zo(t,e){return t instanceof ls?Ro(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Jo,ts,es=(o(rs,ts=Ko),rs),ns=(o(is,Jo=Ko),is);function is(t){var e=this;return(e=Jo.call(this)||this).elements=t,e}function rs(){return null!==ts&&ts.apply(this,arguments)||this}function os(t,e){for(var n=ds(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return go(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var ss,us=(o(as,ss=Ko),as);function as(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function hs(t,e){for(var n=ds(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!go(t,e)})}(r[i]);return{arrayValue:{values:n}}}var cs,ls=(o(fs,cs=Ko),fs);function fs(t,e){var n=this;return(n=cs.call(this)||this).serializer=t,n.Ue=e,n}function ps(t){return Ao(t.integerValue||t.doubleValue)}function ds(t){return ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ys(t,e){this.field=t,this.transform=e}var vs=(gs.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},gs.prototype.isEqual=function(t){return ji(this.fields,t.fields,function(t,e){return t.isEqual(e)})},gs);function gs(t){(this.fields=t).sort(rr.P)}function ms(t,e){this.version=t,this.transformResults=e}var ws=(bs.Ge=function(){return new bs},bs.exists=function(t){return new bs(void 0,t)},bs.updateTime=function(t){return new bs(t)},Object.defineProperty(bs.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},bs);function bs(t,e){this.updateTime=t,this.exists=e}function Es(t,e){return void 0!==t.updateTime?e instanceof Zs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Zs}function Is(){}function As(t,e,n){return t instanceof _s?new Zs(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Os?function(t,e,n){if(!Es(t.We,e))return new tu(t.key,n.version);var i=Ps(t,e);return new Zs(t.key,n.version,i,{hasCommittedMutations:!0})}(t,e,n):t instanceof Cs?function(t,e,n){if(Ui(null!=n.transformResults),!Es(t.We,e))return new tu(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Ui(t.length===n.length);for(var r,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Zs&&(c=e.field(a.field)),i.push((r=h,o=c,s=n[u],r instanceof ns?os(r,o):r instanceof us?hs(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ms(t,i.data(),r);return new Zs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new Js(t.key,n.version,{hasCommittedMutations:!0})}function Ts(t,e,n,i){return t instanceof _s?function(t,e){if(!Es(t.We,e))return e;var n=Rs(e);return new Zs(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Os?function(t,e){if(!Es(t.We,e))return e;var n=Rs(e),i=Ps(t,e);return new Zs(t.key,n,i,{Ke:!0})}(t,e):t instanceof Cs?function(t,e,n,i){if(!Es(t.We,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,u,a,h,c,l=[],f=0,p=t;f<p.length;f++){var d=p[f],y=d.transform,v=null;n instanceof Zs&&(v=n.field(d.field)),null===v&&i instanceof Zs&&(v=i.field(d.field)),l.push((o=v,s=e,c=h=a=u=void 0,(r=y)instanceof es?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):r instanceof ns?os(r,o):r instanceof us?hs(r,o):(a=Zo(u=r,o),h=ps(a)+ps(u.Ue),Ro(a)&&Ro(u.Ue)?Vo(h):Co(u.serializer,h))))}return l}(t.fieldTransforms,n,e,i),s=Ms(t,r.data(),o);return new Zs(t.key,r.version,s,{Ke:!0})}(t,e,i,n):(o=e,Es((r=t).We,o)?new Js(r.key,tr.min()):o);var r,o}function Ns(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.We.isEqual(e.We)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||ji(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof ns&&o instanceof ns||r instanceof us&&o instanceof us?ji(r.elements,o.elements,go):r instanceof ls&&o instanceof ls?go(r.Ue,o.Ue):r instanceof es&&o instanceof es);var n,i,r,o}))}function Rs(t){return t instanceof Zs?t.version:tr.min()}var ks,Ss,_s=(o(Ds,Ss=Is),Ds),Os=(o(Ls,ks=Is),Ls);function Ls(t,e,n,i){var r=this;return(r=ks.call(this)||this).key=t,r.data=e,r.qe=n,r.We=i,r.type=1,r}function Ds(t,e,n){var i=this;return(i=Ss.call(this)||this).key=t,i.value=e,i.We=n,i.type=0,i}function Ps(t,e){return n=t,i=e instanceof Zs?e.data():Gs.empty(),r=new Bs(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var Vs,Cs=(o(Us,Vs=Is),Us);function Us(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.We=ws.exists(!0),n}function Ms(t,e,n){for(var i=new Bs(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var qs,xs,js=(o(Hs,xs=Is),Hs),Fs=(o($s,qs=Is),$s),Gs=(zs.empty=function(){return new zs({mapValue:{}})},zs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Oo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},zs.prototype.isEqual=function(t){return go(this.proto,t.proto)},zs),Bs=(Ws.prototype.set=function(t,e){return this.Je(t,e),this},Ws.prototype.delete=function(t){return this.Je(t,null),this},Ws.prototype.Je=function(t,e){for(var n=this.Ye,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},Ws.prototype.ze=function(){var t=this.Xe(rr.k(),this.Ye);return null!=t?new Gs(t):this.He},Ws.prototype.Xe=function(i,t){var r=this,o=!1,e=this.He.field(i),s=Oo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ws);function Ws(t){void 0===t&&(t=Gs.empty()),this.He=t,this.Ye=new Map}function zs(t){this.proto=t}function $s(t,e){var n=this;return(n=qs.call(this)||this).key=t,n.We=e,n.type=4,n}function Hs(t,e){var n=this;return(n=xs.call(this)||this).key=t,n.We=e,n.type=3,n}function Xs(t,e){this.key=t,this.version=e}var Qs,Ys,Ks,Zs=(o(iu,Ks=Xs),iu.prototype.field=function(t){return this.Ze.field(t)},iu.prototype.data=function(){return this.Ze},iu.prototype.tn=function(){return this.Ze.proto},iu.prototype.isEqual=function(t){return t instanceof iu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},iu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),iu),Js=(o(nu,Ys=Xs),nu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(nu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),nu.prototype.isEqual=function(t){return t instanceof nu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},nu),tu=(o(eu,Qs=Xs),eu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(eu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),eu.prototype.isEqual=function(t){return t instanceof eu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},eu);function eu(){return null!==Qs&&Qs.apply(this,arguments)||this}function nu(t,e,n){var i=this;return(i=Ys.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function iu(t,e,n,i){var r=this;return(r=Ks.call(this,t,e)||this).Ze=n,r.Ke=!!i.Ke,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function ru(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Zi(Ki.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Zi(Ki.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ou=(su.prototype.on=function(t){return new su(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},su.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.L())},su.prototype.an=function(){return!dr(this.limit)&&"F"===this.nn},su.prototype.un=function(){return!dr(this.limit)&&"L"===this.nn},su.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},su.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},su.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},su);function su(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=i,this.limit=r,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function uu(t){return new ou(t)}function au(t){return null!==t.collectionGroup}function hu(t){var e=ru(t,ou);if(null===e.sn){e.sn=[];var n=e.ln(),i=e.cn();if(null!==n&&null===i)n.L()||e.sn.push(new Xu(n)),e.sn.push(new Xu(rr.M(),"asc"));else{for(var r,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.L()&&(o=!0)}o||(r=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new Xu(rr.M(),r)))}}return e.sn}function cu(t){var e=ru(t,ou);if(!e.rn)if("F"===e.nn)e.rn=gr(e.path,e.collectionGroup,hu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=hu(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new Xu(o.field,s))}var u=e.endAt?new ju(e.endAt.position,!e.endAt.before):null,a=e.startAt?new ju(e.startAt.position,!e.startAt.before):null;e.rn=gr(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function lu(t,e,n){return new ou(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fu(t,e){return new ou(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function pu(t,e){return new ou(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function du(t,e){return wr(cu(t),cu(e))&&t.nn===e.nn}function yu(t){return mr(cu(t))+"|lt:"+t.nn}function vu(t){return"Query(target="+(e=cu(t),n=e.path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+Eo(e.value);var e}).join(", ")+"]"),dr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+zu(e.startAt)),e.endAt&&(n+=", endAt: "+zu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function gu(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.W(i.collectionGroup)&&i.path.C(o):or.j(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.en;e<n.length;e++){var i=n[e];if(!i.field.L()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||$u(e.startAt,hu(e),n))&&(!e.endAt||!$u(e.endAt,hu(e),n)));var e,n,i,o}function mu(u){return function(t,e){for(var n=!1,i=0,r=hu(u);i<r.length;i++){var o=r[i],s=function(t,r,e){var n=t.field.L()?or.P(r.key,e.key):function(t,e){var n=r.field(t),i=e.field(t);return null!==n&&null!==i?wo(n,i):Ci()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ci()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var wu,bu=(o(Eu,wu=function(){}),Eu.create=function(t,e,n){if(t.L())return"in"===e||"not-in"===e?this.dn(t,e,n):new Nu(t,e,n);if(So(n)){if("=="!==e&&"!="!==e)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Eu(t,e,n)}if(_o(n)){if("=="!==e&&"!="!==e)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Eu(t,e,n)}return"array-contains"===e?new Uu(t,n):"in"===e?new Mu(t,n):"not-in"===e?new qu(t,n):"array-contains-any"===e?new xu(t,n):new Eu(t,e,n)},Eu.dn=function(t,e,n){return new("in"===e?Ru:ku)(t,n)},Eu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(wo(e,this.value)):null!==e&&vo(this.value)===vo(e)&&this.wn(wo(e,this.value))},Eu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Ci()}},Eu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Eu);function Eu(t,e,n){var i=this;return(i=wu.call(this)||this).field=t,i.op=e,i.value=n,i}var Iu,Au,Tu,Nu=(o(Ou,Tu=bu),Ou.prototype.matches=function(t){var e=or.P(t.key,this.key);return this.wn(e)},Ou),Ru=(o(_u,Au=bu),_u.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},_u),ku=(o(Su,Iu=bu),Su.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Su);function Su(t,e){var n=this;return(n=Iu.call(this,t,"not-in",e)||this).keys=Lu(0,e),n}function _u(t,e){var n=this;return(n=Au.call(this,t,"in",e)||this).keys=Lu(0,e),n}function Ou(t,e,n){var i=this;return(i=Tu.call(this,t,e,n)||this).key=or.B(n.referenceValue),i}function Lu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return or.B(t.referenceValue)})}var Du,Pu,Vu,Cu,Uu=(o(Wu,Cu=bu),Wu.prototype.matches=function(t){var e=t.field(this.field);return ko(e)&&mo(e.arrayValue,this.value)},Wu),Mu=(o(Bu,Vu=bu),Bu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&mo(this.value.arrayValue,e)},Bu),qu=(o(Gu,Pu=bu),Gu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!mo(this.value.arrayValue,e)},Gu),xu=(o(Fu,Du=bu),Fu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ko(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return mo(e.value.arrayValue,t)})},Fu),ju=function(t,e){this.position=t,this.before=e};function Fu(t,e){return Du.call(this,t,"array-contains-any",e)||this}function Gu(t,e){return Pu.call(this,t,"not-in",e)||this}function Bu(t,e){return Vu.call(this,t,"in",e)||this}function Wu(t,e){return Cu.call(this,t,"array-contains",e)||this}function zu(t){return(t.before?"b":"a")+":"+t.position.map(Eo).join(",")}function $u(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.L()?or.P(or.B(s.referenceValue),n.key):wo(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Hu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!go(t.position[n],e.position[n]))return!1;return!0}var Xu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var Qu=(sa.prototype.Tn=function(t,e,n){for(var i=n.En,r=0;r<this.mutations.length;r++){var o=this.mutations[r];o.key.isEqual(t)&&(e=As(o,e,i[r]))}return e},sa.prototype.In=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=Ts(r,e,e,this.mn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ts(a,e,o,this.mn))}return e},sa.prototype.Rn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.In(t.key,n.get(t.key));e&&(r=r.st(t.key,e))}),r},sa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zr())},sa.prototype.isEqual=function(t){return this.batchId===t.batchId&&ji(this.mutations,t.mutations,Ns)&&ji(this.baseMutations,t.baseMutations,Ns)},sa),Yu=(oa.from=function(t,e,n){Ui(t.mutations.length===n.length);for(var i=Br,r=t.mutations,o=0;o<r.length;o++)i=i.st(r[o].key,n[o].version);return new oa(t,e,n,i)},oa),Ku=(ra.prototype.catch=function(t){return this.next(void 0,t)},ra.prototype.next=function(i,r){var o=this;return this.gn&&Ci(),this.gn=!0,this.pn?this.error?this.vn(r,this.error):this.bn(i,this.result):new ra(function(e,n){o.Vn=function(t){o.bn(i,t).next(e,n)},o.yn=function(t){o.vn(r,t).next(e,n)}})},ra.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ra.prototype.Cn=function(t){try{var e=t();return e instanceof ra?e:ra.resolve(e)}catch(t){return ra.reject(t)}},ra.prototype.bn=function(t,e){return t?this.Cn(function(){return t(e)}):ra.resolve(e)},ra.prototype.vn=function(t,e){return t?this.Cn(function(){return t(e)}):ra.reject(e)},ra.resolve=function(n){return new ra(function(t,e){t(n)})},ra.reject=function(n){return new ra(function(t,e){e(n)})},ra.Dn=function(t){return new ra(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},ra.Fn=function(t){for(var n=ra.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?ra.resolve(t):e()})}(i[e]);return n},ra.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Dn(r)},ra),Zu=(ia.prototype.On=function(e,n){var i=this;return this.$n.xn(e,n).next(function(t){return i.Ln(e,n,t)})},ia.prototype.Ln=function(t,i,r){return this.Nn.Mn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].In(i,t);return t})},ia.prototype.qn=function(t,e,r){var o=xr;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].In(t,e);o=o.st(t,e)}),o},ia.prototype.Un=function(e,t){var n=this;return this.Nn.getEntries(e,t).next(function(t){return n.Bn(e,t)})},ia.prototype.Bn=function(i,r){var o=this;return this.$n.Wn(i,r).next(function(t){var e=o.qn(i,r,t),n=xr;return e.forEach(function(t,e){e=e||new Js(t,tr.min()),n=n.st(t,e)}),n})},ia.prototype.Qn=function(t,e,n){return i=e,or.j(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.jn(t,e.path):au(e)?this.Gn(t,e,n):this.Kn(t,e,n);var i},ia.prototype.jn=function(t,e){return this.On(t,new or(e)).next(function(t){var e=Gr;return t instanceof Zs&&(e=e.st(t.key,t)),e})},ia.prototype.Gn=function(n,i,r){var o=this,s=i.collectionGroup,u=Gr;return this.kn.zn(n,s).next(function(t){return Ku.forEach(t,function(t){var e=i.on(t.child(s));return o.Kn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},ia.prototype.Kn=function(e,n,t){var c,l,i=this;return this.Nn.Qn(e,n,t).next(function(t){return c=t,i.$n.Hn(e,n)}).next(function(t){return l=t,i.Yn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=Ts(s,a,a,i.mn);c=h instanceof Zs?c.st(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){gu(n,e)||(c=c.remove(t))}),c})},ia.prototype.Yn=function(t,e,n){for(var i=zr(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Nn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Zs&&(h=h.st(t,e))}),h})},ia),Ju=(na.Zn=function(t,e){for(var n=zr(),i=zr(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new na(t,e.fromCache,n,i)},na),ta=(ea.prototype.es=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ea.prototype.next=function(){var t=++this.previousValue;return this.ns&&this.ns(t),t},ea);function ea(t,e){var n=this;this.previousValue=t,e&&(e.ts=function(t){return n.es(t)},this.ns=function(t){return e.ss(t)})}function na(t,e,n,i){this.targetId=t,this.fromCache=e,this.Jn=n,this.Xn=i}function ia(t,e,n){this.Nn=t,this.$n=e,this.kn=n}function ra(t){var e=this;this.Vn=null,this.yn=null,this.result=void 0,this.error=void 0,this.pn=!1,this.gn=!1,t(function(t){e.pn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.pn=!0,e.error=t,e.yn&&e.yn(t)})}function oa(t,e,n,i){this.batch=t,this.An=e,this.En=n,this.Pn=i}function sa(t,e,n,i){this.batchId=t,this.mn=e,this.baseMutations=n,this.mutations=i}ta.rs=-1;function ua(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var aa=(ha.prototype.reset=function(){this.ls=0},ha.prototype.ds=function(){this.ls=this.cs},ha.prototype.ws=function(t){var e=this;this.cancel();var n=Math.floor(this.ls+this.ms()),i=Math.max(0,Date.now()-this.fs),r=Math.max(0,n-i);0<r&&Li("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.ls+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this._s=this.os.Ts(this.hs,r,function(){return e.fs=Date.now(),t()}),this.ls*=this.us,this.ls<this.as&&(this.ls=this.as),this.ls>this.cs&&(this.ls=this.cs)},ha.prototype.Es=function(){null!==this._s&&(this._s.Is(),this._s=null)},ha.prototype.cancel=function(){null!==this._s&&(this._s.cancel(),this._s=null)},ha.prototype.ms=function(){return(Math.random()-.5)*this.ls},ha);function ha(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.os=t,this.hs=e,this.as=n,this.us=i,this.cs=r,this.ls=0,this._s=null,this.fs=Date.now(),this.reset()}function ca(t){return"IndexedDbTransactionError"===t.name}function la(){return"undefined"!=typeof document?document:null}var fa=(ya.ys=function(t,e,n,i,r){var o=new ya(t,e,Date.now()+n,i,r);return o.start(n),o},ya.prototype.start=function(t){var e=this;this.ps=setTimeout(function(){return e.gs()},t)},ya.prototype.Is=function(){return this.gs()},ya.prototype.cancel=function(t){null!==this.ps&&(this.clearTimeout(),this.Vs.reject(new Zi(Ki.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ya.prototype.gs=function(){var e=this;this.Rs.vs(function(){return null!==e.ps?(e.clearTimeout(),e.op().then(function(t){return e.Vs.resolve(t)})):Promise.resolve()})},ya.prototype.clearTimeout=function(){null!==this.ps&&(this.Ps(this),clearTimeout(this.ps),this.ps=null)},ya),pa=(Object.defineProperty(da.prototype,"xs",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),da.prototype.vs=function(t){this.enqueue(t)},da.prototype.Ls=function(t){this.Ms(),this.qs(t)},da.prototype.Us=function(){var t;this.Cs||(this.Cs=!0,(t=la())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Os))},da.prototype.enqueue=function(t){return this.Ms(),this.Cs?new Promise(function(t){}):this.qs(t)},da.prototype.Bs=function(t){var e=this;this.Ss.push(t),this.vs(function(){return e.Ws()})},da.prototype.Ws=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Ss.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ss[0]()];case 2:return t.sent(),this.Ss.shift(),this.ks.reset(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Li("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ss.length&&this.ks.ws(function(){return n.Ws()}),t.label=5;case 5:return[2]}})})},da.prototype.qs=function(t){var i=this,e=this.bs.then(function(){return i.Ns=!0,t().catch(function(t){throw i.Fs=t,i.Ns=!1,Di("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Ns=!1,t})});return this.bs=e},da.prototype.Ts=function(t,e,n){var i=this;this.Ms(),-1<this.$s.indexOf(t)&&(e=0);var r=fa.ys(this,t,e,n,function(t){return i.Qs(t)});return this.Ds.push(r),r},da.prototype.Ms=function(){this.Fs&&Ci()},da.prototype.js=function(){},da.prototype.Gs=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.bs];case 1:t.sent(),t.label=2;case 2:if(e!==this.bs)return[3,0];t.label=3;case 3:return[2]}})})},da.prototype.Ks=function(t){for(var e=0,n=this.Ds;e<n.length;e++)if(n[e].hs===t)return!0;return!1},da.prototype.zs=function(i){var r=this;return this.Gs().then(function(){r.Ds.sort(function(t,e){return t.As-e.As});for(var t=0,e=r.Ds;t<e.length;t++){var n=e[t];if(n.Is(),"all"!==i&&n.hs===i)break}return r.Gs()})},da.prototype.Hs=function(t){this.$s.push(t)},da.prototype.Qs=function(t){var e=this.Ds.indexOf(t);this.Ds.splice(e,1)},da);function da(){var e=this;this.bs=Promise.resolve(),this.Ss=[],this.Cs=!1,this.Ds=[],this.Fs=null,this.Ns=!1,this.$s=[],this.ks=new aa(this,"async_queue_retry"),this.Os=function(){var t=la();t&&Li("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ks.Es()};var t=la();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Os)}function ya(t,e,n,i,r){this.Rs=t,this.hs=e,this.As=n,this.op=i,this.Ps=r,this.Vs=new ua,this.then=this.Vs.promise.then.bind(this.Vs.promise),this.Vs.promise.catch(function(t){})}function va(t,e){if(Di("AsyncQueue",e+": "+t),ca(t))return new Zi(Ki.UNAVAILABLE,e+": "+t);throw t}var ga=(ma.Zs=function(t){return new ma(t,ma.ti,ma.ei)},ma);function ma(t,e,n){this.Ys=t,this.Js=e,this.Xs=n}ga.ni=-1,ga.si=1048576,ga.ii=41943040,ga.ti=10,ga.ei=1e3,ga.ri=new ga(ga.ii,ga.ti,ga.ei),ga.oi=new ga(ga.ni,0,0);var wa=(Ra.prototype.ai=function(t,e){return this.hi.add(e),Ku.resolve()},Ra.prototype.zn=function(t,e){return Ku.resolve(this.hi.getEntries(e))},Ra),ba=(Na.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Mr(nr.P),r=!i.has(n);return this.index[e]=i.add(n),r},Na.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},Na.prototype.getEntries=function(t){return(this.index[t]||new Mr(nr.P)).F()},Na),Ea=(Ta.prototype.next=function(){return this.ui+=2,this.ui},Ta.ci=function(){return new Ta(0)},Ta.li=function(){return new Ta(-1)},Ta),Ia=(Aa.prototype.yi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pi(t,n.fi)})},Aa);function Aa(t,e,n){this.persistence=t,this._i=e,this.fi=new Or(xi),this.di=new Yi(mr,wr),this.wi=tr.min(),this.$n=t.mi(n),this.Ti=t.Ei(),this.Ii=t.Ri(),this.Ai=new Zu(this.Ti,this.$n,this.persistence.Pi()),this._i.Vi(this.Ai)}function Ta(t){this.ui=t}function Na(){this.index={}}function Ra(){this.hi=new ba}function ka(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,n,r,o,s,i,u,a=c.batch.keys(),h=l.Ti.gi({vi:!0});return e=l,n=t,o=h,s=(r=c).batch,i=s.keys(),u=Ku.resolve(),i.forEach(function(i){u=u.next(function(){return o.Mn(n,i)}).next(function(t){var e=t,n=r.Pn.get(i);Ui(null!==n),(!e||e.version.o(n)<0)&&(e=s.Tn(i,e,r))&&o.bi(e,r.An)})}),u.next(function(){return e.$n.Si(n,s)}).next(function(){return h.apply(t)}).next(function(){return l.$n.Ci(t)}).next(function(){return l.Ai.Un(t,a)})})}function Sa(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ii.Di(t)})}function _a(t,s){var c=t,l=s.Z,f=c.fi;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var r=c.Ti.gi({vi:!0});f=c.fi;var h=[];s.Qt.forEach(function(t,e){var n,i,r,o,s,u=f.get(e);u&&(h.push(c.Ii.Fi(a,t.Zt,e).next(function(){return c.Ii.Ni(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(i=u.et(n,l).tt(a.$i),f=f.st(e,i),r=u,s=t,Ui(0<(o=i).resumeToken.Y()),(0===r.resumeToken.Y()||3e8<=o.Z.I()-r.Z.I()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&h.push(c.Ii.ki(a,i))))});var t,o=xr,n=zr();return s.Gt.forEach(function(t,e){n=n.add(t)}),h.push(r.getEntries(a,n).next(function(i){s.Gt.forEach(function(t,e){var n=i.get(t);e instanceof Js&&e.version.isEqual(tr.min())?(r.Oi(t,l),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.bi(e,l),o=o.st(t,e)):Li("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Kt.has(t)&&h.push(c.persistence.Li.xi(a,t))})})),l.isEqual(tr.min())||(t=c.Ii.Di(a).next(function(t){return c.Ii.Mi(a,a.$i,l)}),h.push(t)),Ku.Dn(h).next(function(){return r.apply(a)}).next(function(){return c.Ai.Bn(a,o)})}).then(function(t){return c.fi=f,t})}function Oa(o,s,u){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:n=(e=o).fi.get(s),i=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",i,function(t){return e.persistence.Li.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ca(r=t.sent()))throw r;return Li("LocalStore","Failed to update sequence numbers for target "+s+": "+r),[3,5];case 5:return e.fi=e.fi.remove(s),e.di.delete(n.target),[2]}})})}function La(t,s,u){var a=t,h=tr.min(),c=zr();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,i=cu(s),(void 0!==(o=(r=t).di.get(i))?Ku.resolve(r.fi.get(o)):r.Ii.Ui(n,i)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.Ii.Bi(e,t.targetId).next(function(t){c=t})}).next(function(){return a._i.Qn(e,s,u?h:tr.min(),u?c:zr())}).next(function(t){return{documents:t,Wi:c}});var t,n,i,r,o})}function Da(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Ki.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Li("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Pa=(qa.prototype._=function(){return this.Qi._()},qa.prototype.zi=function(t,e){var n=new Va(t,e);this.Qi=this.Qi.add(n),this.Gi=this.Gi.add(n)},qa.prototype.Hi=function(t,e){var n=this;t.forEach(function(t){return n.zi(t,e)})},qa.prototype.Yi=function(t,e){this.Ji(new Va(t,e))},qa.prototype.Xi=function(t,e){var n=this;t.forEach(function(t){return n.Yi(t,e)})},qa.prototype.Zi=function(t){var e=this,n=new or(new nr([])),i=new Va(n,t),r=new Va(n,t+1),o=[];return this.Gi.St([i,r],function(t){e.Ji(t),o.push(t.key)}),o},qa.prototype.tr=function(){var e=this;this.Qi.forEach(function(t){return e.Ji(t)})},qa.prototype.Ji=function(t){this.Qi=this.Qi.delete(t),this.Gi=this.Gi.delete(t)},qa.prototype.er=function(t){var e=new or(new nr([])),n=new Va(e,t),i=new Va(e,t+1),r=zr();return this.Gi.St([n,i],function(t){r=r.add(t.key)}),r},qa.prototype.nr=function(t){var e=new Va(t,0),n=this.Qi.Dt(e);return null!==n&&t.isEqual(n.key)},qa),Va=(Ma.ji=function(t,e){return or.P(t.key,e.key)||xi(t.sr,e.sr)},Ma.Ki=function(t,e){return xi(t.sr,e.sr)||or.P(t.key,e.key)},Ma),Ca=(Ua.prototype.ir=function(){return null!=this.uid},Ua.prototype.rr=function(){return this.ir()?"uid:"+this.uid:"anonymous-user"},Ua.prototype.isEqual=function(t){return t.uid===this.uid},Ua);function Ua(t){this.uid=t}function Ma(t,e){this.key=t,this.sr=e}function qa(){this.Qi=new Mr(Va.ji),this.Gi=new Mr(Va.Ki)}Ca.UNAUTHENTICATED=new Ca(null),Ca.or=new Ca("google-credentials-uid"),Ca.hr=new Ca("first-party-uid");function xa(t,e){this.user=e,this.type="OAuth",this.ar={},this.ar.Authorization="Bearer "+t}function ja(t){this.key=t}function Fa(t){this.key=t}function Ga(t,e,n){this.query=t,this.targetId=e,this.view=n}function Ba(t){this.key=t,this.Lh=!1}function Wa(){this.va=void 0,this.listeners=[]}var za,$a,Ha,Xa,Qa=(Dh.prototype.getToken=function(){return Promise.resolve(null)},Dh.prototype.cr=function(){},Dh.prototype.lr=function(t){(this.ur=t)(Ca.UNAUTHENTICATED)},Dh.prototype._r=function(){this.ur=null},Dh),Ya=(Lh.prototype.getToken=function(){var e=this,n=this.mr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.mr!==n?(Li("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ui("string"==typeof t.accessToken),new xa(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Lh.prototype.cr=function(){this.forceRefresh=!0},Lh.prototype.lr=function(t){this.ur=t,this.wr&&t(this.currentUser)},Lh.prototype._r=function(){this.auth&&this.auth.removeAuthTokenListener(this.dr),this.dr=null,this.ur=null},Lh.prototype.Tr=function(){var t=this.auth&&this.auth.getUid();return Ui(null===t||"string"==typeof t),new Ca(t)},Lh),Ka=(Object.defineProperty(Oh.prototype,"ar",{get:function(){var t={"X-Goog-AuthUser":this.Ir},e=this.Er.auth.Rr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Oh),Za=(_h.prototype.getToken=function(){return Promise.resolve(new Ka(this.Er,this.Ir))},_h.prototype.lr=function(t){t(Ca.hr)},_h.prototype._r=function(){},_h.prototype.cr=function(){},_h),Ja=(Sh.prototype.gr=function(){return 1===this.state||2===this.state||4===this.state},Sh.prototype.vr=function(){return 2===this.state},Sh.prototype.start=function(){3!==this.state?this.auth():this.br()},Sh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Sh.prototype.Sr=function(){this.state=0,this.ks.reset()},Sh.prototype.Cr=function(){var t=this;this.vr()&&null===this.pr&&(this.pr=this.os.Ts(this.Ar,6e4,function(){return t.Dr()}))},Sh.prototype.Fr=function(t){this.Nr(),this.stream.send(t)},Sh.prototype.Dr=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.vr()?[2,this.close(0)]:[2]})})},Sh.prototype.Nr=function(){this.pr&&(this.pr.cancel(),this.pr=null)},Sh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Nr(),this.ks.cancel(),this.yr++,3!==e?this.ks.reset():n&&n.code===Ki.RESOURCE_EXHAUSTED?(Di(n.toString()),Di("Using maximum backoff delay to prevent overloading the backend."),this.ks.ds()):n&&n.code===Ki.UNAUTHENTICATED&&this.Vr.cr(),null!==this.stream&&(this.$r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.kr(n)];case 1:return t.sent(),[2]}})})},Sh.prototype.$r=function(){},Sh.prototype.auth=function(){var n=this;this.state=1;var t=this.Or(this.yr),e=this.yr;this.Vr.getToken().then(function(t){n.yr===e&&n.xr(t)},function(e){t(function(){var t=new Zi(Ki.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Lr(t)})})},Sh.prototype.xr=function(t){var e=this,n=this.Or(this.yr);this.stream=this.Mr(t),this.stream.qr(function(){n(function(){return e.state=2,e.listener.qr()})}),this.stream.kr(function(t){n(function(){return e.Lr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Sh.prototype.br=function(){var t=this;this.state=4,this.ks.ws(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Sh.prototype.Lr=function(t){return Li("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Sh.prototype.Or=function(e){var n=this;return function(t){n.os.vs(function(){return n.yr===e?t():(Li("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Sh),th=(o(kh,Ha=Ja),kh.prototype.Mr=function(t){return this.Pr.Ur("Listen",t)},kh.prototype.onMessage=function(t){this.ks.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Ci(),u=e.targetChange.targetIds||[],a=(r=e.targetChange.resumeToken,t.Me?(Ui(void 0===r||"string"==typeof r),Er.fromBase64String(r||"")):(Ui(void 0===r||r instanceof Uint8Array),Er.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=h&&(i=void 0===(n=h).code?Ki.UNKNOWN:_r(n.code),new Zi(i,n.message||"")),l=new Qr(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=Go(t,f.document.name),d=xo(f.document.updateTime),y=new Gs({mapValue:{fields:f.document.fields}}),v=new Zs(p,d,y,{}),g=f.targetIds||[],m=f.removedTargetIds||[];l=new Hr(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=Go(t,w.document),E=w.readTime?xo(w.readTime):tr.min(),I=new Js(b,E),A=w.removedTargetIds||[];l=new Hr([],A,I.key,I)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var N=Go(t,T.document),R=T.removedTargetIds||[];l=new Hr([],R,N,null)}else{if(!("filter"in e))return Ci();e.filter;var k=e.filter;k.targetId;var S=k.count||0,_=new Ar(S),O=k.targetId;l=new Xr(O,_)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return tr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?tr.min():xo(e.readTime)}(t);return this.listener.Br(e,n)},kh.prototype.Wr=function(t){var e,n,i,r,o={};o.database=Wo(this.serializer),o.addTarget=(e=this.serializer,r=(n=t).target,(i=br(r)?{documents:{documents:[Bo(e,r.path)]}}:{query:Ho(e,r)}).targetId=n.targetId,0<n.resumeToken.Y()&&(i.resumeToken=qo(e,n.resumeToken)),i);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ci()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Fr(o)},kh.prototype.Qr=function(t){var e={};e.database=Wo(this.serializer),e.removeTarget=t,this.Fr(e)},kh),eh=(o(Rh,$a=Ja),Object.defineProperty(Rh.prototype,"Gr",{get:function(){return this.jr},enumerable:!1,configurable:!0}),Rh.prototype.start=function(){this.jr=!1,this.lastStreamToken=void 0,$a.prototype.start.call(this)},Rh.prototype.$r=function(){this.jr&&this.Kr([])},Rh.prototype.Mr=function(t){return this.Pr.Ur("Write",t)},Rh.prototype.onMessage=function(t){if(Ui(!!t.streamToken),this.lastStreamToken=t.streamToken,this.jr){this.ks.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Ui(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(tr.min())&&(n=xo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new ms(n,i)}(t,r)})):[]),n=xo(t.commitTime);return this.listener.zr(n,e)}var i,r;return Ui(!t.writeResults||0===t.writeResults.length),this.jr=!0,this.listener.Hr()},Rh.prototype.Yr=function(){var t={};t.database=Wo(this.serializer),this.Fr(t)},Rh.prototype.Kr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return $o(e.serializer,t)})};this.Fr(n)},Rh),nh=(o(Nh,za=function(){}),Nh.prototype.Xr=function(){if(this.Jr)throw new Zi(Ki.FAILED_PRECONDITION,"The client has already been terminated.")},Nh.prototype.Zr=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.Zr(e,n,i,t)}).catch(function(t){throw t.code===Ki.UNAUTHENTICATED&&r.credentials.cr(),t})},Nh.prototype.to=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.to(e,n,i,t)}).catch(function(t){throw t.code===Ki.UNAUTHENTICATED&&r.credentials.cr(),t})},Nh.prototype.terminate=function(){this.Jr=!1},Nh),ih=(Th.prototype.ro=function(){var t=this;0===this.no&&(this.oo("Unknown"),this.so=this.Rs.Ts("online_state_timeout",1e4,function(){return t.so=null,t.ho("Backend didn't respond within 10 seconds."),t.oo("Offline"),Promise.resolve()}))},Th.prototype.ao=function(t){"Online"===this.state?this.oo("Unknown"):(this.no++,1<=this.no&&(this.uo(),this.ho("Connection failed 1 times. Most recent error: "+t.toString()),this.oo("Offline")))},Th.prototype.set=function(t){this.uo(),this.no=0,"Online"===t&&(this.io=!1),this.oo(t)},Th.prototype.oo=function(t){t!==this.state&&(this.state=t,this.eo(t))},Th.prototype.ho=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.io?(Di(e),this.io=!1):Li("OnlineStateTracker",e)},Th.prototype.uo=function(){null!==this.so&&(this.so.cancel(),this.so=null)},Th),rh=(Ah.prototype.start=function(){return this.enableNetwork()},Ah.prototype.enableNetwork=function(){return this.wo.delete(0),this.Co()},Ah.prototype.Co=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(this.Do()?this.Fo():this.Ro.set("Unknown"),[4,this.No()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ah.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(0),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),[2]}})})},Ah.prototype.$o=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.po.stop()];case 1:return t.sent(),[4,this.Ao.stop()];case 2:return t.sent(),0<this._o.length&&(Li("RemoteStore","Stopping write stream with "+this._o.length+" pending writes"),this._o=[]),this.ko(),[2]}})})},Ah.prototype.Oo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Li("RemoteStore","RemoteStore shutting down."),this.wo.add(5),[4,this.$o()];case 1:return t.sent(),this.mo.Oo(),this.Ro.set("Unknown"),[2]}})})},Ah.prototype.listen=function(t){this.fo.has(t.targetId)||(this.fo.set(t.targetId,t),this.Do()?this.Fo():this.Ao.vr()&&this.xo(t))},Ah.prototype.Lo=function(t){this.fo.delete(t),this.Ao.vr()&&this.Mo(t),0===this.fo.size&&(this.Ao.vr()?this.Ao.Cr():this.Eo()&&this.Ro.set("Unknown"))},Ah.prototype.Le=function(t){return this.fo.get(t)||null},Ah.prototype.xe=function(t){return this.qo.xe(t)},Ah.prototype.xo=function(t){this.do.we(t.targetId),this.Ao.Wr(t)},Ah.prototype.Mo=function(t){this.do.we(t),this.Ao.Qr(t)},Ah.prototype.Fo=function(){this.do=new no(this),this.Ao.start(),this.Ro.ro()},Ah.prototype.Do=function(){return this.Eo()&&!this.Ao.gr()&&0<this.fo.size},Ah.prototype.Eo=function(){return 0===this.wo.size},Ah.prototype.ko=function(){this.do=null},Ah.prototype.Po=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fo.forEach(function(t,e){n.xo(t)}),[2]})})},Ah.prototype.Vo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ko(),this.Do()?(this.Ro.ao(e),this.Fo()):this.Ro.set("Unknown"),[2]})})},Ah.prototype.yo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.Ro.set("Online"),!(r instanceof Qr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Uo(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Li("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Bo(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof Hr?this.do.Ve(r):r instanceof Xr?this.do.De(r):this.do.ge(r),o.isEqual(tr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Sa(this.co)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Wo(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Li("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Bo(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Ah.prototype.Bo=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!ca(n))throw n;return this.wo.add(1),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),i=i||function(){return Sa(e.co)},this.Rs.Bs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Li("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.wo.delete(1),[4,this.Co()];case 2:return t.sent(),[2]}})})}),[2]}})})},Ah.prototype.Qo=function(e){var n=this;return e().catch(function(t){return n.Bo(t,e)})},Ah.prototype.Wo=function(i){var r=this,t=this.do.$e(i);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=r.fo.get(e))&&r.fo.set(e,n.et(t.resumeToken,i))}),t.jt.forEach(function(t){var e,n=r.fo.get(t);n&&(r.fo.set(t,n.et(Er.J,n.Z)),r.Mo(t),e=new Rr(n.target,t,1,n.sequenceNumber),r.xo(e))}),this.qo.jo(t)},Ah.prototype.Uo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.fo.has(r)?[4,this.qo.Go(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.fo.delete(r),this.do.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Ah.prototype.No=function(){return d(this,void 0,void 0,function(){var r,o,s;return y(this,function(t){switch(t.label){case 0:r=0<this._o.length?this._o[this._o.length-1].batchId:-1,t.label=1;case 1:if(!this.Ko())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.co,n=r,(i=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),i.$n.qi(t,n)}))];case 3:return null===(o=t.sent())?(0===this._o.length&&this.po.Cr(),[3,7]):(r=o.batchId,this.zo(o),[3,6]);case 4:return s=t.sent(),[4,this.Bo(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ho()&&this.Yo(),[2]}var e,n,i})})},Ah.prototype.Ko=function(){return this.Eo()&&this._o.length<10},Ah.prototype.Jo=function(){return this._o.length},Ah.prototype.zo=function(t){this._o.push(t),this.po.vr()&&this.po.Gr&&this.po.Kr(t.mutations)},Ah.prototype.Ho=function(){return this.Eo()&&!this.po.gr()&&0<this._o.length},Ah.prototype.Yo=function(){this.po.start()},Ah.prototype.vo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.po.Yr(),[2]})})},Ah.prototype.So=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this._o;e<n.length;e++)i=n[e],this.po.Kr(i.mutations);return[2]})})},Ah.prototype.zr=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this._o.shift(),n=Yu.from(e,r,o),[4,this.Qo(function(){return i.qo.Xo(n)})];case 1:return t.sent(),[4,this.No()];case 2:return t.sent(),[2]}})})},Ah.prototype.bo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.po.Gr?[4,this.Zo(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ho()&&this.Yo(),[2]}})})},Ah.prototype.Zo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Sr(n=r.code)&&n!==Ki.ABORTED?(e=this._o.shift(),this.po.Sr(),[4,this.Qo(function(){return i.qo.th(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.No()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Ah.prototype.Io=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(4),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),this.po.Sr(),this.Ao.Sr(),this.wo.delete(4),[4,this.Co()];case 2:return t.sent(),[2]}})})},Ah.prototype.eh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rs.js(),Li("RemoteStore","RemoteStore received new credentials"),this.wo.add(3),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),[4,this.qo.eh(e)];case 2:return t.sent(),this.wo.delete(3),[4,this.Co()];case 3:return t.sent(),[2]}})})},Ah.prototype.nh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.wo.delete(2),[4,this.Co()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.wo.add(2),[4,this.$o()]);case 3:t.sent(),this.Ro.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Ah),oh=(Ih.prototype.sh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ih.prototype.ih=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ih.prototype.rh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ih),sh=(Eh.prototype.ah=function(t){},Eh.prototype.uh=function(t,e,n){},Eh.prototype.lh=function(t){return this.oh.sh(t),this.hh[t]||"not-current"},Eh.prototype._h=function(t,e,n){this.hh[t]=e},Eh.prototype.fh=function(t){this.oh.ih(t)},Eh.prototype.dh=function(t){return this.oh.activeTargetIds.has(t)},Eh.prototype.wh=function(t){delete this.hh[t]},Eh.prototype.mh=function(){return this.oh.activeTargetIds},Eh.prototype.Th=function(t){return this.oh.activeTargetIds.has(t)},Eh.prototype.start=function(){return this.oh=new oh,Promise.resolve()},Eh.prototype.Eh=function(t,e,n){},Eh.prototype.Ih=function(t){},Eh.prototype.Oo=function(){},Eh.prototype.ss=function(t){},Eh),uh=(Object.defineProperty(bh.prototype,"ph",{get:function(){return this.Rh},enumerable:!1,configurable:!0}),bh.prototype.gh=function(t,e){var u=this,a=e?e.vh:new Kr,h=e?e.yh:this.yh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.an()&&h.size===this.query.limit?h.last():null,d=this.query.un()&&h.size===this.query.limit?h.first():null;if(t.ht(function(t,e){var n=h.get(t),i=(i=e instanceof Zs?e:null)&&(gu(u.query,i)?i:null),r=!!n&&u.qt.has(n.key),o=!!i&&(i.Ke||u.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.bh(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.Vh(i,p)||d&&u.Vh(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.an()||this.query.un())for(;l.size>this.query.limit;){var n=this.query.an()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{yh:l,vh:a,Sh:f,qt:c}},bh.prototype.bh=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},bh.prototype.Ch=function(t,e,n){var o=this,i=this.yh;this.yh=t.yh,this.qt=t.qt;var r=t.vh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.Vh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ci()}}var i,r}),this.Dh(n);var s=e?this.Fh():[],u=0===this.Ph.size&&this.Yt?1:0,a=u!==this.Ah;return this.Ah=u,0!==r.length||a?{snapshot:new Zr(this.query,t.yh,i,r,t.qt,0==u,a,!1),Nh:s}:{Nh:s}},bh.prototype.$h=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Ch({yh:this.yh,vh:new Kr,qt:this.qt,Sh:!1},!1)):{Nh:[]}},bh.prototype.kh=function(t){return!this.Rh.has(t)&&!!this.yh.has(t)&&!this.yh.get(t).Ke},bh.prototype.Dh=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.Rh=e.Rh.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.Rh=e.Rh.delete(t)}),this.Yt=t.Yt)},bh.prototype.Fh=function(){var e=this;if(!this.Yt)return[];var n=this.Ph;this.Ph=zr(),this.yh.forEach(function(t){e.kh(t.key)&&(e.Ph=e.Ph.add(t.key))});var i=[];return n.forEach(function(t){e.Ph.has(t)||i.push(new Fa(t))}),this.Ph.forEach(function(t){n.has(t)||i.push(new ja(t))}),i},bh.prototype.Oh=function(t){this.Rh=t.Wi,this.Ph=zr();var e=this.gh(t.documents);return this.Ch(e,!0)},bh.prototype.xh=function(){return Zr.Wt(this.query,this.yh,this.qt,0===this.Ah)},bh),ah=(Object.defineProperty(wh.prototype,"Zh",{get:function(){return!0===this.Xh},enumerable:!1,configurable:!0}),wh.prototype.subscribe=function(t){this.Bh=t},wh.prototype.listen=function(h){return d(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return this.ta("listen()"),(s=this.Wh.get(h))?(n=s.targetId,this.qh.lh(n),o=s.view.xh(),[3,4]):[3,1];case 1:return[4,(e=this.co,i=cu(h),(r=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ii.Ui(e,i).next(function(t){return t?(n=t,Ku.resolve(n)):r.Ii.ea(e).next(function(t){return n=new Rr(i,t,0,e.$i),r.Ii.na(e,n).next(function(){return n})})})}).then(function(t){var e=r.fi.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(r.fi=r.fi.st(t.targetId,t),r.di.set(i,t.targetId)),t}))];case 2:return u=t.sent(),a=this.qh.lh(u.targetId),n=u.targetId,[4,this.sa(h,n,"current"===a)];case 3:o=t.sent(),this.Zh&&this.Mh.listen(u),t.label=4;case 4:return[2,o]}var e,i,r})})},wh.prototype.sa=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,La(this.co,u,!0)];case 1:return e=t.sent(),n=new uh(u,e.Wi),i=n.gh(e.documents),r=to.Ht(a,h&&"Offline"!==this.onlineState),o=n.Ch(i,this.Zh,r),this.ia(a,o.Nh),s=new Ga(u,a,n),[2,(this.Wh.set(u,s),this.Qh.has(a)?this.Qh.get(a).push(u):this.Qh.set(a,[u]),o.snapshot)]}})})},wh.prototype.Lo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.ta("unlisten()"),e=this.Wh.get(r),1<(n=this.Qh.get(e.targetId)).length?[2,(this.Qh.set(e.targetId,n.filter(function(t){return!du(t,r)})),void this.Wh.delete(r))]:this.Zh?(this.qh.fh(e.targetId),this.qh.Th(e.targetId)?[3,2]:[4,Oa(this.co,e.targetId,!1).then(function(){i.qh.wh(e.targetId),i.Mh.Lo(e.targetId),i.ra(e.targetId)}).catch(Da)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ra(e.targetId),[4,Oa(this.co,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},wh.prototype.write=function(s,u){return d(this,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:this.ta("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.co,h=s,l=e,f=Ji.now(),n=h.reduce(function(t,e){return t.add(e.key)},zr()),l.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ai.Un(a,n).next(function(t){c=t;for(var u,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(u=o,e=c.get(o.key),u instanceof Cs?function(t){for(var e=null,n=0,i=u.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Zs?t.field(r.field):void 0,s=Zo(r.transform,o||null);null!=s&&(e=null==e?(new Bs).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Os(o.key,s,function u(t){var a=[];return zi(t.fields||{},function(t,e){var n=new rr([t]);if(Oo(e)){var i=u(e.mapValue).fields;if(0===i.length)a.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];a.push(n.child(s))}}else a.push(n)}),new vs(a)}(s.proto.mapValue),ws.exists(!0)))}return l.$n.oa(a,f,n,h)})}).then(function(t){var e=t.Rn(c);return{batchId:t.batchId,ha:e}}))];case 2:return i=t.sent(),this.qh.ah(i.batchId),this.aa(i.batchId,u),[4,this.ua(i.ha)];case 3:return t.sent(),[4,this.Mh.No()];case 4:return t.sent(),[3,6];case 5:return r=t.sent(),o=va(r,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,h,c,l,f,n})})},wh.prototype.jo=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.ta("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,_a(this.co,n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=i.Kh.get(e);n&&(Ui(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.Lh=!0:0<t.Xt.size?Ui(n.Lh):0<t.Zt.size&&(Ui(n.Lh),n.Lh=!1))}),[4,this.ua(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},wh.prototype.$h=function(i,t){var r;(this.Zh&&0===t||!this.Zh&&1===t)&&(this.ta("applyOnlineStateChange()"),r=[],this.Wh.forEach(function(t,e){var n=e.view.$h(i);n.snapshot&&r.push(n.snapshot)}),this.Bh.ca(i),this.Bh.Br(r),this.onlineState=i,this.Zh&&this.qh.Ih(i))},wh.prototype.Go=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ta("rejectListens()"),this.qh._h(u,"rejected",a),e=this.Kh.get(u),(n=e&&e.key)?(i=(i=new Or(or.P)).st(n,new Js(n,tr.min())),r=zr().add(n),o=new Jr(tr.min(),new Map,new Mr(xi),i,r),[4,this.jo(o)]):[3,2];case 1:return t.sent(),this.Gh=this.Gh.remove(n),this.Kh.delete(u),this.la(),[3,4];case 2:return[4,Oa(this.co,u,!1).then(function(){return s.ra(u,a)}).catch(Da)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},wh.prototype.Xo=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.ta("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,ka(this.co,i)];case 2:return n=t.sent(),this._a(e,null),this.fa(e),this.qh.uh(e,"acknowledged"),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},wh.prototype.th=function(o,s){return d(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:this.ta("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,i=o,(r=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.$n.da(e,i).next(function(t){return Ui(null!==t),n=t.keys(),r.$n.Si(e,t)}).next(function(){return r.$n.Ci(e)}).next(function(){return r.Ai.Un(e,n)})}))];case 2:return n=t.sent(),this._a(o,s),this.fa(o),this.qh.uh(o,"rejected",s),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,Da(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,i,r})})},wh.prototype.wa=function(u){return d(this,void 0,void 0,function(){var i,r,o,s;return y(this,function(t){switch(t.label){case 0:this.Mh.Eo()||Li("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.co,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.$n.ma(t)}))];case 2:return-1===(i=t.sent())?[2,void u.resolve()]:((r=this.Yh.get(i)||[]).push(u),this.Yh.set(i,r),[3,4]);case 3:return o=t.sent(),s=va(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},wh.prototype.fa=function(t){(this.Yh.get(t)||[]).forEach(function(t){t.resolve()}),this.Yh.delete(t)},wh.prototype.Ta=function(e){this.Yh.forEach(function(t){t.forEach(function(t){t.reject(new Zi(Ki.CANCELLED,e))})}),this.Yh.clear()},wh.prototype.aa=function(t,e){var n=this.Hh[this.currentUser.rr()];n=(n=n||new Or(xi)).st(t,e),this.Hh[this.currentUser.rr()]=n},wh.prototype._a=function(t,e){var n,i=this.Hh[this.currentUser.rr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Hh[this.currentUser.rr()]=i)},wh.prototype.ra=function(t,e){var n=this;void 0===e&&(e=null),this.qh.fh(t);for(var i=0,r=this.Qh.get(t);i<r.length;i++){var o=r[i];this.Wh.delete(o),e&&this.Bh.Ea(o,e)}this.Qh.delete(t),this.Zh&&this.zh.Zi(t).forEach(function(t){n.zh.nr(t)||n.Ia(t)})},wh.prototype.Ia=function(t){var e=this.Gh.get(t);null!==e&&(this.Mh.Lo(e),this.Gh=this.Gh.remove(t),this.Kh.delete(e),this.la())},wh.prototype.ia=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof ja?(this.zh.zi(r.key,t),this.Ra(r)):r instanceof Fa?(Li("SyncEngine","Document no longer in limbo: "+r.key),this.zh.Yi(r.key,t),this.zh.nr(r.key)||this.Ia(r.key)):Ci()}},wh.prototype.Ra=function(t){var e=t.key;this.Gh.get(e)||(Li("SyncEngine","New document in limbo: "+e),this.jh.push(e),this.la())},wh.prototype.la=function(){for(;0<this.jh.length&&this.Gh.size<this.Uh;){var t=this.jh.shift(),e=this.Jh.next();this.Kh.set(e,new Ba(t)),this.Gh=this.Gh.st(t,e),this.Mh.listen(new Rr(cu(uu(t.path)),e,2,ta.rs))}},wh.prototype.Aa=function(){return this.Gh},wh.prototype.Pa=function(){return this.jh},wh.prototype.ua=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wh.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.gh(i);return n.Sh?La(u.co,r.query,!1).then(function(t){var e=t.documents;return r.view.gh(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(r.targetId),i=r.view.Ch(t,u.Zh,n);u.ia(r.targetId,i.Nh),i.snapshot&&(u.Zh&&u.qh._h(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=Ju.Zn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bh.Br(o),[4,function(c,l){return d(this,void 0,void 0,function(){var i,e,n,r,o,s,u,a,h;return y(this,function(t){switch(t.label){case 0:i=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ku.forEach(l,function(e){return Ku.forEach(e.Jn,function(t){return i.persistence.Li.zi(n,e.targetId,t)}).next(function(){return Ku.forEach(e.Xn,function(t){return i.persistence.Li.Yi(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ca(e=t.sent()))throw e;return Li("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,r=l;n<r.length;n++)o=r[n],s=o.targetId,o.fromCache||(u=i.fi.get(s),a=u.Z,h=u.nt(a),i.fi=i.fi.st(s,h));return[2]}})})}(this.co,s)];case 2:return t.sent(),[2]}})})},wh.prototype.ta=function(t){},wh.prototype.eh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Li("SyncEngine","User change. New user:",n.rr()),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,m,i;return y(this,function(t){switch(t.label){case 0:return n=(e=r).$n,m=e.Ai,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.$n.Va(v).next(function(t){return g=t,n=e.persistence.mi(o),m=new Zu(e.Ti,n,e.persistence.Pi()),n.Va(v)}).next(function(t){for(var e=[],n=[],i=zr(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Un(v,i).next(function(t){return{ya:t,pa:e,ga:n}})})})];case 1:return i=t.sent(),[2,(e.$n=n,e.Ai=m,e._i.Vi(e.Ai),i)]}})})}(this.co,n)]);case 1:return e=t.sent(),this.currentUser=n,this.Ta("'waitForPendingWrites' promise is rejected due to a user change."),this.qh.Eh(n,e.pa,e.ga),[4,this.ua(e.ya)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},wh.prototype.xe=function(t){var e=this.Kh.get(t);if(e&&e.Lh)return zr().add(e.key);var n=zr(),i=this.Qh.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Wh.get(s),n=n.Ft(u.view.ph);return n},wh),hh=(mh.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.ba.get(e))||(n=!0,i=new Wa),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.qo.listen(e)];case 2:return r.va=t.sent(),[3,4];case 3:return o=t.sent(),s=va(o,"Initialization of query '"+vu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.ba.set(e,i),i.listeners.push(u),u.$h(this.onlineState),i.va&&u.Ca(i.va)&&this.Da(),[2]}})})},mh.prototype.Lo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.ba.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.ba.delete(e),this.qo.Lo(e))]:[2]})})},mh.prototype.Br=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.ba.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ca(r)&&(e=!0);s.va=r}}e&&this.Da()},mh.prototype.Ea=function(t,e){var n=this.ba.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.ba.delete(t)},mh.prototype.ca=function(r){this.onlineState=r;var o=!1;this.ba.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].$h(r)&&(o=!0)}),o&&this.Da()},mh.prototype.Fa=function(t){this.Sa.add(t),t.next()},mh.prototype.Na=function(t){this.Sa.delete(t)},mh.prototype.Da=function(){this.Sa.forEach(function(t){t.next()})},mh),ch=(gh.prototype.Ca=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Zr(t.query,t.docs,t.Mt,e,t.qt,t.fromCache,t.Ut,!0)}var o=!1;return this.ka?this.xa(t)&&(this.$a.next(t),o=!0):this.La(t,this.onlineState)&&(this.Ma(t),o=!0),this.Oa=t,o},gh.prototype.onError=function(t){this.$a.error(t)},gh.prototype.$h=function(t){this.onlineState=t;var e=!1;return this.Oa&&!this.ka&&this.La(this.Oa,t)&&(this.Ma(this.Oa),e=!0),e},gh.prototype.La=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.qa&&n||t.docs._()&&"Offline"!==e)},gh.prototype.xa=function(t){if(0<t.docChanges.length)return!0;var e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ut&&!e)&&!0===this.options.includeMetadataChanges},gh.prototype.Ma=function(t){t=Zr.Wt(t.query,t.docs,t.qt,t.fromCache),this.ka=!0,this.$a.next(t)},gh),lh=(vh.prototype.Vi=function(t){this.Ua=t},vh.prototype.Qn=function(e,i,r,o){var s=this;return i.hn()||r.isEqual(tr.min())?this.Ba(e,i):this.Ua.Un(e,o).next(function(t){var n=s.Wa(i,t);return(i.an()||i.un())&&s.Sh(i.nn,n,o,r)?s.Ba(e,i):(Oi()<=u.DEBUG&&Li("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),vu(i)),s.Ua.Qn(e,i,r).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},vh.prototype.Wa=function(n,t){var i=new Mr(mu(n));return t.forEach(function(t,e){e instanceof Zs&&gu(n,e)&&(i=i.add(e))}),i},vh.prototype.Sh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},vh.prototype.Ba=function(t,e){return Oi()<=u.DEBUG&&Li("IndexFreeQueryEngine","Using full collection scan to execute query:",vu(e)),this.Ua.Qn(t,e,tr.min())},vh),fh=(yh.prototype.Ga=function(t){return Ku.resolve(0===this.$n.length)},yh.prototype.oa=function(t,e,n,i){var r=this.Qa;this.Qa++,0<this.$n.length&&this.$n[this.$n.length-1];var o=new Qu(r,e,n,i);this.$n.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.ja=this.ja.add(new Va(a.key,r)),this.kn.ai(t,a.key.path.g())}return Ku.resolve(o)},yh.prototype.da=function(t,e){return Ku.resolve(this.Ka(e))},yh.prototype.qi=function(t,e){var n=e+1,i=this.za(n),r=i<0?0:i;return Ku.resolve(this.$n.length>r?this.$n[r]:null)},yh.prototype.ma=function(){return Ku.resolve(0===this.$n.length?-1:this.Qa-1)},yh.prototype.Va=function(t){return Ku.resolve(this.$n.slice())},yh.prototype.xn=function(t,e){var n=this,i=new Va(e,0),r=new Va(e,Number.POSITIVE_INFINITY),o=[];return this.ja.St([i,r],function(t){var e=n.Ka(t.sr);o.push(e)}),Ku.resolve(o)},yh.prototype.Wn=function(t,e){var i=this,r=new Mr(xi);return e.forEach(function(t){var e=new Va(t,0),n=new Va(t,Number.POSITIVE_INFINITY);i.ja.St([e,n],function(t){r=r.add(t.sr)})}),Ku.resolve(this.Ha(r))},yh.prototype.Hn=function(t,e){var n=e.path,i=n.length+1,r=n;or.j(r)||(r=r.child(""));var o=new Va(new or(r),0),s=new Mr(xi);return this.ja.Ct(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.sr)),!0)},o),Ku.resolve(this.Ha(s))},yh.prototype.Ha=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Ka(t);null!==e&&i.push(e)}),i},yh.prototype.Si=function(n,i){var r=this;Ui(0===this.Ya(i.batchId,"removed")),this.$n.shift();var o=this.ja;return Ku.forEach(i.mutations,function(t){var e=new Va(t.key,i.batchId);return o=o.delete(e),r.Li.Ja(n,t.key)}).next(function(){r.ja=o})},yh.prototype.Xa=function(t){},yh.prototype.nr=function(t,e){var n=new Va(e,0),i=this.ja.Dt(n);return Ku.resolve(e.isEqual(i&&i.key))},yh.prototype.Ci=function(t){return this.$n.length,Ku.resolve()},yh.prototype.Ya=function(t,e){return this.za(t)},yh.prototype.za=function(t){return 0===this.$n.length?0:t-this.$n[0].batchId},yh.prototype.Ka=function(t){var e=this.za(t);return e<0||e>=this.$n.length?null:this.$n[e]},yh),ph=(dh.prototype.bi=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Za(e);return this.docs=this.docs.st(i,{tu:e,size:s,readTime:n}),this.size+=s-o,this.kn.ai(t,i.path.g())},dh.prototype.Oi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dh.prototype.Mn=function(t,e){var n=this.docs.get(e);return Ku.resolve(n?n.tu:null)},dh.prototype.getEntries=function(t,e){var n=this,i=xr;return e.forEach(function(t){var e=n.docs.get(t);i=i.st(t,e?e.tu:null)}),Ku.resolve(i)},dh.prototype.Qn=function(t,e,n){for(var i=Gr,r=new or(e.path.child("")),o=this.docs.ct(r);o.Tt();){var s=o.wt(),u=s.key,a=s.value,h=a.tu,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Zs&&gu(e,h)&&(i=i.st(h.key,h))}return Ku.resolve(i)},dh.prototype.eu=function(t,e){return Ku.forEach(this.docs,function(t){return e(t)})},dh.prototype.gi=function(t){return new dh.nu(this)},dh.prototype.su=function(t){return Ku.resolve(this.size)},dh);function dh(t,e){this.kn=t,this.Za=e,this.docs=new Or(or.P),this.size=0}function yh(t,e){this.kn=t,this.Li=e,this.$n=[],this.Qa=1,this.ja=new Mr(Va.ji)}function vh(){}function gh(t,e,n){this.query=t,this.$a=e,this.ka=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}function mh(t){this.qo=t,this.ba=new Yi(yu,du),this.onlineState="Unknown",this.Sa=new Set,this.qo.subscribe(this)}function wh(t,e,n,i,r,o){this.co=t,this.Mh=e,this.lo=n,this.qh=i,this.currentUser=r,this.Uh=o,this.Bh=null,this.Wh=new Yi(yu,du),this.Qh=new Map,this.jh=[],this.Gh=new Or(or.P),this.Kh=new Map,this.zh=new Pa,this.Hh={},this.Yh=new Map,this.Jh=Ea.li(),this.onlineState="Unknown",this.Xh=void 0}function bh(t,e){this.query=t,this.Rh=e,this.Ah=null,this.Yt=!1,this.Ph=zr(),this.qt=zr(),this.Vh=mu(t),this.yh=new Yr(this.Vh)}function Eh(){this.oh=new oh,this.hh={},this.eo=null,this.ts=null}function Ih(){this.activeTargetIds=$r}function Ah(t,e,n,i,r){var o,s,u,a,h,c,l,f,p=this;this.co=t,this.lo=e,this.Rs=n,this._o=[],this.fo=new Map,this.do=null,this.wo=new Set,this.mo=r,this.mo.To(function(t){n.vs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(Li("RemoteStore","Restarting streams for network reachability change."),[4,this.Io()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ro=new ih(n,i),this.Ao=(h=this.lo,c=n,l={qr:this.Po.bind(this),kr:this.Vo.bind(this),Br:this.yo.bind(this)},(f=h).Xr(),new th(c,f.Pr,f.credentials,f.serializer,l)),this.po=(o=this.lo,s=n,u={qr:this.vo.bind(this),kr:this.bo.bind(this),Hr:this.So.bind(this),zr:this.zr.bind(this)},(a=o).Xr(),new eh(s,a.Pr,a.credentials,a.serializer,u))}function Th(t,e){this.Rs=t,this.eo=e,this.state="Unknown",this.no=0,this.so=null,this.io=!0}function Nh(t,e,n){var i=this;return(i=za.call(this)||this).credentials=t,i.Pr=e,i.serializer=n,i.Jr=!1,i}function Rh(t,e,n,i,r){var o=this;return(o=$a.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.jr=!1,o}function kh(t,e,n,i,r){var o=this;return(o=Ha.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Sh(t,e,n,i,r,o){this.os=t,this.Ar=n,this.Pr=i,this.Vr=r,this.listener=o,this.state=0,this.yr=0,this.pr=null,this.stream=null,this.ks=new aa(t,e)}function _h(t,e){this.Er=t,this.Ir=e}function Oh(t,e){this.Er=t,this.Ir=e,this.type="FirstParty",this.user=Ca.hr}function Lh(t){var e=this;this.dr=null,this.currentUser=Ca.UNAUTHENTICATED,this.wr=!1,this.mr=0,this.ur=null,this.forceRefresh=!1,this.dr=function(){e.mr++,e.currentUser=e.Tr(),e.wr=!0,e.ur&&e.ur(e.currentUser)},this.mr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.dr):(this.dr(null),t.get().then(function(t){e.auth=t,e.dr&&e.auth.addAuthTokenListener(e.dr)},function(){}))}function Dh(){this.ur=null}function Ph(t){var e=this;return(e=Xa.call(this)||this).uu=t,e}function Vh(){this.ha=new Yi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.iu=!1}ph.nu=(Object.defineProperty(Vh.prototype,"readTime",{get:function(){return this.ru},set:function(t){this.ru=t},enumerable:!1,configurable:!0}),Vh.prototype.bi=function(t,e){this.ou(),this.readTime=e,this.ha.set(t.key,t)},Vh.prototype.Oi=function(t,e){this.ou(),e&&(this.readTime=e),this.ha.set(t,null)},Vh.prototype.Mn=function(t,e){this.ou();var n=this.ha.get(e);return void 0!==n?Ku.resolve(n):this.hu(t,e)},Vh.prototype.getEntries=function(t,e){return this.au(t,e)},Vh.prototype.apply=function(t){return this.ou(),this.iu=!0,this.Ch(t)},Vh.prototype.ou=function(){},o(Ph,Xa=Vh),Ph.prototype.Ch=function(n){var i=this,r=[];return this.ha.forEach(function(t,e){e?r.push(i.uu.bi(n,e,i.readTime)):i.uu.Oi(t)}),Ku.Dn(r)},Ph.prototype.hu=function(t,e){return this.uu.Mn(t,e)},Ph.prototype.au=function(t,e){return this.uu.getEntries(t,e)},Ph);var Ch,Uh,Mh=(ec.prototype.ve=function(t,n){return this.cu.forEach(function(t,e){return n(e)}),Ku.resolve()},ec.prototype.Di=function(t){return Ku.resolve(this.lastRemoteSnapshotVersion)},ec.prototype.du=function(t){return Ku.resolve(this.lu)},ec.prototype.ea=function(t){return this.highestTargetId=this.fu.next(),Ku.resolve(this.highestTargetId)},ec.prototype.Mi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.lu&&(this.lu=e),Ku.resolve()},ec.prototype.wu=function(t){this.cu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fu=new Ea(e),this.highestTargetId=e),t.sequenceNumber>this.lu&&(this.lu=t.sequenceNumber)},ec.prototype.na=function(t,e){return this.wu(e),this.targetCount+=1,Ku.resolve()},ec.prototype.ki=function(t,e){return this.wu(e),Ku.resolve()},ec.prototype.mu=function(t,e){return this.cu.delete(e.target),this._u.Zi(e.targetId),--this.targetCount,Ku.resolve()},ec.prototype.Tu=function(n,i,r){var o=this,s=0,u=[];return this.cu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.cu.delete(t),u.push(o.Eu(n,e.targetId)),s++)}),Ku.Dn(u).next(function(){return s})},ec.prototype.Iu=function(t){return Ku.resolve(this.targetCount)},ec.prototype.Ui=function(t,e){var n=this.cu.get(e)||null;return Ku.resolve(n)},ec.prototype.Ni=function(t,e,n){return this._u.Hi(e,n),Ku.resolve()},ec.prototype.Fi=function(e,t,n){this._u.Xi(t,n);var i=this.persistence.Li,r=[];return i&&t.forEach(function(t){r.push(i.Ja(e,t))}),Ku.Dn(r)},ec.prototype.Eu=function(t,e){return this._u.Zi(e),Ku.resolve()},ec.prototype.Bi=function(t,e){var n=this._u.er(e);return Ku.resolve(n)},ec.prototype.nr=function(t,e){return Ku.resolve(this._u.nr(e))},ec),qh=(tc.prototype.start=function(){return Promise.resolve()},tc.prototype.Oo=function(){return this.Pu=!1,Promise.resolve()},Object.defineProperty(tc.prototype,"yu",{get:function(){return this.Pu},enumerable:!1,configurable:!0}),tc.prototype.pu=function(){},tc.prototype.gu=function(){},tc.prototype.Pi=function(){return this.kn},tc.prototype.mi=function(t){var e=this.Ru[t.rr()];return e||(e=new fh(this.kn,this.Li),this.Ru[t.rr()]=e),e},tc.prototype.Ri=function(){return this.Ii},tc.prototype.Ei=function(){return this.Nn},tc.prototype.runTransaction=function(t,e,n){var i=this;Li("MemoryPersistence","Starting transaction:",t);var r=new xh(this.Au.next());return this.Li.vu(),n(r).next(function(t){return i.Li.bu(r).next(function(){return t})}).Sn().then(function(t){return r.Su(),t})},tc.prototype.Cu=function(e,n){return Ku.Fn(Object.values(this.Ru).map(function(t){return function(){return t.nr(e,n)}}))},tc),xh=(Jh.prototype.Fu=function(t){this.Du.push(t)},Jh.prototype.Su=function(){this.Du.forEach(function(t){return t()})},o(Zh,Uh=Jh),Zh),jh=(Kh.ku=function(t){return new Kh(t)},Object.defineProperty(Kh.prototype,"Ou",{get:function(){if(this.$u)return this.$u;throw Ci()},enumerable:!1,configurable:!0}),Kh.prototype.zi=function(t,e,n){return this.Nu.zi(n,e),this.Ou.delete(n.toString()),Ku.resolve()},Kh.prototype.Yi=function(t,e,n){return this.Nu.Yi(n,e),this.Ou.add(n.toString()),Ku.resolve()},Kh.prototype.Ja=function(t,e){return this.Ou.add(e.toString()),Ku.resolve()},Kh.prototype.removeTarget=function(t,e){var n=this;this.Nu.Zi(e.targetId).forEach(function(t){return n.Ou.add(t.toString())});var i=this.persistence.Ri();return i.Bi(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ou.add(t.toString())})}).next(function(){return i.mu(t,e)})},Kh.prototype.vu=function(){this.$u=new Set},Kh.prototype.bu=function(n){var i=this,r=this.persistence.Ei().gi();return Ku.forEach(this.Ou,function(t){var e=or.U(t);return i.xu(n,e).next(function(t){t||r.Oi(e)})}).next(function(){return i.$u=null,r.apply(n)})},Kh.prototype.xi=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Ou.delete(e.toString()):n.Ou.add(e.toString())})},Kh.prototype.Vu=function(t){return 0},Kh.prototype.xu=function(t,e){var n=this;return Ku.Fn([function(){return Ku.resolve(n.Nu.nr(e))},function(){return n.persistence.Ri().nr(t,e)},function(){return n.persistence.Cu(t,e)}])},Kh),Fh=(Yh.prototype.qr=function(t){this.qu=t},Yh.prototype.kr=function(t){this.Uu=t},Yh.prototype.onMessage=function(t){this.Bu=t},Yh.prototype.close=function(){this.Mu()},Yh.prototype.send=function(t){this.Lu(t)},Yh.prototype.Wu=function(){this.qu()},Yh.prototype.Qu=function(t){this.Uu(t)},Yh.prototype.ju=function(t){this.Bu(t)},Yh),Gh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Bh=(Qh.prototype.Zr=function(e,t,n,i){var r=this.Hu(e,t);Li("RestConnection","Sending: ",r,n);var o={};return this.Yu(o,i),this.Ju(e,r,o,n).then(function(t){return Li("RestConnection","Received: ",t),t},function(t){throw Pi("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},Qh.prototype.to=function(t,e,n,i){return this.Zr(t,e,n,i)},Qh.prototype.Yu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(var n in e.ar)e.ar.hasOwnProperty(n)&&(t[n]=e.ar[n])},Qh.prototype.Hu=function(t,e){var n=Gh[t];return this.Ku+"/v1/"+e+":"+n},o(Xh,Ch=Qh),Xh.prototype.Ju=function(a,e,n,i){return new Promise(function(o,s){var u=new Ri;u.listenOnce(Ti.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ai.NO_ERROR:var t=u.getResponseJson();Li("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ai.TIMEOUT:Li("Connection",'RPC "'+a+'" timed out'),s(new Zi(Ki.DEADLINE_EXCEEDED,"Request time out"));break;case Ai.HTTP_ERROR:var e,n,i=u.getStatus();Li("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Ki).indexOf(r)?r:Ki.UNKNOWN,s(new Zi(n,e.message))):s(new Zi(Ki.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Zi(Ki.UNAVAILABLE,"Connection failed."));break;default:Ci()}}finally{Li("Connection",'RPC "'+a+'" completed.')}var r});var t=JSON.stringify(i);u.send(e,"POST",t,n,15)})},Xh.prototype.Ur=function(t,e){var n,i,r=[this.Ku,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ii(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Yu(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(i=g()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Li("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Fh({Lu:function(t){l?Li("Connection","Not sending because WebChannel is closed:",t):(c||(Li("Connection","Opening WebChannel transport."),h.open(),c=!0),Li("Connection","WebChannel sending:",t),h.send(t))},Mu:function(){return h.close()}});return a(Ni.EventType.OPEN,function(){l||Li("Connection","WebChannel transport opened.")}),a(Ni.EventType.CLOSE,function(){l||(l=!0,Li("Connection","WebChannel transport closed"),f.Qu())}),a(Ni.EventType.ERROR,function(t){l||(l=!0,Pi("Connection","WebChannel transport errored:",t),f.Qu(new Zi(Ki.UNAVAILABLE,"The operation could not be completed")))}),a(Ni.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Ui(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Li("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Tr[r];if(void 0!==t)return _r(t)}(),s=i.message,void 0===o&&(o=Ki.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Qu(new Zi(o,s)),h.close()):(Li("Connection","WebChannel received:",n),f.ju(n)))}),setTimeout(function(){f.Wu()},0),f},Xh),Wh=(Hh.prototype.To=function(t){this.nc.push(t)},Hh.prototype.Oo=function(){window.removeEventListener("online",this.Xu),window.removeEventListener("offline",this.tc)},Hh.prototype.sc=function(){window.addEventListener("online",this.Xu),window.addEventListener("offline",this.tc)},Hh.prototype.Zu=function(){Li("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(0)},Hh.prototype.ec=function(){Li("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(1)},Hh.ic=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Hh),zh=($h.prototype.To=function(t){},$h.prototype.Oo=function(){},$h);function $h(){}function Hh(){var t=this;this.Xu=function(){return t.Zu()},this.tc=function(){return t.ec()},this.nc=[],this.sc()}function Xh(t){var e=this;return(e=Ch.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Qh(t){this.Gu=t,this.s=t.s;var e=t.ssl?"https":"http";this.Ku=e+"://"+t.host,this.zu="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Yh(t){this.Lu=t.Lu,this.Mu=t.Mu}function Kh(t){this.persistence=t,this.Nu=new Pa,this.$u=null}function Zh(t){var e=this;return(e=Uh.call(this)||this).$i=t,e}function Jh(){this.Du=[]}function tc(t){var e=this;this.Ru={},this.Au=new ta(0),this.Pu=!1,this.Pu=!0,this.Li=t(this),this.Ii=new Mh(this),this.kn=new wa,this.Nn=new ph(this.kn,function(t){return e.Li.Vu(t)})}function ec(t){this.persistence=t,this.cu=new Yi(mr,wr),this.lastRemoteSnapshotVersion=tr.min(),this.highestTargetId=0,this.lu=0,this._u=new Pa,this.targetCount=0,this.fu=Ea.ci()}function nc(t){return new Po(t,!0)}var ic="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",rc=(uc.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.qh=this.rc(e),this.persistence=this.oc(e),[4,this.persistence.start()];case 1:return t.sent(),this.hc=this.ac(e),this.co=this.uc(e),[2]}})})},uc.prototype.ac=function(t){return null},uc.prototype.uc=function(t){return e=this.persistence,n=new lh,i=t.cc,new Ia(e,n,i);var e,n,i},uc.prototype.oc=function(t){if(t._c.lc)throw new Zi(Ki.FAILED_PRECONDITION,ic);return new qh(jh.ku)},uc.prototype.rc=function(t){return new sh},uc.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.hc&&this.hc.stop(),[4,this.qh.Oo()];case 1:return t.sent(),[4,this.persistence.Oo()];case 2:return t.sent(),[2]}})})},uc.prototype.clearPersistence=function(t,e){throw new Zi(Ki.FAILED_PRECONDITION,ic)},uc),oc=(sc.prototype.initialize=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.co?[3,3]:(this.co=n.co,this.qh=n.qh,this.lo=this.fc(i),this.Mh=this.dc(i),this.qo=this.wc(i),this.mc=this.Tc(i),this.qh.eo=function(t){return e.qo.$h(t,1)},this.Mh.qo=this.qo,[4,this.Mh.start()]);case 1:return t.sent(),[4,this.Mh.nh(this.qo.Zh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},sc.prototype.Tc=function(t){return new hh(this.qo)},sc.prototype.fc=function(t){var e,n,i=nc(t.Gu.s),r=(e=t.Gu,new Bh(e));return n=t.credentials,new nh(n,r,i)},sc.prototype.dc=function(t){var e=this;return new rh(this.co,this.lo,t.Rs,function(t){return e.qo.$h(t,0)},new(Wh.ic()?Wh:zh))},sc.prototype.wc=function(t){return e=this.co,n=this.Mh,i=this.lo,r=this.qh,o=t.cc,s=t.Uh,u=!t._c.lc||!t._c.synchronizeTabs,a=new ah(e,n,i,r,o,s),u&&(a.Xh=!0),a;var e,n,i,r,o,s,u,a},sc.prototype.terminate=function(){return this.Mh.Oo()},sc);function sc(){}function uc(){}function ac(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var hc=(cc.prototype.next=function(t){this.observer.next&&this.Ec(this.observer.next,t)},cc.prototype.error=function(t){this.observer.error?this.Ec(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},cc.prototype.Ic=function(){this.muted=!0},cc.prototype.Ec=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},cc);function cc(t){this.observer=t,this.muted=!1}function lc(t,e){if(0!==e.length)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+_c(e.length,"argument")+".")}function fc(t,e,n){if(e.length!==n)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires "+_c(n,"argument")+", but was called with "+_c(e.length,"argument")+".")}function pc(t,e,n){if(e.length<n)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires at least "+_c(n,"argument")+", but was called with "+_c(e.length,"argument")+".")}function dc(t,e,n,i){if(e.length<n||e.length>i)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+_c(e.length,"argument")+".")}function yc(t,e,n,i){Ec(t,e,Sc(n)+" argument",i)}function vc(t,e,n,i){void 0!==i&&yc(t,e,n,i)}function gc(t,e,n,i){Ec(t,e,n+" option",i)}function mc(t,e,n,i){void 0!==i&&gc(t,e,n,i)}function wc(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(Ac(s))}var u=Ac(n);throw new Zi(Ki.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function bc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid value "+Ac(i)+" provided to function "+t+"() for its "+Sc(n)+" argument. Acceptable values: "+e.join(", "));return i}function Ec(t,e,n,i){if(!("object"===e?Ic(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=Ac(i);throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function Ic(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Ac(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ci();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Tc(t,e,n){if(void 0===n)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Sc(e)+" argument, but it was undefined.")}function Nc(n,t,i){zi(t,function(t,e){if(i.indexOf(t)<0)throw new Zi(Ki.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Rc(t,e,n,i){var r=Ac(i);return new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+Sc(n)+" argument to be a "+e+", but it was: "+r)}function kc(t,e,n){if(n<=0)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+Sc(e)+" argument to be a positive number, but it was: "+n+".")}function Sc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function _c(t,e){return t+" "+e+(1===t?"":"s")}function Oc(){if("undefined"==typeof Uint8Array)throw new Zi(Ki.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Lc(){if("undefined"==typeof atob)throw new Zi(Ki.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Dc,Pc,Vc=(Gc.fromBase64String=function(t){fc("Blob.fromBase64String",arguments,1),yc("Blob.fromBase64String","string",1,t),Lc();try{return new Gc(Er.fromBase64String(t))}catch(t){throw new Zi(Ki.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Gc.fromUint8Array=function(t){if(fc("Blob.fromUint8Array",arguments,1),Oc(),!(t instanceof Uint8Array))throw Rc("Blob.fromUint8Array","Uint8Array",1,t);return new Gc(Er.fromUint8Array(t))},Gc.prototype.toBase64=function(){return fc("Blob.toBase64",arguments,0),Lc(),this.Rc.toBase64()},Gc.prototype.toUint8Array=function(){return fc("Blob.toUint8Array",arguments,0),Oc(),this.Rc.toUint8Array()},Gc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Gc.prototype.isEqual=function(t){return this.Rc.isEqual(t.Rc)},Gc),Cc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Zi(Ki.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(yc("FieldPath","string",e,t[e]),0===t[e].length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ac=new rr(t)},Uc=(o(Fc,Pc=Cc),Fc.documentId=function(){return new Fc(rr.M().N())},Fc.prototype.isEqual=function(t){if(!(t instanceof Fc))throw Rc("isEqual","FieldPath",1,t);return this.Ac.isEqual(t.Ac)},Fc),Mc=new RegExp("[~\\*/\\[\\]]"),qc=function(){this.Pc=this},xc=(o(jc,Dc=qc),jc.prototype.yc=function(t){if(2!==t.pc)throw 1===t.pc?t.gc(this.Vc+"() can only appear at the top level of your update data"):t.gc(this.Vc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},jc.prototype.isEqual=function(t){return t instanceof jc},jc);function jc(t){var e=this;return(e=Dc.call(this)||this).Vc=t,e}function Fc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Pc.call(this,t)||this}function Gc(t){Lc(),this.Rc=t}function Bc(t,e,n){return new gl({pc:3,vc:e.settings.vc,methodName:t.Vc,bc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Wc,zc,$c,Hc,Xc,Qc,Yc=(o(yl,Qc=qc),yl.prototype.yc=function(t){return new ys(t.path,new es)},yl.prototype.isEqual=function(t){return t instanceof yl},yl),Kc=(o(dl,Xc=qc),dl.prototype.yc=function(t){var e=Bc(this,t,!0),n=this.Sc.map(function(t){return Nl(t,e)}),i=new ns(n);return new ys(t.path,i)},dl.prototype.isEqual=function(t){return this===t},dl),Zc=(o(pl,Hc=qc),pl.prototype.yc=function(t){var e=Bc(this,t,!0),n=this.Sc.map(function(t){return Nl(t,e)}),i=new us(n);return new ys(t.path,i)},pl.prototype.isEqual=function(t){return this===t},pl),Jc=(o(fl,$c=qc),fl.prototype.yc=function(t){var e=new ls(t.serializer,Uo(t.serializer,this.Cc));return new ys(t.path,e)},fl.prototype.isEqual=function(t){return this===t},fl),tl=(o(ll,zc=qc),ll.delete=function(){return lc("FieldValue.delete",arguments),new el(new xc("FieldValue.delete"))},ll.serverTimestamp=function(){return lc("FieldValue.serverTimestamp",arguments),new el(new Yc("FieldValue.serverTimestamp"))},ll.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return pc("FieldValue.arrayUnion",arguments,1),new el(new Kc("FieldValue.arrayUnion",t))},ll.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return pc("FieldValue.arrayRemove",arguments,1),new el(new Zc("FieldValue.arrayRemove",t))},ll.increment=function(t){return yc("FieldValue.increment","number",1,t),fc("FieldValue.increment",arguments,1),new el(new Jc("FieldValue.increment",t))},ll),el=(o(cl,Wc=tl),cl.prototype.yc=function(t){return this.Pc.yc(t)},cl.prototype.isEqual=function(t){return t instanceof cl&&this.Pc.isEqual(t.Pc)},cl),nl=(Object.defineProperty(hl.prototype,"latitude",{get:function(){return this.Dc},enumerable:!1,configurable:!0}),Object.defineProperty(hl.prototype,"longitude",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),hl.prototype.isEqual=function(t){return this.Dc===t.Dc&&this.Fc===t.Fc},hl.prototype.toJSON=function(){return{latitude:this.Dc,longitude:this.Fc}},hl.prototype.m=function(t){return xi(this.Dc,t.Dc)||xi(this.Fc,t.Fc)},hl),il=/^__.*__$/,rl=function(t,e,n){this.Nc=t,this.$c=e,this.kc=n},ol=(al.prototype.Oc=function(t,e){var n=[];return null!==this.qe?n.push(new Os(t,this.data,this.qe,e)):n.push(new _s(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Cs(t,this.fieldTransforms)),n},al),sl=(ul.prototype.Oc=function(t,e){var n=[new Os(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Cs(t,this.fieldTransforms)),n},ul);function ul(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function al(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function hl(t,e){if(fc("GeoPoint",arguments,2),yc("GeoPoint","number",1,t),yc("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Zi(Ki.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Zi(Ki.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Dc=t,this.Fc=e}function cl(t){var e=this;return(e=Wc.call(this)||this).Pc=t,e.Vc=t.Vc,e}function ll(){return zc.call(this)||this}function fl(t,e){var n=this;return(n=$c.call(this)||this).Vc=t,n.Cc=e,n}function pl(t,e){var n=this;return(n=Hc.call(this)||this).Vc=t,n.Sc=e,n}function dl(t,e){var n=this;return(n=Xc.call(this)||this).Vc=t,n.Sc=e,n}function yl(t){var e=this;return(e=Qc.call(this)||this).Vc=t,e}function vl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ci()}}var gl=(Object.defineProperty(bl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(bl.prototype,"pc",{get:function(){return this.settings.pc},enumerable:!1,configurable:!0}),bl.prototype.Lc=function(t){return new bl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},bl.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.qc(t),i},bl.prototype.Uc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.xc(),i},bl.prototype.Bc=function(t){return this.Lc({path:void 0,bc:!0})},bl.prototype.gc=function(t){return Ll(t,this.settings.methodName,this.settings.Wc||!1,this.path,this.settings.vc)},bl.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},bl.prototype.xc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qc(this.path.get(t))},bl.prototype.qc=function(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(vl(this.pc)&&il.test(t))throw this.gc('Document fields cannot begin and end with "__"')},bl),ml=(wl.prototype.Qc=function(t,e,n,i){return void 0===i&&(i=!1),new gl({pc:t,methodName:e,vc:n,path:rr.k(),bc:!1,Wc:i},this.s,this.serializer,this.ignoreUndefinedProperties)},wl);function wl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||nc(t)}function bl(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.xc(),this.fieldTransforms=r||[],this.qe=o||[]}function El(t,e,n,i,r,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,r);Sl("Data must be an object, but it was:",s,i);var u,a,h=Rl(i,s);if(o.merge)u=new vs(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Cc)d=p.Ac;else{if("string"!=typeof p)throw Ci();d=Ol(e,p,n)}if(!s.contains(d))throw new Zi(Ki.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Dl(c,d)||c.push(d)}u=new vs(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new ol(new Gs(h),u,a)}function Il(t,o,s,e){var u=t.Qc(1,o,s);Sl("Data must be an object, but it was:",u,e);var a=[],h=new Bs;zi(e,function(t,e){var n,i=Ol(o,t,s),r=u.Uc(i);e instanceof qc&&e.Pc instanceof xc?a.push(i):null!=(n=Nl(e,r))&&(a.push(i),h.set(i,n))});var n=new vs(a);return new sl(h.ze(),n,u.fieldTransforms)}function Al(t,e,n,i,r,o){var s=t.Qc(1,e,n),u=[_l(e,i,n)],a=[r];if(o.length%2!=0)throw new Zi(Ki.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(_l(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new Bs,v=u.length-1;0<=v;--v){Dl(d,u[v])||(c=u[v],l=a[v],f=s.Uc(c),l instanceof qc&&l.Pc instanceof xc?d.push(c):null!=(p=Nl(l,f))&&(d.push(c),y.set(c,p)))}var g=new vs(d);return new sl(y.ze(),g,s.fieldTransforms)}function Tl(t,e,n,i){return void 0===i&&(i=!1),Nl(n,t.Qc(i?4:3,e))}function Nl(s,t){if(kl(s))return Sl("Unsupported field value:",t,s),Rl(s,t);if(s instanceof qc)return function(t,e){if(!vl(e.pc))throw e.gc(t.Vc+"() can only be used with update() and set()");if(!e.path)throw e.gc(t.Vc+"() is not currently supported inside arrays");var n=t.yc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.bc&&4!==t.pc)throw t.gc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Nl(r[i],t.Bc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Uo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ji.fromDate(t);return{timestampValue:Mo(e.serializer,n)}}if(t instanceof Ji){var i=new Ji(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Mo(e.serializer,i)}}if(t instanceof nl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Vc)return{bytesValue:qo(e.serializer,t)};if(t instanceof rl){var r=e.s,o=t.Nc;if(!o.isEqual(r))throw e.gc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:jo(t.Nc||e.s,t.$c.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.gc("Unsupported field value: "+Ac(t))}(s,t)}function Rl(t,i){var r={};return $i(t)?i.path&&0<i.path.length&&i.qe.push(i.path):zi(t,function(t,e){var n=Nl(e,i.Mc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function kl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ji||t instanceof nl||t instanceof Vc||t instanceof rl||t instanceof qc)}function Sl(t,e,n){if(!kl(n)||!Ic(n)){var i=Ac(n);throw"an object"===i?e.gc(t+" a custom object"):e.gc(t+" "+i)}}function _l(t,e,n){if(e instanceof Cc)return e.Ac;if("string"==typeof e)return Ol(t,e);throw Ll("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ol(t,e,n){try{return function(e){if(0<=e.search(Mc))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Uc.bind.apply(Uc,s([void 0],e.split("."))))}catch(t){throw new Zi(Ki.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ac}catch(e){throw Ll(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Ll(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+i),s&&(a+=" in document "+r),a+=")"),new Zi(Ki.INVALID_ARGUMENT,(u+=". ")+t+a)}function Dl(t,e){return t.some(function(t){return t.isEqual(e)})}var Pl=(ql.prototype.Hc=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),0<this.mutations.length)throw new Zi(Ki.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Wo((r=u).serializer)+"/documents",n={documents:a.map(function(t){return Fo(r.serializer,t)})},[4,r.to("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Ui(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),i=xo(e.found.updateTime),r=new Gs({mapValue:{fields:e.found.fields}});return new Zs(n,i,r,{})}(e,n):"missing"in n?function(t,e){Ui(!!e.missing),Ui(!!e.readTime);var n=Go(t,e.missing),i=xo(e.readTime);return new Js(n,i)}(e,n):Ci());o.set(i.key.toString(),i)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Ui(!!e),s.push(e)}),s)]}})})}(this.lo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Js||t instanceof Zs?n.Jc(t):Ci()}),e)]}})})},ql.prototype.set=function(t,e){this.write(e.Oc(t,this.We(t))),this.zc.add(t.toString())},ql.prototype.update=function(t,e){try{this.write(e.Oc(t,this.Xc(t)))}catch(t){this.Kc=t}this.zc.add(t.toString())},ql.prototype.delete=function(t){this.write([new js(t,this.We(t))]),this.zc.add(t.toString())},ql.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),this.Kc)throw this.Kc;return e=this.jc,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=or.U(e);i.mutations.push(new Fs(n,i.We(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Wo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return $o(e.serializer,t)})},[4,e.Zr("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.lo,this.mutations)];case 1:return t.sent(),this.Gc=!0,[2]}})})},ql.prototype.Jc=function(t){var e;if(t instanceof Zs)e=t.version;else{if(!(t instanceof Js))throw Ci();e=tr.min()}var n=this.jc.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Zi(Ki.ABORTED,"Document version changed between two reads.")}else this.jc.set(t.key.toString(),e)},ql.prototype.We=function(t){var e=this.jc.get(t.toString());return!this.zc.has(t.toString())&&e?ws.updateTime(e):ws.Ge()},ql.prototype.Xc=function(t){var e=this.jc.get(t.toString());if(this.zc.has(t.toString())||!e)return ws.exists(!0);if(e.isEqual(tr.min()))throw new Zi(Ki.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ws.updateTime(e)},ql.prototype.write=function(t){this.Yc(),this.mutations=this.mutations.concat(t)},ql.prototype.Yc=function(){},ql),Vl=(Ml.prototype.run=function(){this.tl()},Ml.prototype.tl=function(){var t=this;this.ks.ws(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new Pl(this.lo),(n=this.el(e))&&n.then(function(t){i.Rs.vs(function(){return e.commit().then(function(){i.Vs.resolve(t)}).catch(function(t){i.nl(t)})})}).catch(function(t){i.nl(t)}),[2]})})})},Ml.prototype.el=function(t){try{var e=this.updateFunction(t);return!dr(e)&&e.catch&&e.then?e:(this.Vs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vs.reject(t),null}},Ml.prototype.nl=function(t){var e=this;0<this.Zc&&this.sl(t)?(--this.Zc,this.Rs.vs(function(){return e.tl(),Promise.resolve()})):this.Vs.reject(t)},Ml.prototype.sl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Sr(e)},Ml),Cl=(Ul.prototype.start=function(t,e,n,i){var r=this;this.rl(),this.Gu=t;var o=new ua,s=!1;return this.credentials.lr(function(t){return s?void r.Rs.Bs(function(){return r.Mh.eh(t)}):(s=!0,Li("FirestoreClient","Initializing. user=",t.uid),r.ol(e,n,i,t,o).then(r.il.resolve,r.il.reject))}),this.Rs.vs(function(){return r.il.promise}),o.promise},Ul.prototype.enableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!0),t.Mh.enableNetwork()})},Ul.prototype.ol=function(r,o,s,u,a){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Rs:this.Rs,Gu:this.Gu,clientId:this.clientId,credentials:this.credentials,cc:u,Uh:100,_c:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.qh=r.qh,this.co=r.co,this.hc=r.hc,this.lo=o.lo,this.Mh=o.Mh,this.qo=o.qo,this.hl=o.mc,this.persistence.pu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.ol(new rc,new oc,{lc:!1},u,a))];case 4:return[2]}})})},Ul.prototype.al=function(t){return"FirebaseError"===t.name?t.code===Ki.FAILED_PRECONDITION||t.code===Ki.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ul.prototype.rl=function(){if(this.Rs.xs)throw new Zi(Ki.FAILED_PRECONDITION,"The client has already been terminated.")},Ul.prototype.disableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!1),t.Mh.disableNetwork()})},Ul.prototype.terminate=function(){var t=this;this.Rs.Us();var i=new ua;return this.Rs.Ls(function(){return d(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.hc&&this.hc.stop(),[4,this.Mh.Oo()];case 1:return t.sent(),[4,this.qh.Oo()];case 2:return t.sent(),[4,this.persistence.Oo()];case 3:return t.sent(),this.credentials._r(),i.resolve(),[3,5];case 4:return e=t.sent(),n=va(e,"Failed to shutdown persistence"),i.reject(n),[3,5];case 5:return[2]}})})}),i.promise},Ul.prototype.waitForPendingWrites=function(){var t=this;this.rl();var e=new ua;return this.Rs.vs(function(){return t.qo.wa(e)}),e.promise},Ul.prototype.listen=function(t,e,n){var i=this;this.rl();var r=new hc(n),o=new ch(t,r,e);return this.Rs.vs(function(){return i.hl.listen(o)}),function(){r.Ic(),i.Rs.vs(function(){return i.hl.Lo(o)})}},Ul.prototype.ul=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,u,a){return d(this,void 0,void 0,function(){var s,e=this;return y(this,function(t){switch(t.label){case 0:return s=new ua,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Ai.On(t,e)}))];case 1:return(i=t.sent())instanceof Zs?s.resolve(i):i instanceof Js?s.resolve(null):s.reject(new Zi(Ki.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),o=va(r,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.Rs,this.co,e))]}})})},Ul.prototype.cl=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new ua,s=xl(e,n,uu(i.path),{includeMetadataChanges:!0,qa:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Zi(Ki.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Zi(Ki.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Ul.prototype.ll=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,a,h){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return u=new ua,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,La(a,h,!0)];case 1:return e=t.sent(),n=new uh(h,e.Wi),i=n.gh(e.documents),r=n.Ch(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=va(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.Rs,this.co,e))]}})})},Ul.prototype._l=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new ua,s=xl(e,n,i,{includeMetadataChanges:!0,qa:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Zi(Ki.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},Ul.prototype.write=function(t){var e=this;this.rl();var n=new ua;return this.Rs.vs(function(){return e.qo.write(t,n)}),n.promise},Ul.prototype.s=function(){return this.Gu.s},Ul.prototype.Fa=function(t){var e=this;this.rl();var n=new hc(t);return this.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Fa(n)]})})}),function(){n.Ic(),e.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Na(n)]})})})}},Object.defineProperty(Ul.prototype,"fl",{get:function(){return this.Rs.xs},enumerable:!1,configurable:!0}),Ul.prototype.transaction=function(t){var e=this;this.rl();var n=new ua;return this.Rs.vs(function(){return new Vl(e.Rs,e.lo,t,n).run(),Promise.resolve()}),n.promise},Ul);function Ul(t,e){this.credentials=t,this.Rs=e,this.clientId=Mi.t(),this.il=new ua}function Ml(t,e,n,i){this.Rs=t,this.lo=e,this.updateFunction=n,this.Vs=i,this.Zc=5,this.ks=new aa(this.Rs,"transaction_retry")}function ql(t){this.lo=t,this.jc=new Map,this.mutations=[],this.Gc=!1,this.Kc=null,this.zc=new Set}function xl(t,e,n,i,r){var o=new hc(r),s=new ch(n,o,i);return t.vs(function(){return e.listen(s)}),function(){o.Ic(),t.vs(function(){return e.Lo(s)})}}var jl,Fl,Gl=(uf.prototype.ml=function(t){switch(vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ao(t.integerValue||t.doubleValue);case 3:return this.Tl(t.timestampValue);case 4:return this.El(t);case 5:return t.stringValue;case 6:return new Vc(To(t.bytesValue));case 7:return this.Il(t.referenceValue);case 8:return this.Rl(t.geoPointValue);case 9:return this.Al(t.arrayValue);case 10:return this.Pl(t.mapValue);default:throw Ci()}},uf.prototype.Pl=function(t){var n=this,i={};return zi(t.fields||{},function(t,e){i[t]=n.ml(e)}),i},uf.prototype.Rl=function(t){return new nl(Ao(t.latitude),Ao(t.longitude))},uf.prototype.Al=function(t){var e=this;return(t.values||[]).map(function(t){return e.ml(t)})},uf.prototype.El=function(t){switch(this.dl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return fo(n)?t(n):n}(t);return null==e?null:this.ml(e);case"estimate":return this.Tl(po(t));default:return null}},uf.prototype.Tl=function(t){var e=Io(t),n=new Ji(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},uf.prototype.Il=function(t){var e=nr.$(t);Ui(Yo(e));var n=new Gi(e.get(1),e.get(3)),i=new or(e.p(5));return n.isEqual(this.s)||Di("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.wl(i)},uf),Bl=ga.ni,Wl=(sf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},sf),zl=(Object.defineProperty(of.prototype,"Nl",{get:function(){return this.$l||(this.$l=new ml(this.Nc,this.Fl.ignoreUndefinedProperties)),this.$l},enumerable:!1,configurable:!0}),of.prototype.settings=function(t){fc("Firestore.settings",arguments,1),yc("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Fl),t)).merge;var e=new Wl(t);if(this.bl&&!this.Fl.isEqual(e))throw new Zi(Ki.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Fl=e).credentials&&(this.Dl=function(t){if(!t)return new Qa;switch(t.type){case"gapi":var e=t.kl;return Ui(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Za(e,t.Ir||"0");case"provider":return t.kl;default:throw new Zi(Ki.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},of.prototype.enableNetwork=function(){return this.vl(),this.bl.enableNetwork()},of.prototype.disableNetwork=function(){return this.vl(),this.bl.disableNetwork()},of.prototype.enablePersistence=function(t){var e,n;if(this.bl)throw new Zi(Ki.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Di("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Zi(Ki.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ol(this.Vl,this.yl,{lc:!0,cacheSizeBytes:this.Fl.cacheSizeBytes,synchronizeTabs:i,xl:r})},of.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.bl&&!this.bl.fl)throw new Zi(Ki.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ua,[2,(this.gl.Ls(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Vl.clearPersistence(this.Nc,this.Cl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},of.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(of.prototype,"Ll",{get:function(){return this.vl(),this.bl.fl},enumerable:!1,configurable:!0}),of.prototype.waitForPendingWrites=function(){return this.vl(),this.bl.waitForPendingWrites()},of.prototype.onSnapshotsInSync=function(t){if(this.vl(),ac(t))return this.bl.Fa(t);yc("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.bl.Fa(e)},of.prototype.vl=function(){return this.bl||this.Ol(new rc,new oc,{lc:!1}),this.bl},of.prototype.Ml=function(){return new Fi(this.Nc,this.Cl,this.Fl.host,this.Fl.ssl,this.Fl.experimentalForceLongPolling)},of.prototype.Ol=function(t,e,n){var i=this.Ml();return this.bl=new Cl(this.Dl,this.gl),this.bl.start(i,t,e,n)},of.Sl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Zi(Ki.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Zi(Ki.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Gi(n)},Object.defineProperty(of.prototype,"app",{get:function(){if(!this.pl)throw new Zi(Ki.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pl},enumerable:!1,configurable:!0}),of.prototype.collection=function(t){return fc("Firestore.collection",arguments,1),yc("Firestore.collection","non-empty string",1,t),this.vl(),new yf(nr.$(t),this,null)},of.prototype.doc=function(t){return fc("Firestore.doc",arguments,1),yc("Firestore.doc","non-empty string",1,t),this.vl(),Xl.ql(nr.$(t),this,null)},of.prototype.collectionGroup=function(t){if(fc("Firestore.collectionGroup",arguments,1),yc("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.vl(),new pf((e=t,new ou(nr.k(),e)),this,null);var e},of.prototype.runTransaction=function(e){var n=this;return fc("Firestore.runTransaction",arguments,1),yc("Firestore.runTransaction","function",1,e),this.vl().transaction(function(t){return e(new $l(n,t))})},of.prototype.batch=function(){return this.vl(),new Hl(this)},Object.defineProperty(of,"logLevel",{get:function(){switch(Oi()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),of.setLogLevel=function(t){fc("Firestore.setLogLevel",arguments,1),bc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_i.setLogLevel(t)},of.prototype.Ul=function(){return this.Fl.timestampsInSnapshots},of.prototype.Bl=function(){return this.Fl},of),$l=(rf.prototype.get=function(t){var n=this;fc("Transaction.get",arguments,1);var i=If("Transaction.get",t,this.Wl);return this.Ql.Hc([i.$c]).then(function(t){if(!t||1!==t.length)return Ci();var e=t[0];if(e instanceof Js)return new Yl(n.Wl,i.$c,null,!1,!1,i.kc);if(e instanceof Zs)return new Yl(n.Wl,i.$c,e,!1,!1,i.kc);throw Ci()})},rf.prototype.set=function(t,e,n){dc("Transaction.set",arguments,2,3);var i=If("Transaction.set",t,this.Wl);n=wf("Transaction.set",n);var r=Af(i.kc,e,n),o=El(this.Wl.Nl,"Transaction.set",i.$c,r,null!==i.kc,n);return this.Ql.set(i.$c,o),this},rf.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Uc?(pc("Transaction.update",arguments,3),i=If("Transaction.update",t,this.Wl),Al(this.Wl.Nl,"Transaction.update",i.$c,e,n,o)):(fc("Transaction.update",arguments,2),i=If("Transaction.update",t,this.Wl),Il(this.Wl.Nl,"Transaction.update",i.$c,e)),this.Ql.update(i.$c,r),this},rf.prototype.delete=function(t){fc("Transaction.delete",arguments,1);var e=If("Transaction.delete",t,this.Wl);return this.Ql.delete(e.$c),this},rf),Hl=(nf.prototype.set=function(t,e,n){dc("WriteBatch.set",arguments,2,3),this.Kl();var i=If("WriteBatch.set",t,this.Wl);n=wf("WriteBatch.set",n);var r=Af(i.kc,e,n),o=El(this.Wl.Nl,"WriteBatch.set",i.$c,r,null!==i.kc,n);return this.jl=this.jl.concat(o.Oc(i.$c,ws.Ge())),this},nf.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Kl(),r="string"==typeof e||e instanceof Uc?(pc("WriteBatch.update",arguments,3),i=If("WriteBatch.update",t,this.Wl),Al(this.Wl.Nl,"WriteBatch.update",i.$c,e,n,o)):(fc("WriteBatch.update",arguments,2),i=If("WriteBatch.update",t,this.Wl),Il(this.Wl.Nl,"WriteBatch.update",i.$c,e)),this.jl=this.jl.concat(r.Oc(i.$c,ws.exists(!0))),this},nf.prototype.delete=function(t){fc("WriteBatch.delete",arguments,1),this.Kl();var e=If("WriteBatch.delete",t,this.Wl);return this.jl=this.jl.concat(new js(e.$c,ws.Ge())),this},nf.prototype.commit=function(){return this.Kl(),this.Gl=!0,0<this.jl.length?this.Wl.vl().write(this.jl):Promise.resolve()},nf.prototype.Kl=function(){if(this.Gl)throw new Zi(Ki.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},nf),Xl=(o(ef,Fl=rl),ef.ql=function(t,e,n){if(t.length%2!=0)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new ef(new or(t),e,n)},Object.defineProperty(ef.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"parent",{get:function(){return new yf(this.$c.path.g(),this.firestore,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"path",{get:function(){return this.$c.path.N()},enumerable:!1,configurable:!0}),ef.prototype.collection=function(t){if(fc("DocumentReference.collection",arguments,1),yc("DocumentReference.collection","non-empty string",1,t),!t)throw new Zi(Ki.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=nr.$(t);return new yf(this.$c.path.child(e),this.firestore,null)},ef.prototype.isEqual=function(t){if(!(t instanceof ef))throw Rc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.$c.isEqual(t.$c)&&this.kc===t.kc},ef.prototype.set=function(t,e){dc("DocumentReference.set",arguments,1,2),e=wf("DocumentReference.set",e);var n=Af(this.kc,t,e),i=El(this.firestore.Nl,"DocumentReference.set",this.$c,n,null!==this.kc,e);return this.bl.write(i.Oc(this.$c,ws.Ge()))},ef.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Uc?(pc("DocumentReference.update",arguments,2),Al(this.firestore.Nl,"DocumentReference.update",this.$c,t,e,i)):(fc("DocumentReference.update",arguments,1),Il(this.firestore.Nl,"DocumentReference.update",this.$c,t)),this.bl.write(n.Oc(this.$c,ws.exists(!0)))},ef.prototype.delete=function(){return fc("DocumentReference.delete",arguments,0),this.bl.write([new js(this.$c,ws.Ge())])},ef.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];dc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof r[u]||ac(r[u])||(Nc("DocumentReference.onSnapshot",s=r[u],["includeMetadataChanges"]),mc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};ac(r[u])?(a=r[u],r[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),r[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),r[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(yc("DocumentReference.onSnapshot","function",u,r[u]),vc("DocumentReference.onSnapshot","function",u+1,r[u+1]),vc("DocumentReference.onSnapshot","function",u+2,r[u+2]));var c={next:function(t){r[u]&&r[u](i.zl(t))},error:r[u+1],complete:r[u+2]};return this.bl.listen(uu(this.$c.path),h,c)},ef.prototype.get=function(t){var e=this;dc("DocumentReference.get",arguments,0,1),Ef("DocumentReference.get",t);var n=this.firestore.vl();return t&&"cache"===t.source?n.ul(this.$c).then(function(t){return new Yl(e.firestore,e.$c,t,!0,t instanceof Zs&&t.Ke,e.kc)}):n.cl(this.$c,t).then(function(t){return e.zl(t)})},ef.prototype.withConverter=function(t){return new ef(this.$c,this.firestore,t)},ef.prototype.zl=function(t){var e=t.docs.get(this.$c);return new Yl(this.firestore,this.$c,e,t.fromCache,t.hasPendingWrites,this.kc)},ef),Ql=(tf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},tf),Yl=(Jl.prototype.data=function(t){var e=this;if(dc("DocumentSnapshot.data",arguments,0,1),t=bf("DocumentSnapshot.data",t),this.Hl){if(this.kc){var n=new Kl(this.Wl,this.$c,this.Hl,this.Yl,this.Jl,null);return this.kc.fromFirestore(n,t)}return new Gl(this.Wl.Nc,this.Wl.Ul(),t.serverTimestamps||"none",function(t){return new Xl(t,e.Wl,null)}).ml(this.Hl.tn())}},Jl.prototype.get=function(t,e){var n=this;if(dc("DocumentSnapshot.get",arguments,1,2),e=bf("DocumentSnapshot.get",e),this.Hl){var i=this.Hl.data().field(_l("DocumentSnapshot.get",t,this.$c));if(null!==i)return new Gl(this.Wl.Nc,this.Wl.Ul(),e.serverTimestamps||"none",function(t){return new Xl(t,n.Wl,n.kc)}).ml(i)}},Object.defineProperty(Jl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"ref",{get:function(){return new Xl(this.$c,this.Wl,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"exists",{get:function(){return null!==this.Hl},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"metadata",{get:function(){return new Ql(this.Jl,this.Yl)},enumerable:!1,configurable:!0}),Jl.prototype.isEqual=function(t){if(!(t instanceof Jl))throw Rc("isEqual","DocumentSnapshot",1,t);return this.Wl===t.Wl&&this.Yl===t.Yl&&this.$c.isEqual(t.$c)&&(null===this.Hl?null===t.Hl:this.Hl.isEqual(t.Hl))&&this.kc===t.kc},Jl),Kl=(o(Zl,jl=Yl),Zl.prototype.data=function(t){return jl.prototype.data.call(this,t)},Zl);function Zl(){return null!==jl&&jl.apply(this,arguments)||this}function Jl(t,e,n,i,r,o){this.Wl=t,this.$c=e,this.Hl=n,this.Yl=i,this.Jl=r,this.kc=o}function tf(t,e){this.hasPendingWrites=t,this.fromCache=e}function ef(t,e,n){var i=this;return(i=Fl.call(this,e.Nc,t,n)||this).$c=t,i.firestore=e,i.kc=n,i.bl=i.firestore.vl(),i}function nf(t){this.Wl=t,this.jl=[],this.Gl=!1}function rf(t,e){this.Wl=t,this.Ql=e}function of(t,e,n,i){var r=this;if(void 0===n&&(n=new rc),void 0===i&&(i=new oc),this.Vl=n,this.yl=i,this.pl=null,this.gl=new pa,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.vl(),[4,this.bl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.pl=o,this.Nc=of.Sl(o),this.Cl=o.name,this.Dl=new Ya(e)}else{var s=t;if(!s.projectId)throw new Zi(Ki.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new Gi(s.projectId,s.database),this.Cl="[DEFAULT]",this.Dl=new Qa}this.Fl=new Wl({})}function sf(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Zi(Ki.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else gc("settings","non-empty string","host",t.host),this.host=t.host,mc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Nc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),mc("settings","object","credentials",t.credentials),this.credentials=t.credentials,mc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),mc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Di("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Di("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,mc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ga.ii;else{if(t.cacheSizeBytes!==Bl&&t.cacheSizeBytes<ga.si)throw new Zi(Ki.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ga.si);this.cacheSizeBytes=t.cacheSizeBytes}mc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function uf(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.dl=n,this.wl=i}function af(t,e,n){if("string"==typeof n){if(""===n)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!au(e)&&-1!==n.indexOf("/"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(nr.$(n));if(!or.j(i))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return No(t,new or(i))}if(n instanceof rl)return No(t,n.$c);throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ac(n)+".")}function hf(t,e){if(!Array.isArray(t)||0===t.length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function cf(t,e,n){if(!n.isEqual(e))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function lf(t){if(t.un()&&0===t.en.length)throw new Zi(Ki.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ff,pf=(mf.prototype.where=function(t,e,n){var i;fc("Query.where",arguments,3),Tc("Query.where",3,n),i="not-in"===e||"!="===e?e:bc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r,o,s=_l("Query.where",t),u=function(t,e,n,i,r,o,s){var u;if(r.L()){if("array-contains"===o||"array-contains-any"===o)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){hf(s,o);for(var a=[],h=0,c=s;h<c.length;h++){var l=c[h];a.push(af(i,t,l))}u={arrayValue:{values:a}}}else u=af(i,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||hf(s,o),u=Tl(n,e,s,"in"===o||"not-in"===o);var f=bu.create(r,o,u);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=t.cn();null!==i&&cf(0,e.field,i)}var r=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===e.op?new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,f),f}(this.Xl,"Query.where",this.firestore.Nl,this.firestore.Nc,s,i,n);return new mf((r=this.Xl,o=r.filters.concat([u]),new ou(r.path,r.collectionGroup,r.en.slice(),o,r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.kc)},mf.prototype.orderBy=function(t,e){var n;if(dc("Query.orderBy",arguments,1,2),vc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Zi(Ki.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=_l("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o,s=new Xu(e,n);return r=s,null!==(i=t).cn()||null!==(o=i.ln())&&cf(0,o,r.field),s}(this.Xl,o,n);return new mf((i=this.Xl,r=i.en.concat([s]),new ou(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.kc)},mf.prototype.limit=function(t){return fc("Query.limit",arguments,1),yc("Query.limit","number",1,t),kc("Query.limit",1,t),new mf(lu(this.Xl,t,"F"),this.firestore,this.kc)},mf.prototype.limitToLast=function(t){return fc("Query.limitToLast",arguments,1),yc("Query.limitToLast","number",1,t),kc("Query.limitToLast",1,t),new mf(lu(this.Xl,t,"L"),this.firestore,this.kc)},mf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];pc("Query.startAt",arguments,1);var i=this.Zl("Query.startAt",t,e,!0);return new mf(fu(this.Xl,i),this.firestore,this.kc)},mf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];pc("Query.startAfter",arguments,1);var i=this.Zl("Query.startAfter",t,e,!1);return new mf(fu(this.Xl,i),this.firestore,this.kc)},mf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];pc("Query.endBefore",arguments,1);var i=this.Zl("Query.endBefore",t,e,!0);return new mf(pu(this.Xl,i),this.firestore,this.kc)},mf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];pc("Query.endAt",arguments,1);var i=this.Zl("Query.endAt",t,e,!1);return new mf(pu(this.Xl,i),this.firestore,this.kc)},mf.prototype.isEqual=function(t){if(!(t instanceof mf))throw Rc("isEqual","Query",1,t);return this.firestore===t.firestore&&du(this.Xl,t.Xl)&&this.kc===t.kc},mf.prototype.withConverter=function(t){return new mf(this.Xl,this.firestore,t)},mf.prototype.Zl=function(c,t,e,n){if(Tc(c,1,t),t instanceof Yl)return fc(c,s([t],e),1),function(t,e,n,i){if(!n)throw new Zi(Ki.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=hu(t);o<s.length;o++){var u=s[o];if(u.field.L())r.push(No(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Zi(Ki.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(a)}}return new ju(r,i)}(this.Xl,this.firestore.Nc,t.Hl,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.en;if(r.length>s.length)throw new Zi(Ki.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<r.length;a++){var h=r[a];if(s[a].field.L()){if("string"!=typeof h)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!au(t)&&-1!==h.indexOf("/"))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(nr.$(h));if(!or.j(c))throw new Zi(Ki.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new or(c);u.push(No(e,l))}else{var f=Tl(n,i,h);u.push(f)}}return new ju(u,o)}(this.Xl,this.firestore.Nc,this.firestore.Nl,c,i,n)},mf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];dc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof r[a]||ac(r[a])||(Nc("Query.onSnapshot",u=r[a],["includeMetadataChanges"]),mc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),ac(r[a])?(s=r[a],r[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(yc("Query.onSnapshot","function",a,r[a]),vc("Query.onSnapshot","function",a+1,r[a+1]),vc("Query.onSnapshot","function",a+2,r[a+2]));var h={next:function(t){r[a]&&r[a](new df(i.firestore,i.Xl,t,i.kc))},error:r[a+1],complete:r[a+2]};return lf(this.Xl),this.firestore.vl().listen(this.Xl,u,h)},mf.prototype.get=function(t){var e=this;dc("Query.get",arguments,0,1),Ef("Query.get",t),lf(this.Xl);var n=this.firestore.vl();return(t&&"cache"===t.source?n.ll(this.Xl):n._l(this.Xl,t)).then(function(t){return new df(e.firestore,e.Xl,t,e.kc)})},mf),df=(Object.defineProperty(gf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"empty",{get:function(){return this.e_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(gf.prototype,"size",{get:function(){return this.e_.docs.size},enumerable:!1,configurable:!0}),gf.prototype.forEach=function(e,n){var i=this;dc("QuerySnapshot.forEach",arguments,1,2),yc("QuerySnapshot.forEach","function",1,e),this.e_.docs.forEach(function(t){e.call(n,i.i_(t,i.metadata.fromCache,i.e_.qt.has(t.key)))})},Object.defineProperty(gf.prototype,"query",{get:function(){return new pf(this.t_,this.Wl,this.kc)},enumerable:!1,configurable:!0}),gf.prototype.docChanges=function(t){t&&(Nc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),mc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.e_.Bt)throw new Zi(Ki.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.n_&&this.s_===e||(this.n_=function(r,e,o){if(r.Mt._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Mt;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ci()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.e_,e,this.i_.bind(this)),this.s_=e),this.n_},gf.prototype.isEqual=function(t){if(!(t instanceof gf))throw Rc("isEqual","QuerySnapshot",1,t);return this.Wl===t.Wl&&du(this.t_,t.t_)&&this.e_.isEqual(t.e_)&&this.kc===t.kc},gf.prototype.i_=function(t,e,n){return new Kl(this.Wl,t.key,t,e,n,this.kc)},gf),yf=(o(vf,ff=pf),Object.defineProperty(vf.prototype,"id",{get:function(){return this.Xl.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(vf.prototype,"parent",{get:function(){var t=this.Xl.path.g();return t._()?null:new Xl(new or(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(vf.prototype,"path",{get:function(){return this.Xl.path.N()},enumerable:!1,configurable:!0}),vf.prototype.doc=function(t){dc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Mi.t()),yc("CollectionReference.doc","non-empty string",1,t);var e=nr.$(t);return Xl.ql(this.Xl.path.child(e),this.firestore,this.kc)},vf.prototype.add=function(t){fc("CollectionReference.add",arguments,1),yc("CollectionReference.add","object",1,this.kc?this.kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},vf.prototype.withConverter=function(t){return new vf(this.r_,this.firestore,t)},vf);function vf(t,e,n){var i=this;if(((i=ff.call(this,uu(t),e,n)||this).r_=t).length%2!=1)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function gf(t,e,n,i){this.Wl=t,this.t_=e,this.e_=n,this.kc=i,this.n_=null,this.s_=null,this.metadata=new Ql(n.hasPendingWrites,n.fromCache)}function mf(t,e,n){this.Xl=t,this.firestore=e,this.kc=n}function wf(t,e){if(void 0===e)return{merge:!1};if(Nc(t,e,["merge","mergeFields"]),mc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Ac(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new Zi(Ki.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+Ac(n[r]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof Uc}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Zi(Ki.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function bf(t,e){return void 0===e?{}:(Nc(t,e,["serverTimestamps"]),wc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ef(t,e){vc(t,"object",1,e),e&&(Nc(t,e,["source"]),wc(t,0,"source",e.source,["default","server","cache"]))}function If(t,e,n){if(e instanceof rl){if(e.firestore!==n)throw new Zi(Ki.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Rc(t,"DocumentReference",1,e)}function Af(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Tf,Nf={Firestore:zl,GeoPoint:nl,Timestamp:Ji,Blob:Vc,Transaction:$l,WriteBatch:Hl,DocumentReference:Xl,DocumentSnapshot:Yl,Query:pf,QueryDocumentSnapshot:Kl,QuerySnapshot:df,CollectionReference:yf,FieldPath:Uc,FieldValue:tl,setLogLevel:zl.setLogLevel,CACHE_SIZE_UNLIMITED:Bl};(Tf=i.default).INTERNAL.registerComponent(new ki("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new zl(e,n,new rc,new oc);var e,n},"PUBLIC").setServiceProps(Object.assign({},Nf))),Tf.registerVersion("@firebase/firestore","1.16.6")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
