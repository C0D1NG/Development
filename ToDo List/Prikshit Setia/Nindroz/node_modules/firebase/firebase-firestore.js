!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Wd){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,l,n,r=t(Wd),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(n=l=l||{})[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var c={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},h=l.INFO,f=((e={})[l.DEBUG]="log",e[l.VERBOSE]="log",e[l.INFO]="info",e[l.WARN]="warn",e[l.ERROR]="error",e),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},d);function d(t){this.name=t,this._logLevel=h,this._logHandler=a,this._userLogHandler=null}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,m="FirebaseError",b=(o(E,v=Error),E);function E(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=m,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(N,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new b(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var N=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k={},R=D||self;function L(){}function x(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=x(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),V=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function G(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,C)&&t[C]||(t[C]=++V))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(t){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Y(t){return/^[\s\xa0]*$/.test(t)}var X,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Z(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var $=R.navigator;if($){var tt=$.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function nt(t){var e={};for(var n in t)e[n]=t[n];return e}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ot(t){return ot[" "](t),t}ot[" "]=L;var st,ut,at=Z(X,"Opera"),ct=Z(X,"Trident")||Z(X,"MSIE"),ht=Z(X,"Edge"),ft=ht||ct,lt=Z(X,"Gecko")&&!(Z(X.toLowerCase(),"webkit")&&!Z(X,"Edge"))&&!(Z(X,"Trident")||Z(X,"MSIE"))&&!Z(X,"Edge"),pt=Z(X.toLowerCase(),"webkit")&&!Z(X,"Edge");function dt(){var t=R.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=X,lt?/rv:([^\);]+)(\)|;)/.exec(ut):ht?/Edge\/([\d\.]+)/.exec(ut):ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ct){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt={};function wt(u){return t=u,e=function(){for(var t=0,e=Q(String(st)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=mt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var bt=R.document&&ct?dt()||(parseInt(st,10)||void 0):void 0,Et=!ct||9<=Number(bt),It=ct&&!wt("9"),Tt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",L,e),R.removeEventListener("test",L,e)}catch(t){}return t}();function Nt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(Nt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{ot(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Nt.prototype.b=function(){this.defaultPrevented=!0},G(_t,Nt);var At={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var St="closure_listenable_"+(1e6*Math.random()|0),Dt=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Dt,this.Y=this.Z=!1}function Rt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Lt(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=z(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Ct={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=zt(r);return e&&e[St]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Ut(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=zt(n),t&&t[St]?t.va(e,n,P(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!Et)return null;var u,a,c=Gt(t);if(c||(t[Pt]=c=new Lt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=Et?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ft(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[St]?xt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ft(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Gt(e))?(xt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Rt(t)))}function Ft(t){return t in Ct?Ct[t]:Ct[t]="on"+t}function qt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Mt(t),n.call(r,e)}function jt(t,e){if(t.Y)return!0;if(Et)return qt(t,new _t(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return qt(t,e=new _t(e,this))}function Gt(t){return(t=t[Pt])instanceof Lt?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(e){return"function"==x(e)?e:(e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)}),e[Bt])}function Ht(){B.call(this),this.c=new Lt(this),(this.J=this).C=null}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&xt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}G(Ht,B),Ht.prototype[St]=!0,(S=Ht.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=zt(r),e&&e[St]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Gt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Mt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Nt(t,n):t instanceof Nt?t.target=t.target||n:(s=t,it(t=new Nt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Wt(o,r,!0,t)&&s;if(s=Wt(o=t.a=n,r,!0,t)&&s,s=Wt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Wt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(Ht.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=R.JSON.stringify;function Yt(){this.b=this.a=null}var Xt,Qt=(Zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Zt(function(){return new Jt},function(t){t.reset()},100));function Zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function $t(t,e){var n;Xt||(n=R.Promise.resolve(void 0),Xt=function(){n.then(ne)}),te||(Xt(),te=!0),ee.add(t,e)}Yt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Yt;function ne(){for(var t,e,n;n=e=void 0,n=null,(e=ee).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}te=!1}function re(t,e){Ht.call(this),this.b=t||1,this.a=e||R,this.f=F(this.Ya,this),this.g=j()}function ie(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function oe(t,e,n){if("function"==x(t))n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}G(re,Ht),(S=re.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ie(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},S.G=function(){re.S.G.call(this),ie(this),delete this.a};var se,ue,ae,ce=(_(ue=fe,ae=se=B),ue.prototype=null===ae?Object.create(ae):(he.prototype=ae.prototype,new he),fe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=oe(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},fe.prototype.G=function(){se.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},fe);function he(){this.constructor=ue}function fe(t,e,n){var r=se.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function le(t){B.call(this),this.b=t,this.a={}}G(le,B);var pe=[];function de(t,e,n,r){Array.isArray(n)||(n&&(pe[0]=n.toString()),n=pe);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ye(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ve(){this.a=!0}function ge(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}le.prototype.G=function(){le.S.G.call(this),ye(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var me=null;function we(){return me=me||new Ht}function be(t){Nt.call(this,"serverreachability",t)}function Ee(t){var e=we();e.dispatchEvent(new be(e))}function Ie(t){Nt.call(this,"statevent",t)}function Te(t){var e=we();e.dispatchEvent(new Ie(e))}function Ne(t){Nt.call(this,"timingevent",t)}function _e(t,e){if("function"!=x(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}G(be,Nt),G(Ie,Nt),G(Ne,Nt);var Ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Se={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function De(){}function ke(t){var e;return(e=t.a)||(e=t.a={}),e}function Re(){}De.prototype.a=null;var Le,xe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){Nt.call(this,"d")}function Pe(){Nt.call(this,"c")}function Ce(){}function Ve(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new le(this),this.P=Ue,t=ft?125:void 0,this.R=new re(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}G(Oe,Nt),G(Pe,Nt),G(Ce,De),Le=new Ce;var Ue=45e3,Me={},Fe={};function qe(t,e,n){t.H=1,t.i=an(en(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=j(),Be(t),t.l=en(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),En(n.b,"t",r),t.D=0,t.a=dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ce(F(t.Ca,t,t.a),t.O)),de(t.J,t.a,"readystatechange",t.Wa),e=t.B?nt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ee(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ge(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Fe:(o=Number(i.substring(o,s)),isNaN(o)?Me:(s+=1)+o>i.length?Fe:(i=i.substr(s,o),r.D=s+o,i)));if(a==Fe){4==e&&(t.h=4,Te(14),u=!1),ge(t.c,t.f,null,"[Incomplete Response]");break}if(a==Me){t.h=4,Te(15),ge(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ge(t.c,t.f,a,null),Ye(t,a)}4==e&&0==n.length&&(t.h=1,Te(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),sr(e),e.F=!0)):(ge(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),We(t))}function Be(t){t.U=j()+t.P,ze(t,t.P)}function ze(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(F(t.Ua,t),e)}function He(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function We(t){0==t.g.v||t.A||cr(t.g,t)}function Ke(t){He(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ie(t.R),ye(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ye(t,e){try{var n,r,i,o,s,u,a,c,h,f,l,p=t.g;if(0!=p.v&&(p.a==t||Dn(p.b,t)))if(p.I=t.N,!t.C&&Dn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ar(p),Zn(p)}or(p),Te(18)}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=_e(F(p.Ra,p),6e3));if(Sn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else fr(p,11)}else if(!t.C&&p.a!=t||ar(p),!Y(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Z(u,"spdy")||Z(u,"quic")||Z(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(kn(a,a.b),a.b=null)),!o.A||(c=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=c,un(o.B,o.A,c))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=j()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),h=t,(o=p).la=pr(o,o.C?o.ga:null,o.fa),h.C?(Rn(o.b,h),f=h,(l=o.D)&&f.setTimeout(l),f.o&&(He(f),Be(f)),o.a=h):ir(o),0<p.g.length&&tr(p)):"stop"!=y[0]&&"close"!=y[0]||fr(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?fr(p,7):Qn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0)}Ee(4)}catch(t){}}function Xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)H(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ve.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Wn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Wn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ft&&!this.a.$())){this.A||4!=e||7==n||Ee(8==n||r<=0?3:2),He(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,c=this.c,h=this.m,f=this.l,l=this.f,p=this.T,d=e,y=i,c.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+p+"]: "+h+"\n"+f+"\n"+d+" "+y}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Te(12),Ke(this),We(this);break t}ge(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ye(this,a)}this.I?(Ge(this,e,o),ft&&this.b&&3==e&&(de(this.J,this.R,"tick",this.Va),this.R.start())):(ge(this.c,this.f,o,null),Ye(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?cr(this.g,this):(this.b=!1,Be(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Te(12)):(this.h=0,Te(13)),Ke(this),We(this)}}}catch(t){}var c,h,f,l,p,d,y},S.Va=function(){var t,e;this.a&&(t=Wn(this.a),e=this.a.$(),this.D<e.length&&(He(this),Ge(this,t,e),this.b&&4!=t&&Be(this)))},S.cancel=function(){this.A=!0,Ke(this)},S.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(Ee(3),Te(17)),Ke(this),this.h=2,We(this)):ze(this,this.U-n)},(S=Qe.prototype).K=function(){Ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Ze(this),this.a.concat()},S.get=function(t,e){return Je(this.b,t)?this.b[t]:e},S.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof tn?(this.a=void 0!==e?e:t.a,nn(this,t.f),this.j=t.j,rn(this,t.c),on(this,t.h),this.g=t.g,e=t.b,(n=new gn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),sn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,nn(this,n[1]||"",!0),this.j=cn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.g=cn(n[5]||"",!0),sn(this,n[6]||"",!0),this.i=cn(n[7]||"")):(this.a=!!e,this.b=new gn(null,this.a))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?cn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.c=n?cn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function sn(t,e,n){var r,i;e instanceof gn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(mn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},r)),r.f=i):(n||(e=hn(e,yn)),t.b=new gn(e,t.a))}function un(t,e,n){t.b.set(e,n)}function an(t){return un(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function cn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,fn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function fn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",hn(n,vn)),t.join("")};var ln=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,yn=/[#\?@]/g,vn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ze(t)))}function bn(t,e){return mn(t),e=In(t,e),Je(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),K(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Tn(t,e){this.b=t,this.a=e}function Nn(t){this.g=t||_n,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){mn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){mn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){mn(this);var e=[];if("string"==typeof t)bn(this,t)&&(e=W(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},S.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var _n=10;function An(t){return t.b||t.a&&t.a.size>=t.f}function Sn(t){return t.b?1:t.a?t.a.size:0}function Dn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function kn(t,e){t.a?t.a.add(e):t.b=e}function Rn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function xn(){}function On(){this.a=new xn}function Pn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Nn.prototype.cancel=function(){var e,t;if(this.c=Ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},xn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Cn=R.JSON.parse;function Vn(t){Ht.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}G(Vn,Ht);var Un="",Mn=/^https?$/i,Fn=["POST","PUT"];function qn(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Gn(t),zn(t)}function Gn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Bn(t){if(t.b&&void 0!==k&&(!t.s[1]||4!=Wn(t)||2!=t.X()))if(t.l&&4==Wn(t))oe(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Wn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Wn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Gn(t)}}finally{zn(t)}}}function zn(t,e){if(t.a){Hn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Hn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Wn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",et(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):un(t,e,n))}function Yn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Yn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Yn("baseRetryDelayMs",5e3,t),this.Ma=Yn("retryDelaySeedMs",1e4,t),this.Ja=Yn("forwardChannelMaxRetries",2,t),this.ma=Yn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Nn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,un(n=en(t.B),"SID",t.J),un(n,"RID",e),un(n,"TYPE","terminate"),nr(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=an(en(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.i.toString(),"")),!n&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=dr(e.g,null),e.a.ba(e.i)),e.u=j(),Be(e)),lr(t)}function Zn(t){t.a&&(sr(t),t.a.cancel(),t.a=null)}function Jn(t){Zn(t),t.j&&(R.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new Tn(t.La++,e)),3==t.v&&tr(t)}function tr(t){An(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function er(t,e){var n=e?e.f:t.R++,r=en(t.B);un(r,"SID",t.J),un(r,"RID",n),un(r,"AID",t.P),nr(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),kn(t.b,n),qe(n,r,e)}function nr(t,n){t.f&&Xe({},function(t,e){un(n,e,t)})}function rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?F(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Xe(t,function(t,e){var n=t;P(t)&&(n=Kt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ir(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function or(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=_e(F(t.Aa,t),hr(t,t.o)),t.o++,1)}function sr(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function ur(t){t.a=new Ve(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=en(t.la);un(e,"RID","rpc"),un(e,"SID",t.J),un(e,"CI",t.H?"0":"1"),un(e,"AID",t.P),nr(t,e),un(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(en(e)),n.j=null,n.I=!0,je(n,t)}function ar(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function cr(t,e){var n,r=null;if(t.a==e){ar(t),sr(t),t.a=null;var i=2}else{if(!Dn(t.b,e))return;r=e.s,Rn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=we()).dispatchEvent(new Ne(i)),tr(t)):ir(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Sn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=_e(F(t.Ba,t,e),hr(t,t.u)),t.u++,1}}(t,e)||2==i&&or(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:fr(t,5);break;case 4:fr(t,10);break;case 3:fr(t,6);break;default:fr(t,2)}}function hr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function fr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=F(t.Xa,t),n||(n=new tn("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||nn(n,"https"),an(n)),i=n.toString(),o=r,u=new ve,R.Image?((s=new Image).onload=q(Pn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=q(Pn,u,s,"TestLoadImage: error",!1,o),s.onabort=q(Pn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=q(Pn,u,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Te(2),t.v=0,t.f&&t.f.ra(e),lr(t),Jn(t)}function lr(t){t.v=0,t.I=-1,t.f&&(0==Ln(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function pr(t,e,n){var r,i,o,s,u,a,c,h=(r=n)instanceof tn?en(r):new tn(r,void 0);return""!=h.c?(e&&rn(h,e+"."+h.c),on(h,h.h)):(i=R.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,c=new tn(null,void 0),o&&nn(c,o),s&&rn(c,s),u&&on(c,u),a&&(c.g=a),h=c),t.W&&et(t.W,function(t,e){un(h,e,t)}),e=t.A,n=t.na,e&&n&&un(h,e,n),un(h,"VER",t.ha),nr(t,h),h}function dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ka)).F=t.C,e}function yr(){}function vr(){if(ct&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function gr(t,e){Ht.call(this),this.a=new Xn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Y(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Y(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new br(this)}function mr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wr(){Pe.call(this),this.status=1}function br(t){this.a=t}(S=Vn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ke(this.H):ke(Le),this.a.onreadystatechange=F(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&Xe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=qn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=z(Fn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Hn(this),0<this.o&&((this.D=(i=this.a,ct&&wt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=F(this.xa,this)):this.m=oe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},S.xa=function(){void 0!==k&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),zn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),zn(this,!0)),Vn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Bn(this):this.Ta())},S.Ta=function(){Bn(this)},S.X=function(){try{return 2<Wn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Xn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),r=this.l;if(this.O&&(r?it(r=nt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),un(i=en(this.B),"RID",t),un(i,"CVER",22),this.A&&un(i,"X-HTTP-Session-Id",this.A),nr(this,i),this.i&&r&&Kn(i,this.i,r),kn(this.b,n),this.Ga&&un(i,"TYPE","init"),this.da?(un(i,"$req",e),un(i,"SID","null"),n.V=!0,qe(n,i,null)):qe(n,i,e),this.v=2}}else 3==this.v&&(t?er(this,t):0==this.g.length||An(this.b)||er(this))},S.Aa=function(){var t;this.j=null,ur(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(F(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Zn(this),ur(this))},S.Ra=function(){null!=this.m&&(this.m=null,Zn(this),or(this),Te(19))},S.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Te(2)):(this.c.info("Failed to ping google.com"),Te(1))},(S=yr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},vr.prototype.a=function(t,e){return new gr(t,e)},G(gr,Ht),(S=gr.prototype).addEventListener=function(t,e,n,r){gr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){gr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Te(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=pr(t,null,t.fa),tr(t)},S.close=function(){Qn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Kt(t),$n(this.a,e)):$n(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,gr.S.G.call(this)},G(mr,Oe),G(wr,Pe),G(br,yr),br.prototype.ta=function(){this.a.dispatchEvent("a")},br.prototype.sa=function(t){this.a.dispatchEvent(new mr(t))},br.prototype.ra=function(t){this.a.dispatchEvent(new wr)},br.prototype.qa=function(){this.a.dispatchEvent("b")},vr.prototype.createWebChannel=vr.prototype.a,gr.prototype.send=gr.prototype.Pa,gr.prototype.open=gr.prototype.Oa,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Se.COMPLETE="complete",(Re.EventType=xe).OPEN="a",xe.CLOSE="b",xe.ERROR="c",xe.MESSAGE="d",Ht.prototype.listen=Ht.prototype.va,Vn.prototype.listenOnce=Vn.prototype.wa,Vn.prototype.getLastError=Vn.prototype.Qa,Vn.prototype.getLastErrorCode=Vn.prototype.ua,Vn.prototype.getStatus=Vn.prototype.X,Vn.prototype.getResponseJson=Vn.prototype.Na,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var Er={createWebChannelTransport:function(){return new vr},ErrorCode:Ae,EventType:Se,WebChannel:Re,XhrIo:Vn},Ir=Er.createWebChannelTransport,Tr=Er.ErrorCode,Nr=Er.EventType,_r=Er.WebChannel,Ar=Er.XhrIo,Sr=(Dr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Dr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Dr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Dr);function Dr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var kr=new p("@firebase/firestore");function Rr(){return kr.logLevel}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.DEBUG&&(e=n.map(Pr),kr.debug.apply(kr,s(["Firestore (7.19.1): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.ERROR&&(e=n.map(Pr),kr.error.apply(kr,s(["Firestore (7.19.1): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.WARN&&(e=n.map(Pr),kr.warn.apply(kr,s(["Firestore (7.19.1): "+t],e)))}function Pr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Cr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.1) INTERNAL ASSERTION FAILED: "+t;throw xr(e),new Error(e)}function Vr(t){t||Cr()}var Ur=(Mr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Mr);function Mr(){}function Fr(t,e){return t<e?-1:e<t?1:0}function qr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function jr(t){return t+"\0"}function Gr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Br=(Object.defineProperty(zr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),zr.prototype.isEqual=function(t){return t instanceof zr&&t.projectId===this.projectId&&t.database===this.database},zr.prototype.o=function(t){return Fr(this.projectId,t.projectId)||Fr(this.database,t.database)},zr);function zr(t,e){this.projectId=t,this.database=e||"(default)"}function Hr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Wr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Yr,Xr,Qr,Zr=(di.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},di.prototype.has=function(t){return void 0!==this.get(t)},di.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},di.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},di.prototype.forEach=function(u){Wr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},di.prototype._=function(){return Kr(this.l)},di),Jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$r=(o(pi,Qr=Error),pi),ti=(li.now=function(){return li.fromMillis(Date.now())},li.fromDate=function(t){return li.fromMillis(t.getTime())},li.fromMillis=function(t){var e=Math.floor(t/1e3);return new li(e,1e6*(t-1e3*e))},li.prototype.toDate=function(){return new Date(this.toMillis())},li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},li.prototype.T=function(t){return this.seconds===t.seconds?Fr(this.nanoseconds,t.nanoseconds):Fr(this.seconds,t.seconds)},li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},li),ei=(fi.I=function(t){return new fi(t)},fi.min=function(){return new fi(new ti(0,0))},fi.prototype.o=function(t){return this.timestamp.T(t.timestamp)},fi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},fi.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},fi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},fi.prototype.A=function(){return this.timestamp},fi),ni=(Object.defineProperty(hi.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),hi.prototype.isEqual=function(t){return 0===hi.P(this,t)},hi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof hi?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},hi.prototype.limit=function(){return this.offset+this.length},hi.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},hi.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},hi.prototype.v=function(){return this.segments[this.offset]},hi.prototype.S=function(){return this.get(this.length-1)},hi.prototype.get=function(t){return this.segments[this.offset+t]},hi.prototype._=function(){return 0===this.length},hi.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},hi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},hi.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},hi.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},hi),ri=(o(ci,Xr=ni),ci.prototype.g=function(t,e,n){return new ci(t,e,n)},ci.prototype.F=function(){return this.N().join("/")},ci.prototype.toString=function(){return this.F()},ci.k=function(t){if(0<=t.indexOf("//"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ci(t.split("/").filter(function(t){return 0<t.length}))},ci.$=function(){return new ci([])},ci),ii=/^[_a-zA-Z][_a-zA-Z0-9]*$/,oi=(o(ai,Yr=ni),ai.prototype.g=function(t,e,n){return new ai(t,e,n)},ai.O=function(t){return ii.test(t)},ai.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ai.O(t)||(t="`"+t+"`"),t}).join(".")},ai.prototype.toString=function(){return this.F()},ai.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},ai.L=function(){return new ai(["__name__"])},ai.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new $r(Jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new $r(Jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new $r(Jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.$=function(){return new ai([])},ai),si=(ui.B=function(t){return new ui(ri.k(t))},ui.U=function(t){return new ui(ri.k(t).V(5))},ui.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ui.prototype.isEqual=function(t){return null!==t&&0===ri.P(this.path,t.path)},ui.prototype.toString=function(){return this.path.toString()},ui.P=function(t,e){return ri.P(t.path,e.path)},ui.j=function(t){return t.length%2==0},ui.K=function(t){return new ui(new ri(t.slice()))},ui);function ui(t){this.path=t}function ai(){return null!==Yr&&Yr.apply(this,arguments)||this}function ci(){return null!==Xr&&Xr.apply(this,arguments)||this}function hi(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.R=n}function fi(t){this.timestamp=t}function li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new $r(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function pi(t,e){var n=this;return(n=Qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function di(t,e){this.h=t,this.u=e,this.l={}}function yi(t){return null==t}function vi(t){return-0===t&&1/t==-1/0}function gi(t){return"number"==typeof t&&Number.isInteger(t)&&!vi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e,n=t;return null===n.G&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+To(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),yi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=ea(n.startAt)),n.endAt&&(e+="|ub:",e+=ea(n.endAt)),n.G=e),n.G}function Ei(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!wo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ra(t.startAt,e.startAt)&&ra(t.endAt,e.endAt)}function Ii(t){return si.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ti=(Ni.fromBase64String=function(t){return new Ni(atob(t))},Ni.fromUint8Array=function(t){return new Ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ni.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Ni.prototype.Y=function(){return 2*this.H.length},Ni.prototype.o=function(t){return Fr(this.H,t.H)},Ni.prototype.isEqual=function(t){return this.H===t.H},Ni);function Ni(t){this.H=t}Ti.J=new Ti("");function _i(t){this.count=t}var Ai,Si,Di=(ki.prototype.tt=function(t){return new ki(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ki.prototype.et=function(t,e){return new ki(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ki.prototype.nt=function(t){return new ki(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},ki);function ki(t,e,n,r,i,o,s){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===s&&(s=Ti.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ri(t){switch(t){case Jr.OK:return Cr(),0;case Jr.CANCELLED:case Jr.UNKNOWN:case Jr.DEADLINE_EXCEEDED:case Jr.RESOURCE_EXHAUSTED:case Jr.INTERNAL:case Jr.UNAVAILABLE:case Jr.UNAUTHENTICATED:return;case Jr.INVALID_ARGUMENT:case Jr.NOT_FOUND:case Jr.ALREADY_EXISTS:case Jr.PERMISSION_DENIED:case Jr.FAILED_PRECONDITION:case Jr.ABORTED:case Jr.OUT_OF_RANGE:case Jr.UNIMPLEMENTED:case Jr.DATA_LOSS:return 1;default:return Cr(),0}}function Li(t){if(void 0===t)return xr("GRPC error has no .code"),Jr.UNKNOWN;switch(t){case Ai.OK:return Jr.OK;case Ai.CANCELLED:return Jr.CANCELLED;case Ai.UNKNOWN:return Jr.UNKNOWN;case Ai.DEADLINE_EXCEEDED:return Jr.DEADLINE_EXCEEDED;case Ai.RESOURCE_EXHAUSTED:return Jr.RESOURCE_EXHAUSTED;case Ai.INTERNAL:return Jr.INTERNAL;case Ai.UNAVAILABLE:return Jr.UNAVAILABLE;case Ai.UNAUTHENTICATED:return Jr.UNAUTHENTICATED;case Ai.INVALID_ARGUMENT:return Jr.INVALID_ARGUMENT;case Ai.NOT_FOUND:return Jr.NOT_FOUND;case Ai.ALREADY_EXISTS:return Jr.ALREADY_EXISTS;case Ai.PERMISSION_DENIED:return Jr.PERMISSION_DENIED;case Ai.FAILED_PRECONDITION:return Jr.FAILED_PRECONDITION;case Ai.ABORTED:return Jr.ABORTED;case Ai.OUT_OF_RANGE:return Jr.OUT_OF_RANGE;case Ai.UNIMPLEMENTED:return Jr.UNIMPLEMENTED;case Ai.DATA_LOSS:return Jr.DATA_LOSS;default:return Cr()}}(Si=Ai=Ai||{})[Si.OK=0]="OK",Si[Si.CANCELLED=1]="CANCELLED",Si[Si.UNKNOWN=2]="UNKNOWN",Si[Si.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Si[Si.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Si[Si.NOT_FOUND=5]="NOT_FOUND",Si[Si.ALREADY_EXISTS=6]="ALREADY_EXISTS",Si[Si.PERMISSION_DENIED=7]="PERMISSION_DENIED",Si[Si.UNAUTHENTICATED=16]="UNAUTHENTICATED",Si[Si.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Si[Si.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Si[Si.ABORTED=10]="ABORTED",Si[Si.OUT_OF_RANGE=11]="OUT_OF_RANGE",Si[Si.UNIMPLEMENTED=12]="UNIMPLEMENTED",Si[Si.INTERNAL=13]="INTERNAL",Si[Si.UNAVAILABLE=14]="UNAVAILABLE",Si[Si.DATA_LOSS=15]="DATA_LOSS";var xi=(Ui.prototype.st=function(t,e){return new Ui(this.P,this.root.st(t,e,this.P).copy(null,null,Pi.it,null,null))},Ui.prototype.remove=function(t){return new Ui(this.P,this.root.remove(t,this.P).copy(null,null,Pi.it,null,null))},Ui.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ui.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ui.prototype._=function(){return this.root._()},Object.defineProperty(Ui.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ui.prototype.rt=function(){return this.root.rt()},Ui.prototype.ot=function(){return this.root.ot()},Ui.prototype.ht=function(t){return this.root.ht(t)},Ui.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Ui.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ui.prototype.at=function(t){return this.root.at(t)},Ui.prototype.ut=function(){return new Oi(this.root,null,this.P,!1)},Ui.prototype.ct=function(t){return new Oi(this.root,t,this.P,!1)},Ui.prototype.lt=function(){return new Oi(this.root,null,this.P,!0)},Ui.prototype._t=function(t){return new Oi(this.root,t,this.P,!0)},Ui),Oi=(Vi.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Vi.prototype.Tt=function(){return 0<this.dt.length},Vi.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Vi),Pi=(Ci.prototype.copy=function(t,e,n,r,i){return new Ci(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ci.prototype._=function(){return!1},Ci.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Ci.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Ci.prototype.min=function(){return this.left._()?this:this.left.min()},Ci.prototype.rt=function(){return this.min().key},Ci.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Ci.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},Ci.prototype.At=function(){if(this.left._())return Ci.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.At(),null)).It()},Ci.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.Pt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.gt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ci.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.At())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.It()},Ci.prototype.Rt=function(){return this.color},Ci.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},Ci.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},Ci.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},Ci.prototype.yt=function(){var t=this.copy(null,null,Ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ci.prototype.gt=function(){var t=this.copy(null,null,Ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ci.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ci.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},Ci.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw Cr();if(this.right.Rt())throw Cr();var t=this.left.vt();if(t!==this.right.vt())throw Cr();return t+(this.Rt()?0:1)},Ci);function Ci(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ci.RED,this.left=null!=r?r:Ci.EMPTY,this.right=null!=i?i:Ci.EMPTY,this.size=this.left.size+1+this.right.size}function Vi(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Ui(t,e){this.P=t,this.root=e||Pi.EMPTY}function Mi(){this.size=0}Pi.EMPTY=null,Pi.RED=!0,Pi.it=!1,Pi.EMPTY=(Object.defineProperty(Mi.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(Mi.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Mi.prototype.copy=function(t,e,n,r,i){return this},Mi.prototype.st=function(t,e,n){return new Pi(t,e)},Mi.prototype.remove=function(t,e){return this},Mi.prototype._=function(){return!0},Mi.prototype.ht=function(t){return!1},Mi.prototype.at=function(t){return!1},Mi.prototype.rt=function(){return null},Mi.prototype.ot=function(){return null},Mi.prototype.Rt=function(){return!1},Mi.prototype.bt=function(){return!0},Mi.prototype.vt=function(){return 0},new Mi);var Fi=(Bi.prototype.has=function(t){return null!==this.data.get(t)},Bi.prototype.first=function(){return this.data.rt()},Bi.prototype.last=function(){return this.data.ot()},Object.defineProperty(Bi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Bi.prototype.indexOf=function(t){return this.data.indexOf(t)},Bi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},Bi.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var r=n.wt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Bi.prototype.Dt=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},Bi.prototype.Ct=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},Bi.prototype.ut=function(){return new qi(this.data.ut())},Bi.prototype.ct=function(t){return new qi(this.data.ct(t))},Bi.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},Bi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Bi.prototype._=function(){return this.data._()},Bi.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Bi.prototype.isEqual=function(t){if(!(t instanceof Bi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(0!==this.P(r,i))return!1}return!0},Bi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Bi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Bi.prototype.copy=function(t){var e=new Bi(this.P);return e.data=t,e},Bi),qi=(Gi.prototype.wt=function(){return this.Ft.wt().key},Gi.prototype.Tt=function(){return this.Ft.Tt()},Gi),ji=new xi(si.P);function Gi(t){this.Ft=t}function Bi(t){this.P=t,this.data=new xi(this.P)}var zi=new xi(si.P);var Hi=new xi(si.P),Wi=new Fi(si.P);function Ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Wi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Yi=new Fi(Fr);function Xi(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r}function Qi(t,e){this.targetId=t,this.ne=e}function Zi(t,e,n,r){void 0===n&&(n=Ti.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Ji=(fo.xt=function(t){return new fo(t.P)},fo.prototype.has=function(t){return null!=this.kt.get(t)},fo.prototype.get=function(t){return this.kt.get(t)},fo.prototype.first=function(){return this.$t.rt()},fo.prototype.last=function(){return this.$t.ot()},fo.prototype._=function(){return this.$t._()},fo.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(fo.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),fo.prototype.forEach=function(n){this.$t.ht(function(t,e){return n(t),!1})},fo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},fo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},fo.prototype.isEqual=function(t){if(!(t instanceof fo))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.ut(),n=t.$t.ut();e.Tt();){var r=e.wt().key,i=n.wt().key;if(!r.isEqual(i))return!1}return!0},fo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},fo.prototype.copy=function(t,e){var n=new fo;return n.P=this.P,n.kt=t,n.$t=e,n},fo),$i=(ho.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);!n||0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):Cr()},ho.prototype.Mt=function(){var n=[];return this.Ot.ht(function(t,e){n.push(e)}),n},ho),to=(co.Qt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new co(t,e,Ji.xt(e),i,n,r,!0,!1)},Object.defineProperty(co.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),co.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&Nu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},co),eo=(ao.zt=function(t,e){var n=new Map;return n.set(t,no.Ht(t,e)),new ao(ei.min(),n,Yi,ji,Ki())},ao),no=(uo.Ht=function(t,e){return new uo(Ti.J,e,Ki(),Ki(),Ki())},uo),ro=(Object.defineProperty(so.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(so.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(so.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(so.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),so.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},so.prototype.le=function(){var n=Ki(),r=Ki(),i=Ki();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Cr()}}),new no(this.re,this.oe,n,r,i)},so.prototype._e=function(){this.he=!1,this.ie=po()},so.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},so.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},so.prototype.we=function(){this.se+=1},so.prototype.Te=function(){--this.se},so.prototype.Ee=function(){this.he=!0,this.oe=!0},so),io=(oo.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof uu?this.Ve(r,t.ee):t.ee instanceof au&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},oo.prototype.pe=function(n){var r=this;this.be(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.Se(t)&&e.ce(n.resumeToken);break;case 1:e.Te(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.Te(),e.ae||r.removeTarget(t);break;case 3:r.Se(t)&&(e.Ee(),e.ce(n.resumeToken));break;case 4:r.Se(t)&&(r.De(t),e.ce(n.resumeToken));break;default:Cr()}})},oo.prototype.be=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.me.forEach(function(t,e){r.Se(e)&&n(e)})},oo.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ne.count,o=this.Ne(r);o&&(Ii(e=o.target)?0===i?(n=new si(e.path),this.ye(r,n,new au(n,ei.min()))):Vr(1===i):this.Fe(r)!==i&&(this.De(r),this.Pe=this.Pe.add(r)))},oo.prototype.ke=function(i){var o=this,s=new Map;this.me.forEach(function(t,e){var n,r=o.Ne(e);r&&(t.Yt&&Ii(r.target)&&(n=new si(r.target.path),null!==o.Ae.get(n)||o.$e(e,n)||o.ye(e,n,new au(n,i))),t.ue&&(s.set(e,t.le()),t._e()))});var r=Ki();this.Re.forEach(function(t,e){var n=!0;e.Dt(function(t){var e=o.Ne(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new eo(i,s,this.Pe,this.Ae,r);return this.Ae=ji,this.Re=lo(),this.Pe=new Fi(Fr),t},oo.prototype.Ve=function(t,e){var n;this.Se(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t)))},oo.prototype.ye=function(t,e,n){var r;this.Se(t)&&(r=this.ve(t),this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n)))},oo.prototype.removeTarget=function(t){this.me.delete(t)},oo.prototype.Fe=function(t){var e=this.ve(t).le();return this.Ie.Oe(t).size+e.Jt.size-e.Zt.size},oo.prototype.we=function(t){this.ve(t).we()},oo.prototype.ve=function(t){var e=this.me.get(t);return e||(e=new ro,this.me.set(t,e)),e},oo.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new Fi(Fr),this.Re=this.Re.st(t,e)),e},oo.prototype.Se=function(t){var e=null!==this.Ne(t);return e||Lr("WatchChangeAggregator","Detected inactive target",t),e},oo.prototype.Ne=function(t){var e=this.me.get(t);return e&&e.ae?null:this.Ie.Me(t)},oo.prototype.De=function(e){var n=this;this.me.set(e,new ro),this.Ie.Oe(e).forEach(function(t){n.ye(e,t,null)})},oo.prototype.$e=function(t,e){return this.Ie.Oe(t).has(e)},oo);function oo(t){this.Ie=t,this.me=new Map,this.Ae=ji,this.Re=lo(),this.Pe=new Fi(Fr)}function so(){this.se=0,this.ie=po(),this.re=Ti.J,this.oe=!1,this.he=!0}function uo(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}function ao(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}function co(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}function ho(){this.Ot=new xi(si.P)}function fo(n){this.P=n?function(t,e){return n(t,e)||si.P(t.key,e.key)}:function(t,e){return si.P(t.key,e.key)},this.kt=zi,this.$t=new xi(this.P)}function lo(){return new xi(si.P)}function po(){return new xi(si.P)}function yo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function vo(t){var e=No(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(e.seconds,e.nanos)}var go=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yo(t)?4:10:Cr()}function wo(r,i){var t,e,n,o=mo(r);if(o!==mo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return vo(r).isEqual(vo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=No(r.timestampValue),n=No(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Ao(r.bytesValue).isEqual(Ao(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,_o((t=r).geoPointValue.latitude)===_o(e.geoPointValue.latitude)&&_o(t.geoPointValue.longitude)===_o(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return _o(t.integerValue)===_o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=_o(t.doubleValue),r=_o(e.doubleValue);return n===r?vi(n)===vi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return qr(r.arrayValue.values||[],i.arrayValue.values||[],wo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Hr(t)!==Hr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!wo(t[n],e[n])))return!1;return!0}();default:return Cr()}}function bo(t,e){return void 0!==(t.values||[]).find(function(t){return wo(t,e)})}function Eo(t,e){var n,r,i,o,s,u,a,c,h,f,l=mo(t),p=mo(e);if(l!==p)return Fr(l,p);switch(l){case 0:return 0;case 1:return Fr(t.booleanValue,e.booleanValue);case 2:return c=e,h=_o(t.integerValue||t.doubleValue),f=_o(c.integerValue||c.doubleValue),h<f?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return Io(t.timestampValue,e.timestampValue);case 4:return Io(vo(t),vo(e));case 5:return Fr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Ao(o),a=Ao(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Fr(n[i],r[i]);if(0!==o)return o}return Fr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Fr(_o(n.latitude),_o(r.latitude)))?i:Fr(_o(n.longitude),_o(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Eo(n[i],r[i]);if(o)return o}return Fr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Fr(r[s],o[s]);if(0!==u)return u;var a=Eo(n[r[s]],i[o[s]]);if(0!==a)return a}return Fr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function Io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Fr(t,e);var n=No(t),r=No(e),i=Fr(n.seconds,r.seconds);return 0!==i?i:Fr(n.nanos,r.nanos)}function To(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=No(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ao(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,si.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Cr();var t,e,n}(t)}function No(t){if(Vr(!!t),"string"!=typeof t)return{seconds:_o(t.seconds),nanos:_o(t.nanos)};var e,n=0,r=go.exec(t);Vr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function _o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ao(t){return"string"==typeof t?Ti.fromBase64String(t):Ti.fromUint8Array(t)}function So(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function Do(t){return t&&"integerValue"in t}function ko(t){return!!t&&"arrayValue"in t}function Ro(t){return t&&"nullValue"in t}function Lo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xo(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},Po={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Co=function(t,e){this.s=t,this.Le=e};function Vo(t){return{integerValue:""+t}}function Uo(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Mo(t,e){return gi(e)?Vo(e):Uo(t,e)}function Fo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function qo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function jo(t){return Vr(!!t),ei.I((e=No(t),new ti(e.seconds,e.nanos)));var e}function Go(t,e){return new ri(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function Bo(t){var e=ri.k(t);return Vr(os(e)),e}function zo(t,e){return Go(t.s,e.path)}function Ho(t,e){var n=Bo(e);return Vr(n.get(1)===t.s.projectId),Vr(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new si(Xo(n))}function Wo(t,e){return Go(t.s,e)}function Ko(t){var e=Bo(t);return 4===e.length?ri.$():Xo(e)}function Yo(t){return new ri(["projects",t.s.projectId,"databases",t.s.database]).F()}function Xo(t){return Vr(4<t.length&&"documents"===t.get(4)),t.V(5)}function Qo(t,e,n){return{name:zo(t,e),fields:n.proto.mapValue.fields}}function Zo(t,e){var n,r,i,o,s,u;if(e instanceof Ms)n={update:Qo(t,e.key,e.value)};else if(e instanceof Xs)n={delete:zo(t,e.key)};else if(e instanceof Fs)n={update:Qo(t,e.key,e.data),updateMask:(r=e.qe,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof zs)n={transform:{document:zo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof hs)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof fs)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof vs)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof bs)return{fieldPath:t.field.F(),increment:e.Be};throw Cr()})}};else{if(!(e instanceof Qs))return Cr();n={verify:zo(t,e.key)}}return e.Qe.Ue||(n.currentDocument=void 0!==(o=e.Qe).updateTime?{updateTime:(s=t,u=o.updateTime,Fo(s,u.A()))}:void 0!==o.exists?{exists:o.exists}:Cr()),n}function Jo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Ds.updateTime(jo(n.updateTime)):void 0!==n.exists?Ds.exists(n.exists):Ds.We():Ds.We();if(t.update){t.update.name;var o=Ho(e,t.update.name),s=new Zs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Ns(r.map(function(t){return oi.q(t)})));return new Fs(o,s,u,i)}return new Ms(o,s,i)}if(t.delete){var a=Ho(e,t.delete);return new Xs(a,i)}if(t.transform){var c=Ho(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Vr("REQUEST_TIME"===e.setToServerValue),i=new hs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new fs(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new vs(r)):"increment"in e?i=new bs(t,e.increment):Cr();var o=oi.q(e.fieldPath);return new _s(o,i)}(e,t)});return Vr(!0===i.exists),new zs(c,h)}if(t.verify){var f=Ho(e,t.verify);return new Qs(f,i)}return Cr()}function $o(t,e){return{documents:[Wo(t,e.path)]}}function ts(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Wo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Wo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Lo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NAN"}};if(Ro(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Lo(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NAN"}};if(Ro(t.value))return{unaryFilter:{field:rs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rs(t.field),op:(e=t.op,Po[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:rs((e=t).field),direction:(n=e.dir,Oo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||yi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=es(e.endAt)),n}function es(t){return{before:t.before,values:t.position}}function ns(t){var e=!!t.before,n=t.values||[];return new Qu(n,e)}function rs(t){return{fieldPath:t.F()}}function is(t){return oi.q(t.fieldPath)}function os(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ss(){this.je=void 0}function us(t,e){return t instanceof bs?Do(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var as,cs,hs=(o(ps,cs=ss),ps),fs=(o(ls,as=ss),ls);function ls(t){var e=this;return(e=as.call(this)||this).elements=t,e}function ps(){return null!==cs&&cs.apply(this,arguments)||this}function ds(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return wo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ys,vs=(o(gs,ys=ss),gs);function gs(t){var e=this;return(e=ys.call(this)||this).elements=t,e}function ms(t,e){for(var n=Ts(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!wo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ws,bs=(o(Es,ws=ss),Es);function Es(t,e){var n=this;return(n=ws.call(this)||this).serializer=t,n.Be=e,n}function Is(t){return _o(t.integerValue||t.doubleValue)}function Ts(t){return ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ns=(As.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},As.prototype.isEqual=function(t){return qr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},As),_s=function(t,e){this.field=t,this.transform=e};function As(t){(this.fields=t).sort(oi.P)}function Ss(t,e){this.version=t,this.transformResults=e}var Ds=(ks.We=function(){return new ks},ks.exists=function(t){return new ks(void 0,t)},ks.updateTime=function(t){return new ks(t)},Object.defineProperty(ks.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ks);function ks(t,e){this.updateTime=t,this.exists=e}function Rs(t,e){return void 0!==t.updateTime?e instanceof uu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof uu}function Ls(){}function xs(t,e,n){return t instanceof Ms?new uu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Fs?function(t,e,n){if(!Rs(t.Qe,e))return new cu(t.key,n.version);var r=Gs(t,e);return new uu(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof zs?function(t,e,n){if(Vr(null!=n.transformResults),!Rs(t.Qe,e))return new cu(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Vr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof uu&&(h=e.field(a.field)),r.push((i=c,o=h,s=n[u],i instanceof fs?ds(i,o):i instanceof vs?ms(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ws(t,r.data(),i);return new uu(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new au(t.key,n.version,{hasCommittedMutations:!0})}function Os(t,e,n,r){return t instanceof Ms?function(t,e){if(!Rs(t.Qe,e))return e;var n=Cs(e);return new uu(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Fs?function(t,e){if(!Rs(t.Qe,e))return e;var n=Cs(e),r=Gs(t,e);return new uu(t.key,n,r,{Ge:!0})}(t,e):t instanceof zs?function(t,e,n,r){if(!Rs(t.Qe,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,c,h,f=[],l=0,p=t;l<p.length;l++){var d=p[l],y=d.transform,v=null;n instanceof uu&&(v=n.field(d.field)),null===v&&r instanceof uu&&(v=r.field(d.field)),f.push((o=v,s=e,h=c=a=u=void 0,(i=y)instanceof hs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof fs?ds(i,o):i instanceof vs?ms(i,o):(a=us(u=i,o),c=Is(a)+Is(u.Be),Do(a)&&Do(u.Be)?Vo(c):Uo(u.serializer,c))))}return f}(t.fieldTransforms,n,e,r),s=Ws(t,i.data(),o);return new uu(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,Rs((i=t).Qe,o)?new au(i.key,ei.min()):o);var i,o}function Ps(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||qr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof fs&&o instanceof fs||i instanceof vs&&o instanceof vs?qr(i.elements,o.elements,wo):i instanceof bs&&o instanceof bs?wo(i.Be,o.Be):i instanceof hs&&o instanceof hs);var n,r,i,o}))}function Cs(t){return t instanceof uu?t.version:ei.min()}var Vs,Us,Ms=(o(js,Us=Ls),js),Fs=(o(qs,Vs=Ls),qs);function qs(t,e,n,r){var i=this;return(i=Vs.call(this)||this).key=t,i.data=e,i.qe=n,i.Qe=r,i.type=1,i}function js(t,e,n){var r=this;return(r=Us.call(this)||this).key=t,r.value=e,r.Qe=n,r.type=0,r}function Gs(t,e){return n=t,r=e instanceof uu?e.data():Zs.empty(),i=new Js(r),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var Bs,zs=(o(Hs,Bs=Ls),Hs);function Hs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Qe=Ds.exists(!0),n}function Ws(t,e,n){for(var r=new Js(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Ks,Ys,Xs=(o(nu,Ys=Ls),nu),Qs=(o(eu,Ks=Ls),eu),Zs=(tu.empty=function(){return new tu({mapValue:{}})},tu.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},tu.prototype.isEqual=function(t){return wo(this.proto,t.proto)},tu),Js=($s.prototype.set=function(t,e){return this.Je(t,e),this},$s.prototype.delete=function(t){return this.Je(t,null),this},$s.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===mo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},$s.prototype.ze=function(){var t=this.Xe(oi.$(),this.Ye);return null!=t?new Zs(t):this.He},$s.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},$s);function $s(t){void 0===t&&(t=Zs.empty()),this.He=t,this.Ye=new Map}function tu(t){this.proto=t}function eu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Qe=e,n.type=4,n}function nu(t,e){var n=this;return(n=Ys.call(this)||this).key=t,n.Qe=e,n.type=3,n}function ru(t,e){this.key=t,this.version=e}var iu,ou,su,uu=(o(lu,su=ru),lu.prototype.field=function(t){return this.Ze.field(t)},lu.prototype.data=function(){return this.Ze},lu.prototype.tn=function(){return this.Ze.proto},lu.prototype.isEqual=function(t){return t instanceof lu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},lu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(lu.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),lu),au=(o(fu,ou=ru),fu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(fu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},fu),cu=(o(hu,iu=ru),hu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(hu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),hu.prototype.isEqual=function(t){return t instanceof hu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},hu);function hu(){return null!==iu&&iu.apply(this,arguments)||this}function fu(t,e,n){var r=this;return(r=ou.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function lu(t,e,n,r){var i=this;return(i=su.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function pu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new $r(Jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new $r(Jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var du=(yu.prototype.on=function(t){return new yu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},yu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},yu.prototype.an=function(){return!yi(this.limit)&&"F"===this.nn},yu.prototype.un=function(){return!yi(this.limit)&&"L"===this.nn},yu.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},yu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},yu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},yu);function yu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function vu(t,e,n,r,i,o,s,u){return new du(t,e,n,r,i,o,s,u)}function gu(t){return new du(t)}function mu(t){return null!==t.collectionGroup}function wu(t){var e=pu(t,du);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.cn();if(null!==n&&null===r)n.M()||e.sn.push(new ia(n)),e.sn.push(new ia(oi.L(),"asc"));else{for(var i,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.M()&&(o=!0)}o||(i=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new ia(oi.L(),i)))}}return e.sn}function bu(t){var e=pu(t,du);if(!e.rn)if("F"===e.nn)e.rn=wi(e.path,e.collectionGroup,wu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=wu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ia(o.field,s))}var u=e.endAt?new Qu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Qu(e.startAt.position,!e.startAt.before):null;e.rn=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function Eu(t,e,n){return new du(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Iu(t,e){return new du(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function Tu(t,e){return new du(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function Nu(t,e){return Ei(bu(t),bu(e))&&t.nn===e.nn}function _u(t){return bi(bu(t))+"|lt:"+t.nn}function Au(t){return"Query(target="+(e=bu(t),n=e.path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+To(e.value);var e}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ea(e.startAt)),e.endAt&&(n+=", endAt: "+ea(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function Su(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.W(r.collectionGroup)&&r.path.D(o):si.j(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.M()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||na(e.startAt,wu(e),n))&&(!e.endAt||!na(e.endAt,wu(e),n)));var e,n,r,o}function Du(u){return function(t,e){for(var n=!1,r=0,i=wu(u);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.M()?si.P(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?Eo(n,r):Cr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Cr()}}(o,t,e);if(0!==s)return s;n=n||o.field.M()}return 0}}var ku,Ru=(o(Lu,ku=function(){}),Lu.create=function(t,e,n){if(t.M())return"in"===e||"not-in"===e?this.dn(t,e,n):new Cu(t,e,n);if(Ro(n)){if("=="!==e&&"!="!==e)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Lu(t,e,n)}if(Lo(n)){if("=="!==e&&"!="!==e)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Lu(t,e,n)}return"array-contains"===e?new Wu(t,n):"in"===e?new Ku(t,n):"not-in"===e?new Yu(t,n):"array-contains-any"===e?new Xu(t,n):new Lu(t,e,n)},Lu.dn=function(t,e,n){return new("in"===e?Vu:Uu)(t,n)},Lu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(Eo(e,this.value)):null!==e&&mo(this.value)===mo(e)&&this.wn(Eo(e,this.value))},Lu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Cr()}},Lu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Lu);function Lu(t,e,n){var r=this;return(r=ku.call(this)||this).field=t,r.op=e,r.value=n,r}var xu,Ou,Pu,Cu=(o(qu,Pu=Ru),qu.prototype.matches=function(t){var e=si.P(t.key,this.key);return this.wn(e)},qu),Vu=(o(Fu,Ou=Ru),Fu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Fu),Uu=(o(Mu,xu=Ru),Mu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Mu);function Mu(t,e){var n=this;return(n=xu.call(this,t,"not-in",e)||this).keys=ju(0,e),n}function Fu(t,e){var n=this;return(n=Ou.call(this,t,"in",e)||this).keys=ju(0,e),n}function qu(t,e,n){var r=this;return(r=Pu.call(this,t,e,n)||this).key=si.U(n.referenceValue),r}function ju(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return si.U(t.referenceValue)})}var Gu,Bu,zu,Hu,Wu=(o(ta,Hu=Ru),ta.prototype.matches=function(t){var e=t.field(this.field);return ko(e)&&bo(e.arrayValue,this.value)},ta),Ku=(o($u,zu=Ru),$u.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&bo(this.value.arrayValue,e)},$u),Yu=(o(Ju,Bu=Ru),Ju.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!bo(this.value.arrayValue,e)},Ju),Xu=(o(Zu,Gu=Ru),Zu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ko(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return bo(e.value.arrayValue,t)})},Zu),Qu=function(t,e){this.position=t,this.before=e};function Zu(t,e){return Gu.call(this,t,"array-contains-any",e)||this}function Ju(t,e){return Bu.call(this,t,"not-in",e)||this}function $u(t,e){return zu.call(this,t,"in",e)||this}function ta(t,e){return Hu.call(this,t,"array-contains",e)||this}function ea(t){return(t.before?"b":"a")+":"+t.position.map(To).join(",")}function na(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.M()?si.P(si.U(s.referenceValue),n.key):Eo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ra(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!wo(t.position[n],e.position[n]))return!1;return!0}var ia=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};var oa=(Ea.prototype.En=function(t,e,n){for(var r=n.In,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=xs(o,e,r[i]))}return e},Ea.prototype.mn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Os(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Os(a,e,o,this.Tn))}return e},Ea.prototype.An=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.mn(t.key,n.get(t.key));e&&(i=i.st(t.key,e))}),i},Ea.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Ki())},Ea.prototype.isEqual=function(t){return this.batchId===t.batchId&&qr(this.mutations,t.mutations,Ps)&&qr(this.baseMutations,t.baseMutations,Ps)},Ea),sa=(ba.from=function(t,e,n){Vr(t.mutations.length===n.length);for(var r=Hi,i=t.mutations,o=0;o<i.length;o++)r=r.st(i[o].key,n[o].version);return new ba(t,e,n,r)},ba),ua=(wa.prototype.catch=function(t){return this.next(void 0,t)},wa.prototype.next=function(r,i){var o=this;return this.pn&&Cr(),this.pn=!0,this.yn?this.error?this.bn(i,this.error):this.vn(r,this.result):new wa(function(e,n){o.gn=function(t){o.vn(r,t).next(e,n)},o.Vn=function(t){o.bn(i,t).next(e,n)}})},wa.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},wa.prototype.Dn=function(t){try{var e=t();return e instanceof wa?e:wa.resolve(e)}catch(t){return wa.reject(t)}},wa.prototype.vn=function(t,e){return t?this.Dn(function(){return t(e)}):wa.resolve(e)},wa.prototype.bn=function(t,e){return t?this.Dn(function(){return t(e)}):wa.reject(e)},wa.resolve=function(n){return new wa(function(t,e){t(n)})},wa.reject=function(n){return new wa(function(t,e){e(n)})},wa.Cn=function(t){return new wa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},wa.Nn=function(t){for(var n=wa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?wa.resolve(t):e()})}(r[e]);return n},wa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Cn(i)},wa),aa=(Object.defineProperty(ma.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),ma.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},ma.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},ma.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?ua.resolve(n):this.qn(t,e)},ma.prototype.getEntries=function(t,e){return this.Bn(t,e)},ma.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},ma.prototype.On=function(){},ma),ca="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ha=(ga.prototype.Wn=function(t){this.Qn.push(t)},ga.prototype.jn=function(){this.Qn.forEach(function(t){return t()})},ga),fa=(va.prototype.Hn=function(e,n){var r=this;return this.Gn.Yn(e,n).next(function(t){return r.Jn(e,n,t)})},va.prototype.Jn=function(t,r,i){return this.Kn.Ln(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].mn(r,t);return t})},va.prototype.Xn=function(t,e,i){var o=ji;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].mn(t,e);o=o.st(t,e)}),o},va.prototype.Zn=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ts(e,t)})},va.prototype.ts=function(r,i){var o=this;return this.Gn.es(r,i).next(function(t){var e=o.Xn(r,i,t),n=ji;return e.forEach(function(t,e){e=e||new au(t,ei.min()),n=n.st(t,e)}),n})},va.prototype.ns=function(t,e,n){return r=e,si.j(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ss(t,e.path):mu(e)?this.rs(t,e,n):this.os(t,e,n);var r},va.prototype.ss=function(t,e){return this.Hn(t,new si(e)).next(function(t){var e=zi;return t instanceof uu&&(e=e.st(t.key,t)),e})},va.prototype.rs=function(n,r,i){var o=this,s=r.collectionGroup,u=zi;return this.zn.hs(n,s).next(function(t){return ua.forEach(t,function(t){var e=r.on(t.child(s));return o.os(n,e,i).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},va.prototype.os=function(e,n,t){var h,f,r=this;return this.Kn.ns(e,n,t).next(function(t){return h=t,r.Gn.as(e,n)}).next(function(t){return f=t,r.us(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=Os(s,a,a,r.Tn);h=c instanceof uu?h.st(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Su(n,e)||(h=h.remove(t))}),h})},va.prototype.us=function(t,e,n){for(var r=Ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Fs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Kn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof uu&&(c=c.st(t,e))}),c})},va),la=(ya._s=function(t,e){for(var n=Ki(),r=Ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ya(t,e.fromCache,n,r)},ya),pa=(da.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},da.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},da);function da(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}function ya(t,e,n,r){this.targetId=t,this.fromCache=e,this.cs=n,this.ls=r}function va(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}function ga(){this.Qn=[]}function ma(){this.Fn=new Zr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.kn=!1}function wa(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}function ba(t,e,n,r){this.batch=t,this.Rn=e,this.In=n,this.Pn=r}function Ea(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}pa.Es=-1;function Ia(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ta,Na=(La.prototype.reset=function(){this.gs=0},La.prototype.ps=function(){this.gs=this.Ps},La.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);0<i&&Lr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.Is.Ss(this.ms,i,function(){return e.ys=Date.now(),t()}),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},La.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},La.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},La.prototype.vs=function(){return(Math.random()-.5)*this.gs},La),_a=(Ra.delete=function(t){return Lr("SimpleDb","Removing database:",t),Ua(window.indexedDB.deleteDatabase(t)).Sn()},Ra.ks=function(){if("undefined"==typeof indexedDB)return!1;if(Ra.$s())return!0;var t=y(),e=Ra.Fs(t),n=0<e&&e<10,r=Ra.xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Ra.$s=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Os)},Ra.Ms=function(t,e){return t.store(e)},Ra.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Ra.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Ra.prototype.Ls=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Lr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Sa("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new $r(Jr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Sa(e))},i.onupgradeneeded=function(t){Lr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Ns.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Lr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return o.qs(t)}),this.db)]}})})},Ra.prototype.Bs=function(e){this.qs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Ra.prototype.runTransaction=function(r,c,h){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Ls()];case 2:return a.db=t.sent(),e=Oa.open(a.db,s?"readonly":"readwrite",c),n=h(e).catch(function(t){return e.abort(t),ua.reject(t)}).Sn(),r={},n.catch(function(){}),[4,e.Us];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Lr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Ra.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Ra),Aa=(Object.defineProperty(ka.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(ka.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),ka.prototype.done=function(){this.Ws=!0},ka.prototype.Gs=function(t){this.js=t},ka.prototype.delete=function(){return Ua(this.Qs.delete())},ka),Sa=(o(Da,Ta=$r),Da);function Da(t){var e=this;return(e=Ta.call(this,Jr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function ka(t){this.Qs=t,this.Ws=!1,this.js=null}function Ra(t,e,n){this.name=t,this.version=e,this.Ns=n,12.2===Ra.Fs(y())&&xr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function La(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Is=t,this.ms=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}function xa(t){return"IndexedDbTransactionError"===t.name}var Oa=(Va.open=function(t,e,n){try{return new Va(t.transaction(n,e))}catch(t){throw new Sa(t)}},Object.defineProperty(Va.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),Va.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(Lr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Va.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Pa(e)},Va),Pa=(Ca.prototype.put=function(t,e){var n=void 0!==e?(Lr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Lr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Ua(n)},Ca.prototype.add=function(t){return Lr("SimpleDb","ADD",this.store.name,t,t),Ua(this.store.add(t))},Ca.prototype.get=function(e){var n=this;return Ua(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Lr("SimpleDb","GET",n.store.name,e,t),t})},Ca.prototype.delete=function(t){return Lr("SimpleDb","DELETE",this.store.name,t),Ua(this.store.delete(t))},Ca.prototype.count=function(){return Lr("SimpleDb","COUNT",this.store.name),Ua(this.store.count())},Ca.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,function(t,e){r.push(e)}).next(function(){return r})},Ca.prototype.Js=function(t,e){Lr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,function(t,e,n){return n.delete()})},Ca.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},Ca.prototype.ti=function(i){var t=this.cursor({});return new ua(function(n,r){t.onerror=function(t){var e=Fa(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ca.prototype.Ys=function(t,s){var u=[];return new ua(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Aa(i),(n=s(i.primaryKey,i.value,e))instanceof ua&&(r=n.catch(function(t){return e.done(),ua.reject(t)}),u.push(r)),e.yn?o():null===e.Ks?i.continue():i.continue(e.Ks)):o()}}).next(function(){return ua.Cn(u)})},Ca.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ca.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ca);function Ca(t){this.store=t}function Va(t){var n=this;this.transaction=t,this.aborted=!1,this.zs=new Ia,this.transaction.oncomplete=function(){n.zs.resolve()},this.transaction.onabort=function(){t.error?n.zs.reject(new Sa(t.error)):n.zs.resolve()},this.transaction.onerror=function(t){var e=Fa(t.target.error);n.zs.reject(new Sa(e))}}function Ua(t){return new ua(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Fa(t.target.error);r(e)}})}var Ma=!1;function Fa(t){var e=_a.Fs(y());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new $r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ma||(Ma=!0,setTimeout(function(){throw r},0)),r}}return t}function qa(){return"undefined"!=typeof window?window:null}function ja(){return"undefined"!=typeof document?document:null}var Ga=(Ha.ri=function(t,e,n,r,i){var o=new Ha(t,e,Date.now()+n,r,i);return o.start(n),o},Ha.prototype.start=function(t){var e=this;this.oi=setTimeout(function(){return e.hi()},t)},Ha.prototype.Cs=function(){return this.hi()},Ha.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new $r(Jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ha.prototype.hi=function(){var e=this;this.ei.ai(function(){return null!==e.oi?(e.clearTimeout(),e.op().then(function(t){return e.ii.resolve(t)})):Promise.resolve()})},Ha.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},Ha),Ba=(Object.defineProperty(za.prototype,"Ii",{get:function(){return this.li},enumerable:!1,configurable:!0}),za.prototype.ai=function(t){this.enqueue(t)},za.prototype.mi=function(t){this.Ai(),this.Ri(t)},za.prototype.Pi=function(){var t;this.li||(this.li=!0,(t=ja())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei))},za.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise(function(t){}):this.Ri(t)},za.prototype.gi=function(t){var e=this;this.ci.push(t),this.ai(function(){return e.Vi()})},za.prototype.Vi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ci.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ci[0]()];case 2:return t.sent(),this.ci.shift(),this.Ti.reset(),[3,4];case 3:if(!xa(e=t.sent()))throw e;return Lr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ci.length&&this.Ti.bs(function(){return n.Vi()}),t.label=5;case 5:return[2]}})})},za.prototype.Ri=function(t){var r=this,e=this.ui.then(function(){return r.di=!0,t().catch(function(t){throw r.fi=t,r.di=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.di=!1,t})});return this.ui=e},za.prototype.Ss=function(t,e,n){var r=this;this.Ai(),-1<this.wi.indexOf(t)&&(e=0);var i=Ga.ri(this,t,e,n,function(t){return r.yi(t)});return this._i.push(i),i},za.prototype.Ai=function(){this.fi&&Cr()},za.prototype.pi=function(){},za.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ui];case 1:t.sent(),t.label=2;case 2:if(e!==this.ui)return[3,0];t.label=3;case 3:return[2]}})})},za.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].ms===t)return!0;return!1},za.prototype.Si=function(r){var i=this;return this.bi().then(function(){i._i.sort(function(t,e){return t.ni-e.ni});for(var t=0,e=i._i;t<e.length;t++){var n=e[t];if(n.Cs(),"all"!==r&&n.ms===r)break}return i.bi()})},za.prototype.Di=function(t){this.wi.push(t)},za.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},za);function za(){var e=this;this.ui=Promise.resolve(),this.ci=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new Na(this,"async_queue_retry"),this.Ei=function(){var t=ja();t&&Lr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ti.Ds()};var t=ja();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ei)}function Ha(t,e,n,r,i){this.ei=t,this.ms=e,this.ni=n,this.op=r,this.si=i,this.ii=new Ia,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch(function(t){})}function Wa(t,e){if(xr("AsyncQueue",e+": "+t),xa(t))return new $r(Jr.UNAVAILABLE,e+": "+t);throw t}function Ka(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Fr(n,i);return 0===s?Fr(r,o):s}var Ya=(Ja.prototype.Fi=function(){return++this.Ni},Ja.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Ka(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Ja.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Ja),Xa={$i:!1,xi:0,Oi:0,Mi:0},Qa=(Za.Ui=function(t){return new Za(t,Za.Qi,Za.Wi)},Za);function Za(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function Ja(t){this.Ci=t,this.buffer=new Fi(Ka),this.Ni=0}Qa.ji=-1,Qa.Ki=1048576,Qa.Gi=41943040,Qa.Qi=10,Qa.Wi=1e3,Qa.zi=new Qa(Qa.Gi,Qa.Qi,Qa.Wi),Qa.Hi=new Qa(Qa.ji,0,0);var $a=(nc.prototype.start=function(t){this.Yi.params.Li!==Qa.ji&&this.Zi(t)},nc.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(nc.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),nc.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;Lr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return xa(e=t.sent())?(Lr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Lh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},nc),tc=(ec.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},ec.prototype.rr=function(t,e){var n=this;if(0===e)return ua.resolve(pa.Es);var r=new Ya(e);return this.nr.be(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},ec.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},ec.prototype.ar=function(t,e){return this.nr.ar(t,e)},ec.prototype.ur=function(e,n){var r=this;return this.params.Li===Qa.ji?(Lr("LruGarbageCollector","Garbage collection skipped; disabled"),ua.resolve(Xa)):this.cr(e).next(function(t){return t<r.params.Li?(Lr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Xa):r.lr(e,n)})},ec.prototype.cr=function(t){return this.nr.cr(t)},ec.prototype.lr=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>h.params.Bi?(Lr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Bi+" from "+t),h.params.Bi):t,s=Date.now(),h.rr(e,i)}).next(function(t){return r=t,u=Date.now(),h.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.ar(e,r)}).next(function(t){return c=Date.now(),Rr()<=l.DEBUG&&Lr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ua.resolve({$i:!0,xi:i,Oi:o,Mi:t})})},ec);function ec(t,e){this.nr=t,this.params=e}function nc(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}function rc(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=ic(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return ic(e)}function ic(t){return t+""}function oc(t){var e=t.length;if(Vr(2<=e),2===e)return Vr(""===t.charAt(0)&&""===t.charAt(1)),ri.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Cr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Cr()}o=s+2}return new ri(r)}var sc=function(t){this._r=t};function uc(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=Ho(n,r.name),s=jo(r.updateTime),u=new Zs({mapValue:{fields:r.fields}}),new uu(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=si.K(e.noDocument.path),c=lc(e.noDocument.readTime);return new au(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=si.K(e.unknownDocument.path),f=lc(e.unknownDocument.version);return new cu(h,f)}return Cr()}function ac(t,e,n){var r,i,o=cc(n),s=e.key.path.p().N();if(e instanceof uu){var u={name:zo(r=t._r,(i=e).key),fields:i.tn().mapValue.fields,updateTime:Fo(r,i.version.A())},a=e.hasCommittedMutations;return new Hc(null,null,u,a,o,s)}if(e instanceof au){var c=e.key.path.N(),h=fc(e.version),f=e.hasCommittedMutations;return new Hc(null,new Bc(c,h),null,f,o,s)}if(e instanceof cu){var l=e.key.path.N(),p=fc(e.version);return new Hc(new zc(l,p),null,null,!0,o,s)}return Cr()}function cc(t){var e=t.A();return[e.seconds,e.nanoseconds]}function hc(t){var e=new ti(t[0],t[1]);return ei.I(e)}function fc(t){var e=t.A();return new Pc(e.seconds,e.nanoseconds)}function lc(t){var e=new ti(t.seconds,t.nanoseconds);return ei.I(e)}function pc(e,t){var n=(t.baseMutations||[]).map(function(t){return Jo(e._r,t)}),r=t.mutations.map(function(t){return Jo(e._r,t)}),i=ti.fromMillis(t.localWriteTimeMs);return new oa(t.batchId,i,n,r)}function dc(t){var e,n=lc(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?lc(t.lastLimboFreeSnapshotVersion):ei.min(),i=void 0!==t.query.documents?(Vr(1===(e=t.query).documents.length),bu(gu(Ko(e.documents[0])))):function(t){var e,n=Ko(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Vr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=is(t.unaryFilter.field);return Ru.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=is(t.unaryFilter.field);return Ru.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=is(t.unaryFilter.field);return Ru.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=is(t.unaryFilter.field);return Ru.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Ru.create(is(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Cr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new ia(is((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;r.limit&&(a=r.limit,h=yi(c="object"==typeof a?a.value:a)?null:c);var f=null;r.startAt&&(f=ns(r.startAt));var l=null;return r.endAt&&(l=ns(r.endAt)),bu(vu(n,o,u,s,h,"F",f,l))}(t.query);return new Di(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ti.fromBase64String(t.resumeToken))}function yc(t,e){var n=fc(e.Z),r=fc(e.lastLimboFreeSnapshotVersion),i=(Ii(e.target)?$o:ts)(t._r,e.target),o=e.resumeToken.toBase64();return new Kc(e.targetId,bi(e.target),n,o,e.sequenceNumber,r,i)}var vc=(gc.Tr=function(t,e,n,r){return Vr(""!==t.uid),new gc(t.Er()?t.uid:"",e,n,r)},gc.prototype.Ir=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bc(t).Zs({index:qc.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},gc.prototype.mr=function(d,y,v,g){var m=this,w=Ec(d),b=bc(d);return b.add({}).next(function(t){Vr("number"==typeof t);for(var e,n,r,i,o,s=new oa(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Zo(e._r,t)}),o=r.mutations.map(function(t){return Zo(e._r,t)}),new qc(n,r.batchId,r.Tn.toMillis(),i,o)),a=[],c=new Fi(function(t,e){return Fr(t.F(),e.F())}),h=0,f=g;h<f.length;h++){var l=f[h],p=jc.key(m.userId,l.key.path,t),c=c.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,jc.PLACEHOLDER))}return c.forEach(function(t){a.push(m.zn.Ar(d,t))}),d.Wn(function(){m.wr[t]=s.keys()}),ua.Cn(a).next(function(){return s})})},gc.prototype.Rr=function(t,e){var n=this;return bc(t).get(e).next(function(t){return t?(Vr(t.userId===n.userId),pc(n.serializer,t)):null})},gc.prototype.Pr=function(t,n){var r=this;return this.wr[n]?ua.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},gc.prototype.gr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return bc(t).Zs({index:qc.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Vr(e.batchId>=i),o=pc(r.serializer,e)),n.done()}).next(function(){return o})},gc.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return bc(t).Zs({index:qc.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},gc.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return bc(t).Hs(qc.userMutationsIndex,n).next(function(t){return t.map(function(t){return pc(e.serializer,t)})})},gc.prototype.Yn=function(u,a){var c=this,t=jc.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return Ec(u).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=oc(i);if(r===c.userId&&a.path.isEqual(s))return bc(u).get(o).next(function(t){if(!t)throw Cr();Vr(t.userId===c.userId),h.push(pc(c.serializer,t))});n.done()}).next(function(){return h})},gc.prototype.es=function(r,t){var a=this,c=new Fi(Fr),i=[];return t.forEach(function(u){var t=jc.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=Ec(r).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=oc(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),ua.Cn(i).next(function(){return a.pr(r,c)})},gc.prototype.as=function(t,e){var u=this,a=e.path,c=a.length+1,n=jc.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new Fi(Fr);return Ec(t).Zs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=oc(i);r===u.userId&&a.D(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.pr(t,h)})},gc.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(bc(e).get(t).next(function(t){if(null===t)throw Cr();Vr(t.userId===n.userId),r.push(pc(n.serializer,t))}))}),ua.Cn(i).next(function(){return r})},gc.prototype.br=function(e,n){var r=this;return wc(e.vr,this.userId,n).next(function(t){return e.Wn(function(){r.Sr(n.batchId)}),ua.forEach(t,function(t){return r.dr.Dr(e,t)})})},gc.prototype.Sr=function(t){delete this.wr[t]},gc.prototype.Cr=function(n){var o=this;return this.Ir(n).next(function(t){if(!t)return ua.resolve();var e=IDBKeyRange.lowerBound(jc.prefixForUser(o.userId)),i=[];return Ec(n).Zs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=oc(t[1]),i.push(r)):n.done()}).next(function(){Vr(0===i.length)})})},gc.prototype.Nr=function(t,e){return mc(t,this.userId,e)},gc.prototype.Fr=function(t){var e=this;return Ic(t).get(this.userId).next(function(t){return t||new Fc(e.userId,-1,"")})},gc);function gc(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}function mc(t,o,e){var n=jc.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return Ec(t).Zs({range:r,Xs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function wc(t,e,n){var r=t.store(qc.store),i=t.store(jc.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Vr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=jc.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return ua.Cn(o).next(function(){return c})}function bc(t){return ph.Ms(t,qc.store)}function Ec(t){return ph.Ms(t,jc.store)}function Ic(t){return ph.Ms(t,Fc.store)}var Tc,Nc=(_c.prototype.xn=function(t,e,n){return Sc(t).put(Dc(e),n)},_c.prototype.Mn=function(t,e){var n=Sc(t),r=Dc(e);return n.delete(r)},_c.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},_c.prototype.Ln=function(t,e){var n=this;return Sc(t).get(Dc(e)).next(function(t){return n.$r(t)})},_c.prototype.xr=function(t,e){var n=this;return Sc(t).get(Dc(e)).next(function(t){var e=n.$r(t);return e?{Or:e,size:kc(t)}:null})},_c.prototype.getEntries=function(t,e){var r=this,i=ji;return this.Mr(t,e,function(t,e){var n=r.$r(e);i=i.st(t,n)}).next(function(){return i})},_c.prototype.Lr=function(t,e){var r=this,i=ji,o=new xi(si.P);return this.Mr(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.st(t,n),o.st(t,kc(e))):(i=i.st(t,null),o.st(t,0))}).next(function(){return{qr:i,Br:o}})},_c.prototype.Mr=function(t,e,i){if(e._())return ua.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.ut(),s=o.wt();return Sc(t).Zs({range:n},function(t,e,n){for(var r=si.K(t);s&&si.P(s,r)<0;)i(s,null),s=o.wt();s&&s.isEqual(r)&&(i(s,e),s=o.Tt()?o.wt():null),s?n.Gs(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Tt()?o.wt():null})},_c.prototype.ns=function(t,i,e){var n,r,o,s=this,u=zi,a=i.path.length+1,c={};return e.isEqual(ei.min())?(n=i.path.N(),c.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=cc(e),c.range=IDBKeyRange.lowerBound([r,o],!0),c.index=Hc.collectionReadTimeIndex),Sc(t).Zs(c,function(t,e,n){var r;t.length===a&&(r=uc(s.serializer,e),i.path.D(r.key.path)?r instanceof uu&&Su(i,r)&&(u=u.st(r.key,r)):n.done())}).next(function(){return u})},_c.prototype.Ur=function(t,e){var r=this,i=ji,o=cc(e),n=Sc(t),s=IDBKeyRange.lowerBound(o,!0);return n.Zs({index:Hc.readTimeIndex,range:s},function(t,e){var n=uc(r.serializer,e);i=i.st(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:hc(o)}})},_c.prototype.Wr=function(t){var e=Sc(t),r=ei.min();return e.Zs({index:Hc.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=hc(e.readTime)),n.done()}).next(function(){return r})},_c.prototype.jr=function(t){return new _c.Kr(this,!!t&&t.Gr)},_c.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},_c.prototype.getMetadata=function(t){return Ac(t).get(Wc.key).next(function(t){return Vr(!!t),t})},_c.prototype.kr=function(t,e){return Ac(t).put(Wc.key,e)},_c.prototype.$r=function(t){if(t){var e=uc(this.serializer,t);return e instanceof au&&e.version.isEqual(ei.min())?null:e}return null},_c);function _c(t,e){this.serializer=t,this.zn=e}function Ac(t){return ph.Ms(t,Wc.store)}function Sc(t){return ph.Ms(t,Hc.store)}function Dc(t){return t.path.N()}function kc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Cr();e=t.noDocument}return JSON.stringify(e).length}function Rc(t,e){var n=this;return(n=Tc.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Zr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Nc.Kr=(o(Rc,Tc=aa),Rc.prototype.Un=function(s){var u=this,a=[],c=0,h=new Fi(function(t,e){return Fr(t.F(),e.F())});return this.Fn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=ac(u.Hr.serializer,e,u.readTime),h=h.add(t.path.p()),r=kc(n),c+=r-o,a.push(u.Hr.xn(s,t,n))):(c-=o,u.Gr?(i=ac(u.Hr.serializer,new au(t,ei.min()),u.readTime),a.push(u.Hr.xn(s,t,i))):a.push(u.Hr.Mn(s,t)))}),h.forEach(function(t){a.push(u.Hr.zn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,c)),ua.Cn(a)},Rc.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)})},Rc.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},Rc);var Lc=(Mc.prototype.Ar=function(t,e){return this.Jr.add(e),ua.resolve()},Mc.prototype.hs=function(t,e){return ua.resolve(this.Jr.getEntries(e))},Mc),xc=(Uc.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Fi(ri.P),i=!r.has(n);return this.index[e]=r.add(n),i},Uc.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Uc.prototype.getEntries=function(t){return(this.index[t]||new Fi(ri.P)).N()},Uc),Oc=(Vc.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Vr(t<e&&0<=t&&e<=10);var o,s=new Oa(r);t<1&&1<=e&&(n.createObjectStore(Cc.store),(o=n).createObjectStore(Fc.store,{keyPath:Fc.keyPath}),o.createObjectStore(qc.store,{keyPath:qc.keyPath,autoIncrement:!0}).createIndex(qc.userMutationsIndex,qc.userMutationsKeyPath,{unique:!0}),o.createObjectStore(jc.store),Zc(n),n.createObjectStore(Hc.store));var u,a=ua.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Yc.store),u.deleteObjectStore(Kc.store),u.deleteObjectStore(Xc.store),Zc(n)),a=a.next(function(){return t=s.store(Xc.store),e=new Xc(0,0,ei.min().A(),0),t.put(Xc.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(qc.store).Hs().next(function(t){r.deleteObjectStore(qc.store),r.createObjectStore(qc.store,{keyPath:qc.keyPath,autoIncrement:!0}).createIndex(qc.userMutationsIndex,qc.userMutationsKeyPath,{unique:!0});var e=i.store(qc.store),n=t.map(function(t){return e.put(t)});return ua.Cn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Jc.store,{keyPath:Jc.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Wc.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Hc.store)).createIndex(Hc.readTimeIndex,Hc.readTimeIndexPath,{unique:!1}),t.createIndex(Hc.collectionReadTimeIndex,Hc.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Vc.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Hc.store).Zs(function(t,e){n+=kc(e)}).next(function(){var t=new Wc(n);return e.store(Wc.store).put(Wc.key,t)})},Vc.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Fc.store),e=r.store(qc.store);return t.Hs().next(function(t){return ua.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Hs(qc.userMutationsIndex,t).next(function(t){return ua.forEach(t,function(t){Vr(t.userId===n.userId);var e=pc(i.serializer,t);return wc(r,n.userId,e).next(function(){})})})})})},Vc.prototype.ensureSequenceNumbers=function(t){var s=t.store(Yc.store),e=t.store(Hc.store);return t.store(Xc.store).get(Xc.key).next(function(i){var o=[];return e.Zs(function(t,e){var n=new ri(t),r=[0,rc(n)];o.push(s.get(r).next(function(t){return t?ua.resolve():s.put(new Yc(0,rc(n),i.highestListenSequenceNumber))}))}).next(function(){return ua.Cn(o)})})},Vc.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.S(),n=t.p();return r.put({collectionId:e,parent:rc(n)})}}t.createObjectStore(Qc.store,{keyPath:Qc.keyPath});var r=e.store(Qc.store),o=new xc;return e.store(Hc.store).Zs({Xs:!0},function(t,e){var n=new ri(t);return i(n.p())}).next(function(){return e.store(jc.store).Zs({Xs:!0},function(t,e){t[0];var n=t[1],r=(t[2],oc(n));return i(r.p())})})},Vc.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Kc.store);return o.Zs(function(t,e){var n=dc(e),r=yc(i.serializer,n);return o.put(r)})},Vc),Pc=function(t,e){this.seconds=t,this.nanoseconds=e},Cc=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Vc(t){this.serializer=t}function Uc(){this.index={}}function Mc(){this.Jr=new xc}Cc.store="owner",Cc.key="owner";var Fc=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Fc.store="mutationQueues",Fc.keyPath="userId";var qc=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};qc.store="mutations",qc.keyPath="batchId",qc.userMutationsIndex="userMutationsIndex",qc.userMutationsKeyPath=["userId","batchId"];var jc=(Gc.prefixForUser=function(t){return[t]},Gc.prefixForPath=function(t,e){return[t,rc(e)]},Gc.key=function(t,e,n){return[t,rc(e),n]},Gc);function Gc(){}jc.store="documentMutations",jc.PLACEHOLDER=new jc;var Bc=function(t,e){this.path=t,this.readTime=e},zc=function(t,e){this.path=t,this.version=e},Hc=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Hc.store="remoteDocuments",Hc.readTimeIndex="readTimeIndex",Hc.readTimeIndexPath="readTime",Hc.collectionReadTimeIndex="collectionReadTimeIndex",Hc.collectionReadTimeIndexPath=["parentPath","readTime"];var Wc=function(t){this.byteSize=t};Wc.store="remoteDocumentGlobal",Wc.key="remoteDocumentGlobalKey";var Kc=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Kc.store="targets",Kc.keyPath="targetId",Kc.queryTargetsIndexName="queryTargetsIndex",Kc.queryTargetsKeyPath=["canonicalId","targetId"];var Yc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Yc.store="targetDocuments",Yc.keyPath=["targetId","path"],Yc.documentTargetsIndex="documentTargetsIndex",Yc.documentTargetsKeyPath=["path","targetId"];var Xc=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Xc.key="targetGlobalKey",Xc.store="targetGlobal";var Qc=function(t,e){this.collectionId=t,this.parent=e};function Zc(t){t.createObjectStore(Yc.store,{keyPath:Yc.keyPath}).createIndex(Yc.documentTargetsIndex,Yc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Kc.store,{keyPath:Kc.keyPath}).createIndex(Kc.queryTargetsIndexName,Kc.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Xc.store)}Qc.store="collectionParents",Qc.keyPath=["collectionId","parent"];var Jc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Jc.store="clientMetadata",Jc.keyPath="clientId";var $c=s(s(s([Fc.store,qc.store,jc.store,Hc.store,Kc.store,Cc.store,Xc.store,Yc.store],[Jc.store]),[Wc.store]),[Qc.store]),th=(eh.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return ua.resolve();var r=e.S(),i=e.p();t.Wn(function(){n.Xr.add(e)});var o={collectionId:r,parent:rc(i)};return nh(t).put(o)},eh.prototype.hs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[jr(i),""],!1,!0);return nh(t).Hs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(oc(r.parent))}return o})},eh);function eh(){this.Xr=new xc}function nh(t){return ph.Ms(t,Qc.store)}var rh=(sh.prototype.next=function(){return this.Zr+=2,this.Zr},sh.to=function(){return new sh(0)},sh.eo=function(){return new sh(-1)},sh),ih=(oh.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new rh(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},oh.prototype.ro=function(t){return this.so(t).next(function(t){return ei.I(new ti(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},oh.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},oh.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},oh.prototype.ao=function(e,n){var r=this;return this.uo(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.co(n,t),r.io(e,t)})})},oh.prototype.lo=function(t,e){return this.uo(t,e)},oh.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return uh(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Vr(0<t.targetCount),--t.targetCount,n.io(e,t)})},oh.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return uh(r).Zs(function(t,e){var n=dc(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return ua.Cn(a)}).next(function(){return u})},oh.prototype.be=function(t,r){return uh(t).Zs(function(t,e){var n=dc(e);r(n)})},oh.prototype.so=function(t){return ah(t).get(Xc.key).next(function(t){return Vr(null!==t),t})},oh.prototype.io=function(t,e){return ah(t).put(Xc.key,e)},oh.prototype.uo=function(t,e){return uh(t).put(yc(this.serializer,e))},oh.prototype.co=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},oh.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},oh.prototype.wo=function(t,i){var e=bi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return uh(t).Zs({range:n,index:Kc.queryTargetsIndexName},function(t,e,n){var r=dc(e);Ei(i,r.target)&&(o=r,n.done())}).next(function(){return o})},oh.prototype.To=function(n,t,r){var i=this,o=[],s=ch(n);return t.forEach(function(t){var e=rc(t.path);o.push(s.put(new Yc(r,e))),o.push(i.dr.Eo(n,r,t))}),ua.Cn(o)},oh.prototype.Io=function(n,t,r){var i=this,o=ch(n);return ua.forEach(t,function(t){var e=rc(t.path);return ua.Cn([o.delete([r,e]),i.dr.mo(n,r,t)])})},oh.prototype.fo=function(t,e){var n=ch(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},oh.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ch(t),o=Ki();return r.Zs({range:n,Xs:!0},function(t,e,n){var r=oc(t[1]),i=new si(r);o=o.add(i)}).next(function(){return o})},oh.prototype.Nr=function(t,e){var n=rc(e.path),r=IDBKeyRange.bound([n],[jr(n)],!1,!0),i=0;return ch(t).Zs({index:Yc.documentTargetsIndex,Xs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},oh.prototype.Me=function(t,e){return uh(t).get(e).next(function(t){return t?dc(t):null})},oh);function oh(t,e){this.dr=t,this.serializer=e}function sh(t){this.Zr=t}function uh(t){return ph.Ms(t,Kc.store)}function ah(t){return ph.Ms(t,Xc.store)}function ch(t){return ph.Ms(t,Yc.store)}var hh,fh="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",lh=(o(yh,hh=ha),yh),ph=(dh.Ms=function(t,e){if(t instanceof lh)return _a.Ms(t.vr,e);throw Cr()},dh.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new $r(Jr.FAILED_PRECONDITION,fh);return e.Oo(),e.Mo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new pa(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},dh.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},dh.prototype.Bo=function(n){var t=this;this.Fo.Bs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},dh.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Is.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},dh.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return gh(e).put(new Jc(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.Is.gi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(xa(t))return Lr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Lr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Is.gi(function(){return n.Co(t)}),n.isPrimary=t})},dh.prototype.Qo=function(t){var e=this;return vh(t).get(Cc.key).next(function(t){return ua.resolve(e.Go(t))})},dh.prototype.zo=function(t){return gh(t).delete(this.clientId)},dh.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=dh.Ms(t,Jc.store);return r.Hs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ua.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},dh.prototype.Lo=function(){var t=this;this.So=this.Is.Ss("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},dh.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},dh.prototype.Wo=function(e){var i=this;return this.Vo?ua.resolve(!0):vh(e).get(Cc.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new $r(Jr.FAILED_PRECONDITION,fh);return!1}}return!(!i.networkEnabled||!i.inForeground)||gh(e).Hs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Lr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},dh.prototype.th=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Cc.store,Jc.store],function(t){var e=new lh(t,pa.Es);return n.jo(e).next(function(){return n.zo(e)})})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},dh.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},dh.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return gh(t).Hs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(dh.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),dh.prototype.oh=function(t){return vc.Tr(t,this.serializer,this.zn,this.dr)},dh.prototype.hh=function(){return this.ko},dh.prototype.ah=function(){return this.Kn},dh.prototype.uh=function(){return this.zn},dh.prototype.runTransaction=function(e,n,r){var i=this;Lr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,$c,function(t){return o=new lh(t,i.yo?i.yo.next():pa.Es),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw xr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Is.gi(function(){return i.Co(!1)}),new $r(Jr.FAILED_PRECONDITION,ca);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.jn(),t})},dh.prototype.lh=function(t){var e=this;return vh(t).get(Cc.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new $r(Jr.FAILED_PRECONDITION,fh)})},dh.prototype.Ko=function(t){var e=new Cc(this.clientId,this.allowTabSynchronization,Date.now());return vh(t).put(Cc.key,e)},dh.ks=function(){return _a.ks()},dh.prototype.jo=function(t){var e=this,n=vh(t);return n.get(Cc.key).next(function(t){return e.Go(t)?(Lr("IndexedDbPersistence","Releasing primary lease."),n.delete(Cc.key)):ua.resolve()})},dh.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(xr("Detected an update time that is in the future: "+t+" > "+n),1))},dh.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.Is.ai(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},dh.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},dh.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.Is.ai(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},dh.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},dh.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return Lr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return xr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},dh.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){xr("Failed to set zombie client id.",t)}},dh.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},dh.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},dh);function dh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Is=i,this.window=o,this.document=s,this.Po=a,this.Vo=c,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!dh.ks())throw new $r(Jr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new mh(this,r),this.No=e+"main",this.serializer=new sc(u),this.Fo=new _a(this.No,10,new Oc(this.serializer)),this.ko=new ih(this.dr,this.serializer),this.zn=new th,this.Kn=new Nc(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===c&&xr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function yh(t,e){var n=this;return(n=hh.call(this)||this).vr=t,n.Ro=e,n}function vh(t){return ph.Ms(t,Cc.store)}function gh(t){return ph.Ms(t,Jc.store)}var mh=(wh.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},wh.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},wh.prototype.be=function(t,e){return this.db.hh().be(t,e)},wh.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},wh.prototype.Eo=function(t,e,n){return bh(t,n)},wh.prototype.mo=function(t,e,n){return bh(t,n)},wh.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},wh.prototype.Dr=bh,wh.prototype.dh=function(t,e){return r=e,i=!1,Ic(n=t).ti(function(t){return mc(n,t,r).next(function(t){return t&&(i=!0),ua.resolve(!t)})}).next(function(){return i});var n,r,i},wh.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.Ln(r,e).next(function(){return s.Mn(e),ch(r).delete([0,rc(e.path)])})}),u.push(n))}).next(function(){return ua.Cn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},wh.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},wh.prototype.wh=bh,wh.prototype.fh=function(t,o){var s,e=ch(t),u=pa.Es;return e.Zs({index:Yc.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==pa.Es&&o(new si(oc(s)),u),u=i,s=r):u=pa.Es}).next(function(){u!==pa.Es&&o(new si(oc(s)),u)})},wh.prototype.cr=function(t){return this.db.ah().zr(t)},wh);function wh(t,e){this.db=t,this.Yi=new tc(this,e)}function bh(t,e){return ch(t).put((n=t.Ro,new Yc(0,rc(e.path),n)));var n}function Eh(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ih=(Th.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Eh)})},Th);function Th(t,e,n){this.persistence=t,this.Th=e,this.Eh=new xi(Fr),this.Ih=new Zr(bi,Ei),this.mh=ei.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new fa(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}function Nh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,n,i,o,s,r,u,a=h.batch.keys(),c=f.Ah.jr({Gr:!0});return e=f,n=t,o=c,s=(i=h).batch,r=s.keys(),u=ua.resolve(),r.forEach(function(r){u=u.next(function(){return o.Ln(n,r)}).next(function(t){var e=t,n=i.Pn.get(r);Vr(null!==n),(!e||e.version.o(n)<0)&&(e=s.En(r,e,i))&&o.xn(e,i.Rn)})}),u.next(function(){return e.Gn.br(n,s)}).next(function(){return c.apply(t)}).next(function(){return f.Gn.Cr(t)}).next(function(){return f.Rh.Zn(t,a)})})}function _h(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})}function Ah(t,s){var h=t,f=s.Z,l=h.Eh;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=h.Ah.jr({Gr:!0});l=h.Eh;var c=[];s.Wt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(c.push(h.ko.Io(a,t.Zt,e).next(function(){return h.ko.To(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(r=u.et(n,f).tt(a.Ro),l=l.st(e,r),i=u,s=t,Vr(0<(o=r).resumeToken.Y()),(0===i.resumeToken.Y()||3e8<=o.Z.m()-i.Z.m()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&c.push(h.ko.lo(a,r))))});var t,o=ji,n=Ki();return s.Kt.forEach(function(t,e){n=n.add(t)}),c.push(i.getEntries(a,n).next(function(r){s.Kt.forEach(function(t,e){var n=r.get(t);e instanceof au&&e.version.isEqual(ei.min())?(i.Mn(t,f),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.xn(e,f),o=o.st(t,e)):Lr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Gt.has(t)&&c.push(h.persistence.dr.wh(a,t))})})),f.isEqual(ei.min())||(t=h.ko.ro(a).next(function(t){return h.ko.ho(a,a.Ro,f)}),c.push(t)),ua.Cn(c).next(function(){return i.apply(a)}).next(function(){return h.Rh.ts(a,o)})}).then(function(t){return h.Eh=l,t})}function Sh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,ua.resolve(n)):i.ko.no(e).next(function(t){return n=new Di(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(i.Eh=i.Eh.st(t.targetId,t),i.Ih.set(r,t.targetId)),t})}function Dh(o,s,u){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Eh.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.dr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!xa(i=t.sent()))throw i;return Lr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Eh=e.Eh.remove(s),e.Ih.delete(n.target),[2]}})})}function kh(t,s,u){var a=t,c=ei.min(),h=Ki();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=bu(s),(void 0!==(o=(i=t).Ih.get(r))?ua.resolve(i.Eh.get(o)):i.ko.wo(n,r)).next(function(t){if(t)return c=t.lastLimboFreeSnapshotVersion,a.ko.Ao(e,t.targetId).next(function(t){h=t})}).next(function(){return a.Th.ns(e,s,u?c:ei.min(),u?h:Ki())}).next(function(t){return{documents:t,gh:h}});var t,n,r,i,o})}function Rh(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function Lh(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Jr.FAILED_PRECONDITION||e.message!==ca)throw e;return Lr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var xh=(Uh.prototype._=function(){return this.Vh._()},Uh.prototype.Eo=function(t,e){var n=new Oh(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},Uh.prototype.vh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Uh.prototype.mo=function(t,e){this.Sh(new Oh(t,e))},Uh.prototype.Dh=function(t,e){var n=this;t.forEach(function(t){return n.mo(t,e)})},Uh.prototype.Ch=function(t){var e=this,n=new si(new ri([])),r=new Oh(n,t),i=new Oh(n,t+1),o=[];return this.ph.St([r,i],function(t){e.Sh(t),o.push(t.key)}),o},Uh.prototype.Nh=function(){var e=this;this.Vh.forEach(function(t){return e.Sh(t)})},Uh.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},Uh.prototype.Fh=function(t){var e=new si(new ri([])),n=new Oh(e,t),r=new Oh(e,t+1),i=Ki();return this.ph.St([n,r],function(t){i=i.add(t.key)}),i},Uh.prototype.Nr=function(t){var e=new Oh(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},Uh),Oh=(Vh.yh=function(t,e){return si.P(t.key,e.key)||Fr(t.kh,e.kh)},Vh.bh=function(t,e){return Fr(t.kh,e.kh)||si.P(t.key,e.key)},Vh),Ph=(Ch.prototype.Er=function(){return null!=this.uid},Ch.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},Ch.prototype.isEqual=function(t){return t.uid===this.uid},Ch);function Ch(t){this.uid=t}function Vh(t,e){this.key=t,this.kh=e}function Uh(){this.Vh=new Fi(Oh.yh),this.ph=new Fi(Oh.bh)}Ph.UNAUTHENTICATED=new Ph(null),Ph.xh=new Ph("google-credentials-uid"),Ph.Oh=new Ph("first-party-uid");function Mh(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t}var Fh,qh,jh,Gh=(af.prototype.getToken=function(){return Promise.resolve(null)},af.prototype.qh=function(){},af.prototype.Bh=function(t){(this.Lh=t)(Ph.UNAUTHENTICATED)},af.prototype.Uh=function(){this.Lh=null},af),Bh=(uf.prototype.getToken=function(){var e=this,n=this.jh,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.jh!==n?(Lr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Vr("string"==typeof t.accessToken),new Mh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},uf.prototype.qh=function(){this.forceRefresh=!0},uf.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},uf.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},uf.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return Vr(null===t||"string"==typeof t),new Ph(t)},uf),zh=(Object.defineProperty(sf.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),sf),Hh=(of.prototype.getToken=function(){return Promise.resolve(new zh(this.Gh,this.zh))},of.prototype.Bh=function(t){t(Ph.Oh)},of.prototype.Uh=function(){},of.prototype.qh=function(){},of),Wh=(rf.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},rf.prototype.na=function(){return 2===this.state},rf.prototype.start=function(){3!==this.state?this.auth():this.sa()},rf.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},rf.prototype.ia=function(){this.state=0,this.Ti.reset()},rf.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.Is.Ss(this.Yh,6e4,function(){return t.oa()}))},rf.prototype.ha=function(t){this.aa(),this.stream.send(t)},rf.prototype.oa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.na()?[2,this.close(0)]:[2]})})},rf.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},rf.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==e?this.Ti.reset():n&&n.code===Jr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):n&&n.code===Jr.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ua(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ca(n)];case 1:return t.sent(),[2]}})})},rf.prototype.ua=function(){},rf.prototype.auth=function(){var n=this;this.state=1;var t=this.la(this.Zh),e=this.Zh;this.Xh.getToken().then(function(t){n.Zh===e&&n._a(t)},function(e){t(function(){var t=new $r(Jr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fa(t)})})},rf.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa(function(){n(function(){return e.state=2,e.listener.wa()})}),this.stream.ca(function(t){n(function(){return e.fa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},rf.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},rf.prototype.fa=function(t){return Lr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},rf.prototype.la=function(e){var n=this;return function(t){n.Is.ai(function(){return n.Zh===e?t():(Lr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},rf),Kh=(o(nf,jh=Wh),nf.prototype.da=function(t){return this.Jh.Ta("Listen",t)},nf.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Cr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Le?(Vr(void 0===i||"string"==typeof i),Ti.fromBase64String(i||"")):(Vr(void 0===i||i instanceof Uint8Array),Ti.fromUint8Array(i||new Uint8Array))),c=e.targetChange.cause,h=c&&(r=void 0===(n=c).code?Jr.UNKNOWN:Li(n.code),new $r(r,n.message||"")),f=new Zi(s,u,a,h||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=Ho(t,l.document.name),d=jo(l.document.updateTime),y=new Zs({mapValue:{fields:l.document.fields}}),v=new uu(p,d,y,{}),g=l.targetIds||[],m=l.removedTargetIds||[];f=new Xi(g,m,v.key,v)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=Ho(t,w.document),E=w.readTime?jo(w.readTime):ei.min(),I=new au(b,E),T=w.removedTargetIds||[];f=new Xi([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var N=e.documentRemove;N.document;var _=Ho(t,N.document),A=N.removedTargetIds||[];f=new Xi([],A,_,null)}else{if(!("filter"in e))return Cr();e.filter;var S=e.filter;S.targetId;var D=S.count||0,k=new _i(D),R=S.targetId;f=new Qi(R,k)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ei.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?ei.min():jo(e.readTime)}(t);return this.listener.Ea(e,n)},nf.prototype.Ia=function(t){var e,n,r,i,o={};o.database=Yo(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Ii(i)?{documents:$o(e,i)}:{query:ts(e,i)}).targetId=n.targetId,0<n.resumeToken.Y()&&(r.resumeToken=qo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ha(o)},nf.prototype.ma=function(t){var e={};e.database=Yo(this.serializer),e.removeTarget=t,this.ha(e)},nf),Yh=(o(ef,qh=Wh),Object.defineProperty(ef.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),ef.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,qh.prototype.start.call(this)},ef.prototype.ua=function(){this.Aa&&this.Pa([])},ef.prototype.da=function(t){return this.Jh.Ta("Write",t)},ef.prototype.onMessage=function(t){if(Vr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Vr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?jo(t.updateTime):jo(e);n.isEqual(ei.min())&&(n=jo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ss(n,r)}(t,i)})):[]),n=jo(t.commitTime);return this.listener.ga(n,e)}var r,i;return Vr(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},ef.prototype.ya=function(){var t={};t.database=Yo(this.serializer),this.ha(t)},ef.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Zo(e.serializer,t)})};this.ha(n)},ef),Xh=(o(tf,Fh=function(){}),tf.prototype.ba=function(){if(this.pa)throw new $r(Jr.FAILED_PRECONDITION,"The client has already been terminated.")},tf.prototype.va=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.va(e,n,r,t)}).catch(function(t){throw t.code===Jr.UNAUTHENTICATED&&i.credentials.qh(),t})},tf.prototype.Sa=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.Sa(e,n,r,t)}).catch(function(t){throw t.code===Jr.UNAUTHENTICATED&&i.credentials.qh(),t})},tf.prototype.terminate=function(){this.pa=!1},tf),Qh=($h.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()}))},$h.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,1<=this.Ca&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},$h.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},$h.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},$h.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(xr(e),this.Fa=!1):Lr("OnlineStateTracker",e)},$h.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},$h),Zh=(Jh.prototype.start=function(){return this.enableNetwork()},Jh.prototype.enableNetwork=function(){return this.Wa.delete(0),this.iu()},Jh.prototype.iu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(this.ru()?this.ou():this.Ha.set("Unknown"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Jh.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}})})},Jh.prototype.au=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.tu.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),0<this.Ba.length&&(Lr("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.uu(),[2]}})})},Jh.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.au()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}})})},Jh.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.ru()?this.ou():this.Ya.na()&&this.cu(t))},Jh.prototype.lu=function(t){this.Ua.delete(t),this.Ya.na()&&this._u(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},Jh.prototype.Me=function(t){return this.Ua.get(t)||null},Jh.prototype.Oe=function(t){return this.fu.Oe(t)},Jh.prototype.cu=function(t){this.Qa.we(t.targetId),this.Ya.Ia(t)},Jh.prototype._u=function(t){this.Qa.we(t),this.Ya.ma(t)},Jh.prototype.ou=function(){this.Qa=new io(this),this.Ya.start(),this.Ha.ka()},Jh.prototype.ru=function(){return this.Ga()&&!this.Ya.ea()&&0<this.Ua.size},Jh.prototype.Ga=function(){return 0===this.Wa.size},Jh.prototype.uu=function(){this.Qa=null},Jh.prototype.Ja=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.Ua.forEach(function(t,e){n.cu(t)}),[2]})})},Jh.prototype.Xa=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.uu(),this.ru()?(this.Ha.Oa(e),this.ou()):this.Ha.set("Unknown"),[2]})})},Jh.prototype.Za=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Ha.set("Online"),!(i instanceof Zi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.du(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Lr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.wu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Xi?this.Qa.ge(i):i instanceof Qi?this.Qa.Ce(i):this.Qa.pe(i),o.isEqual(ei.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,_h(this.La)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Tu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Lr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.wu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Jh.prototype.wu=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!xa(n))throw n;return this.Wa.add(1),[4,this.au()];case 1:return t.sent(),this.Ha.set("Offline"),r=r||function(){return _h(e.La)},this.ei.gi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Wa.delete(1),[4,this.iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Jh.prototype.Eu=function(e){var n=this;return e().catch(function(t){return n.wu(t,e)})},Jh.prototype.Tu=function(r){var i=this,t=this.Qa.ke(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=i.Ua.get(e))&&i.Ua.set(e,n.et(t.resumeToken,r))}),t.jt.forEach(function(t){var e,n=i.Ua.get(t);n&&(i.Ua.set(t,n.et(Ti.J,n.Z)),i._u(t),e=new Di(n.target,t,1,n.sequenceNumber),i.cu(e))}),this.fu.Iu(t)},Jh.prototype.du=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Ua.has(i)?[4,this.fu.mu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Ua.delete(i),this.Qa.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Jh.prototype.hu=function(){return g(this,void 0,void 0,function(){var i,o,s;return w(this,function(t){switch(t.label){case 0:i=0<this.Ba.length?this.Ba[this.Ba.length-1].batchId:-1,t.label=1;case 1:if(!this.Au())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.La,n=i,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Gn.gr(t,n)}))];case 3:return null===(o=t.sent())?(0===this.Ba.length&&this.tu.ra(),[3,7]):(i=o.batchId,this.Ru(o),[3,6]);case 4:return s=t.sent(),[4,this.wu(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Pu()&&this.gu(),[2]}var e,n,r})})},Jh.prototype.Au=function(){return this.Ga()&&this.Ba.length<10},Jh.prototype.Vu=function(){return this.Ba.length},Jh.prototype.Ru=function(t){this.Ba.push(t),this.tu.na()&&this.tu.Ra&&this.tu.Pa(t.mutations)},Jh.prototype.Pu=function(){return this.Ga()&&!this.tu.ea()&&0<this.Ba.length},Jh.prototype.gu=function(){this.tu.start()},Jh.prototype.eu=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.tu.ya(),[2]})})},Jh.prototype.su=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Ba;e<n.length;e++)r=n[e],this.tu.Pa(r.mutations);return[2]})})},Jh.prototype.ga=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Ba.shift(),n=sa.from(e,i,o),[4,this.Eu(function(){return r.fu.yu(n)})];case 1:return t.sent(),[4,this.hu()];case 2:return t.sent(),[2]}})})},Jh.prototype.nu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.tu.Ra?[4,this.pu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Pu()&&this.gu(),[2]}})})},Jh.prototype.pu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Ri(n=i.code)&&n!==Jr.ABORTED?(e=this.Ba.shift(),this.tu.ia(),[4,this.Eu(function(){return r.fu.bu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.hu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Jh.prototype.za=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tu.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.iu()];case 2:return t.sent(),[2]}})})},Jh.prototype.vu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ei.pi(),Lr("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.au()];case 1:return t.sent(),this.Ha.set("Unknown"),[4,this.fu.vu(e)];case 2:return t.sent(),this.Wa.delete(3),[4,this.iu()];case 3:return t.sent(),[2]}})})},Jh.prototype.Su=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Wa.delete(2),[4,this.iu()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Wa.add(2),[4,this.au()]);case 3:t.sent(),this.Ha.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Jh);function Jh(t,e,n,r,i){var o,s,u,a,c,h,f,l,p=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=i,this.ja.Ka(function(t){n.ai(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(Lr("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ha=new Qh(n,r),this.Ya=(c=this.qa,h=n,f={wa:this.Ja.bind(this),ca:this.Xa.bind(this),Ea:this.Za.bind(this)},(l=c).ba(),new Kh(h,l.Jh,l.credentials,l.serializer,f)),this.tu=(o=this.qa,s=n,u={wa:this.eu.bind(this),ca:this.nu.bind(this),Va:this.su.bind(this),ga:this.ga.bind(this)},(a=o).ba(),new Yh(s,a.Jh,a.credentials,a.serializer,u))}function $h(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}function tf(t,e,n){var r=this;return(r=Fh.call(this)||this).credentials=t,r.Jh=e,r.serializer=n,r.pa=!1,r}function ef(t,e,n,r,i){var o=this;return(o=qh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Aa=!1,o}function nf(t,e,n,r,i){var o=this;return(o=jh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function rf(t,e,n,r,i,o){this.Is=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new Na(t,e)}function of(t,e){this.Gh=t,this.zh=e}function sf(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=Ph.Oh}function uf(t){var e=this;this.Qh=null,this.currentUser=Ph.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then(function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)},function(){}))}function af(){this.Lh=null}function cf(t,e){return"firestore_clients_"+t+"_"+e}function hf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function ff(t,e){return"firestore_targets_"+t+"_"+e}function lf(t){this.key=t}function pf(t){this.key=t}function df(t,e,n){this.query=t,this.targetId=e,this.view=n}function yf(t){this.key=t,this.qc=!1}var vf=(Of.Du=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new $r(r.error.code,r.error.message)),i?new Of(t,e,r.state,o):(xr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Of.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Of),gf=(xf.Du=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new $r(n.error.code,n.error.message)),r?new xf(t,n.state,i):(xr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},xf.prototype.Cu=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},xf),mf=(Lf.Du=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Yi,o=0;r&&o<n.activeTargetIds.length;++o)r=gi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Lf(t,i):(xr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Lf),wf=(Rf.Du=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Rf(e.clientId,e.onlineState):(xr("SharedClientState","Failed to parse online state: "+t),null)},Rf),bf=(kf.prototype.Nu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},kf.prototype.Fu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},kf.prototype.Cu=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},kf),Ef=(Df.ks=function(t){return!(!t||!t.localStorage)},Df.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.fu.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.ku&&(o=this.getItem(cf(this.persistenceKey,i)))&&(s=mf.Du(i,o))&&(this.Ou=this.Ou.st(s.clientId,s));for(this.ju(),(u=this.storage.getItem(this.Wu))&&(a=this.Ku(u))&&this.Gu(a),c=0,h=this.Mu;c<h.length;c++)f=h[c],this.xu(f);return this.Mu=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},Df.prototype.Ts=function(t){this.setItem(this.qu,JSON.stringify(t))},Df.prototype.zu=function(){return this.Hu(this.Ou)},Df.prototype.Yu=function(n){var r=!1;return this.Ou.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Df.prototype.Ju=function(t){this.Xu(t,"pending")},Df.prototype.Zu=function(t,e,n){this.Xu(t,e,n),this.tc(t)},Df.prototype.ec=function(t){var e,n,r="not-current";return this.Yu(t)&&(!(e=this.storage.getItem(ff(this.persistenceKey,t)))||(n=gf.Du(t,e))&&(r=n.state)),this.nc.Nu(t),this.ju(),r},Df.prototype.sc=function(t){this.nc.Fu(t),this.ju()},Df.prototype.ic=function(t){return this.nc.activeTargetIds.has(t)},Df.prototype.rc=function(t){this.removeItem(ff(this.persistenceKey,t))},Df.prototype.oc=function(t,e,n){this.hc(t,e,n)},Df.prototype.ac=function(t,e,n){var r=this;e.forEach(function(t){r.tc(t)}),this.currentUser=t,n.forEach(function(t){r.Ju(t)})},Df.prototype.uc=function(t){this.cc(t)},Df.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$u),this.removeItem(this.Lu),this.tr=!1)},Df.prototype.getItem=function(t){var e=this.storage.getItem(t);return Lr("SharedClientState","READ",t,e),e},Df.prototype.setItem=function(t,e){Lr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Df.prototype.removeItem=function(t){Lr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Df.prototype.xu=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Lr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Lu)return void xr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Is.gi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.Bu.test(u.key)){if(null==u.newValue)return e=this.lc(u.key),[2,this._c(e,null)];if(n=this.fc(u.key,u.newValue))return[2,this._c(n.clientId,n)]}else if(this.Uu.test(u.key)){if(null!==u.newValue&&(r=this.dc(u.key,u.newValue)))return[2,this.wc(r)]}else if(this.Qu.test(u.key)){if(null!==u.newValue&&(i=this.Tc(u.key,u.newValue)))return[2,this.Ec(i)]}else if(u.key===this.Wu){if(null!==u.newValue&&(o=this.Ku(u.newValue)))return[2,this.Gu(o)]}else u.key===this.qu&&(s=function(t){var e=pa.Es;if(null!=t)try{var n=JSON.parse(t);Vr("number"==typeof n),e=n}catch(t){xr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==pa.Es&&this.fs(s)}else this.Mu.push(u);return[2]})})})}},Object.defineProperty(Df.prototype,"nc",{get:function(){return this.Ou.get(this.ku)},enumerable:!1,configurable:!0}),Df.prototype.ju=function(){this.setItem(this.Lu,this.nc.Cu())},Df.prototype.Xu=function(t,e,n){var r=new vf(this.currentUser,t,e,n),i=hf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cu())},Df.prototype.tc=function(t){var e=hf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Df.prototype.cc=function(t){var e={clientId:this.ku,onlineState:t};this.storage.setItem(this.Wu,JSON.stringify(e))},Df.prototype.hc=function(t,e,n){var r=ff(this.persistenceKey,t),i=new gf(t,e,n);this.setItem(r,i.Cu())},Df.prototype.lc=function(t){var e=this.Bu.exec(t);return e?e[1]:null},Df.prototype.fc=function(t,e){var n=this.lc(t);return mf.Du(n,e)},Df.prototype.dc=function(t,e){var n=this.Uu.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return vf.Du(new Ph(i),r,e)},Df.prototype.Tc=function(t,e){var n=this.Qu.exec(t),r=Number(n[1]);return gf.Du(r,e)},Df.prototype.Ku=function(t){return wf.Du(t)},Df.prototype.wc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fu.Ic(e.batchId,e.state,e.error)]:(Lr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Df.prototype.Ec=function(t){return this.fu.mc(t.targetId,t.state,t.error)},Df.prototype._c=function(t,e){var n=this,r=e?this.Ou.st(t,e):this.Ou.remove(t),i=this.Hu(this.Ou),o=this.Hu(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fu.Ac(s,u).then(function(){n.Ou=r})},Df.prototype.Gu=function(t){this.Ou.get(t.clientId)&&this.Da(t.onlineState)},Df.prototype.Hu=function(t){var n=Yi;return t.forEach(function(t,e){n=n.Nt(e.activeTargetIds)}),n},Df),If=(Sf.prototype.Ju=function(t){},Sf.prototype.Zu=function(t,e,n){},Sf.prototype.ec=function(t){return this.Rc.Nu(t),this.Pc[t]||"not-current"},Sf.prototype.oc=function(t,e,n){this.Pc[t]=e},Sf.prototype.sc=function(t){this.Rc.Fu(t)},Sf.prototype.ic=function(t){return this.Rc.activeTargetIds.has(t)},Sf.prototype.rc=function(t){delete this.Pc[t]},Sf.prototype.zu=function(){return this.Rc.activeTargetIds},Sf.prototype.Yu=function(t){return this.Rc.activeTargetIds.has(t)},Sf.prototype.start=function(){return this.Rc=new bf,Promise.resolve()},Sf.prototype.ac=function(t,e,n){},Sf.prototype.uc=function(t){},Sf.prototype.th=function(){},Sf.prototype.Ts=function(t){},Sf),Tf=(Object.defineProperty(Af.prototype,"vc",{get:function(){return this.gc},enumerable:!1,configurable:!0}),Af.prototype.Sc=function(t,e){var u=this,a=e?e.Dc:new $i,c=e?e.bc:this.bc,h=e?e.qt:this.qt,f=c,l=!1,p=this.query.an()&&c.size===this.query.limit?c.last():null,d=this.query.un()&&c.size===this.query.limit?c.first():null;if(t.ht(function(t,e){var n=c.get(t),r=(r=e instanceof uu?e:null)&&(Su(u.query,r)?r:null),i=!!n&&u.qt.has(n.key),o=!!r&&(r.Ge||u.qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Cc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.pc(r,p)||d&&u.pc(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),this.query.an()||this.query.un())for(;f.size>this.query.limit;){var n=this.query.an()?f.last():f.first(),f=f.delete(n.key),h=h.delete(n.key);a.track({type:1,doc:n})}return{bc:f,Dc:a,Nc:l,qt:h}},Af.prototype.Cc=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},Af.prototype.Un=function(t,e,n){var o=this,r=this.bc;this.bc=t.bc,this.qt=t.qt;var i=t.Dc.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pc(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}}var r,i}),this.Fc(n);var s=e?this.kc():[],u=0===this.yc.size&&this.Yt?1:0,a=u!==this.Vc;return this.Vc=u,0!==i.length||a?{snapshot:new to(this.query,t.bc,r,i,t.qt,0==u,a,!1),$c:s}:{$c:s}},Af.prototype.xc=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bc:this.bc,Dc:new $i,qt:this.qt,Nc:!1},!1)):{$c:[]}},Af.prototype.Oc=function(t){return!this.gc.has(t)&&!!this.bc.has(t)&&!this.bc.get(t).Ge},Af.prototype.Fc=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.gc=e.gc.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.gc=e.gc.delete(t)}),this.Yt=t.Yt)},Af.prototype.kc=function(){var e=this;if(!this.Yt)return[];var n=this.yc;this.yc=Ki(),this.bc.forEach(function(t){e.Oc(t.key)&&(e.yc=e.yc.add(t.key))});var r=[];return n.forEach(function(t){e.yc.has(t)||r.push(new pf(t))}),this.yc.forEach(function(t){n.has(t)||r.push(new lf(t))}),r},Af.prototype.Mc=function(t){this.gc=t.gh,this.yc=Ki();var e=this.Sc(t.documents);return this.Un(e,!0)},Af.prototype.Lc=function(){return to.Qt(this.query,this.bc,this.qt,0===this.Vc)},Af),Nf=(Object.defineProperty(_f.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),_f.prototype.subscribe=function(t){this.Wc=t},_f.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.nl("listen()"),(r=this.jc.get(s))?(e=r.targetId,this.Uc.ec(e),n=r.view.Lc(),[3,4]):[3,1];case 1:return[4,Sh(this.La,bu(s))];case 2:return i=t.sent(),o=this.Uc.ec(i.targetId),e=i.targetId,[4,this.sl(s,e,"current"===o)];case 3:n=t.sent(),this.el&&this.Bc.listen(i),t.label=4;case 4:return[2,n]}})})},_f.prototype.sl=function(u,a,c){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,kh(this.La,u,!0)];case 1:return e=t.sent(),n=new Tf(u,e.gh),r=n.Sc(e.documents),i=no.Ht(a,c&&"Offline"!==this.onlineState),o=n.Un(r,this.el,i),this.il(a,o.$c),s=new df(u,a,n),[2,(this.jc.set(u,s),this.Kc.has(a)?this.Kc.get(a).push(u):this.Kc.set(a,[u]),o.snapshot)]}})})},_f.prototype.lu=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.nl("unlisten()"),e=this.jc.get(i),1<(n=this.Kc.get(e.targetId)).length?[2,(this.Kc.set(e.targetId,n.filter(function(t){return!Nu(t,i)})),void this.jc.delete(i))]:this.el?(this.Uc.sc(e.targetId),this.Uc.Yu(e.targetId)?[3,2]:[4,Dh(this.La,e.targetId,!1).then(function(){r.Uc.rc(e.targetId),r.Bc.lu(e.targetId),r.rl(e.targetId)}).catch(Lh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,Dh(this.La,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},_f.prototype.write=function(s,u){return g(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:this.nl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.La,c=s,f=e,l=ti.now(),n=c.reduce(function(t,e){return t.add(e.key)},Ki()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Zn(a,n).next(function(t){h=t;for(var u,e,n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=(u=o,e=h.get(o.key),u instanceof zs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof uu?t.field(i.field):void 0,s=us(i.transform,o||null);null!=s&&(e=null==e?(new Js).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Fs(o.key,s,function u(t){var a=[];return Wr(t.fields||{},function(t,e){var n=new oi([t]);if(xo(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Ns(a)}(s.proto.mapValue),Ds.exists(!0)))}return f.Gn.mr(a,l,n,c)})}).then(function(t){var e=t.An(h);return{batchId:t.batchId,Fn:e}}))];case 2:return r=t.sent(),this.Uc.Ju(r.batchId),this.ol(r.batchId,u),[4,this.hl(r.Fn)];case 3:return t.sent(),[4,this.Bc.hu()];case 4:return t.sent(),[3,6];case 5:return i=t.sent(),o=Wa(i,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,c,h,f,l,n})})},_f.prototype.Iu=function(n){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:this.nl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ah(this.La,n)];case 2:return e=t.sent(),n.Wt.forEach(function(t,e){var n=r.Hc.get(e);n&&(Vr(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.qc=!0:0<t.Xt.size?Vr(n.qc):0<t.Zt.size&&(Vr(n.qc),n.qc=!1))}),[4,this.hl(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Lh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},_f.prototype.xc=function(r,t){var i;(this.el&&0===t||!this.el&&1===t)&&(this.nl("applyOnlineStateChange()"),i=[],this.jc.forEach(function(t,e){var n=e.view.xc(r);n.snapshot&&i.push(n.snapshot)}),this.Wc.al(r),this.Wc.Ea(i),this.onlineState=r,this.el&&this.Uc.uc(r))},_f.prototype.mu=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.nl("rejectListens()"),this.Uc.oc(u,"rejected",a),e=this.Hc.get(u),(n=e&&e.key)?(r=(r=new xi(si.P)).st(n,new au(n,ei.min())),i=Ki().add(n),o=new eo(ei.min(),new Map,new Fi(Fr),r,i),[4,this.Iu(o)]):[3,2];case 1:return t.sent(),this.zc=this.zc.remove(n),this.Hc.delete(u),this.ul(),[3,4];case 2:return[4,Dh(this.La,u,!1).then(function(){return s.rl(u,a)}).catch(Lh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},_f.prototype.yu=function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:this.nl("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Nh(this.La,r)];case 2:return n=t.sent(),this.cl(e,null),this.ll(e),this.Uc.Zu(e,"acknowledged"),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Lh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},_f.prototype.bu=function(o,s){return g(this,void 0,void 0,function(){var n;return w(this,function(t){switch(t.label){case 0:this.nl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,r=o,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Gn.Rr(e,r).next(function(t){return Vr(null!==t),n=t.keys(),i.Gn.br(e,t)}).next(function(){return i.Gn.Cr(e)}).next(function(){return i.Rh.Zn(e,n)})}))];case 2:return n=t.sent(),this.cl(o,s),this.ll(o),this.Uc.Zu(o,"rejected",s),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,Lh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})},_f.prototype._l=function(u){return g(this,void 0,void 0,function(){var r,i,o,s;return w(this,function(t){switch(t.label){case 0:this.Bc.Ga()||Lr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.La,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.Gn.Vr(t)}))];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=this.Xc.get(r)||[]).push(u),this.Xc.set(r,i),[3,4]);case 3:return o=t.sent(),s=Wa(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},_f.prototype.ll=function(t){(this.Xc.get(t)||[]).forEach(function(t){t.resolve()}),this.Xc.delete(t)},_f.prototype.fl=function(e){this.Xc.forEach(function(t){t.forEach(function(t){t.reject(new $r(Jr.CANCELLED,e))})}),this.Xc.clear()},_f.prototype.ol=function(t,e){var n=this.Jc[this.currentUser.$h()];n=(n=n||new xi(Fr)).st(t,e),this.Jc[this.currentUser.$h()]=n},_f.prototype.cl=function(t,e){var n,r=this.Jc[this.currentUser.$h()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Jc[this.currentUser.$h()]=r)},_f.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uc.sc(t);for(var r=0,i=this.Kc.get(t);r<i.length;r++){var o=i[r];this.jc.delete(o),e&&this.Wc.dl(o,e)}this.Kc.delete(t),this.el&&this.Yc.Ch(t).forEach(function(t){n.Yc.Nr(t)||n.wl(t)})},_f.prototype.wl=function(t){var e=this.zc.get(t);null!==e&&(this.Bc.lu(e),this.zc=this.zc.remove(t),this.Hc.delete(e),this.ul())},_f.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof lf?(this.Yc.Eo(i.key,t),this.Tl(i)):i instanceof pf?(Lr("SyncEngine","Document no longer in limbo: "+i.key),this.Yc.mo(i.key,t),this.Yc.Nr(i.key)||this.wl(i.key)):Cr()}},_f.prototype.Tl=function(t){var e=t.key;this.zc.get(e)||(Lr("SyncEngine","New document in limbo: "+e),this.Gc.push(e),this.ul())},_f.prototype.ul=function(){for(;0<this.Gc.length&&this.zc.size<this.Qc;){var t=this.Gc.shift(),e=this.Zc.next();this.Hc.set(e,new yf(t)),this.zc=this.zc.st(t,e),this.Bc.listen(new Di(bu(gu(t.path)),e,2,pa.Es))}},_f.prototype.El=function(){return this.zc},_f.prototype.Il=function(){return this.Gc},_f.prototype.hl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.jc.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Sc(r);return n.Nc?kh(u.La,i.query,!1).then(function(t){var e=t.documents;return i.view.Sc(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.Un(t,u.el,n);u.il(i.targetId,r.$c),r.snapshot&&(u.el&&u.Uc.oc(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=la._s(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Wc.Ea(o),[4,function(h,f){return g(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:r=h,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ua.forEach(f,function(e){return ua.forEach(e.cs,function(t){return r.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return ua.forEach(e.ls,function(t){return r.persistence.dr.mo(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!xa(e=t.sent()))throw e;return Lr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Eh.get(s),a=u.Z,c=u.nt(a),r.Eh=r.Eh.st(s,c));return[2]}})})}(this.La,s)];case 2:return t.sent(),[2]}})})},_f.prototype.nl=function(t){},_f.prototype.vu=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Lr("SyncEngine","User change. New user:",n.$h()),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).Gn,m=e.Rh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Gn.yr(v).next(function(t){return g=t,n=e.persistence.oh(o),m=new fa(e.Ah,n,e.persistence.uh()),n.yr(v)}).next(function(t){for(var e=[],n=[],r=Ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zn(v,r).next(function(t){return{ml:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.Gn=n,e.Rh=m,e.Th.Ph(e.Rh),r)]}})})}(this.La,n)]);case 1:return e=t.sent(),this.currentUser=n,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uc.ac(n,e.Al,e.Rl),[4,this.hl(e.ml)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},_f.prototype.Oe=function(t){var e=this.Hc.get(t);if(e&&e.qc)return Ki().add(e.key);var n=Ki(),r=this.Kc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.jc.get(s),n=n.Nt(u.view.vc);return n},_f);function _f(t,e,n,r,i,o){this.La=t,this.Bc=e,this.qa=n,this.Uc=r,this.currentUser=i,this.Qc=o,this.Wc=null,this.jc=new Zr(_u,Nu),this.Kc=new Map,this.Gc=[],this.zc=new xi(si.P),this.Hc=new Map,this.Yc=new xh,this.Jc={},this.Xc=new Map,this.Zc=rh.eo(),this.onlineState="Unknown",this.tl=void 0}function Af(t,e){this.query=t,this.gc=e,this.Vc=null,this.Yt=!1,this.yc=Ki(),this.qt=Ki(),this.pc=Du(t),this.bc=new Ji(this.pc)}function Sf(){this.Rc=new bf,this.Pc={},this.Da=null,this.fs=null}function Df(t,e,n,r,i){this.window=t,this.Is=e,this.persistenceKey=n,this.ku=r,this.fu=null,this.Da=null,this.fs=null,this.$u=this.xu.bind(this),this.Ou=new xi(Fr),this.tr=!1,this.Mu=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lu=cf(this.persistenceKey,this.ku),this.qu="firestore_sequence_number_"+this.persistenceKey,this.Ou=this.Ou.st(this.ku,new bf),this.Bu=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uu=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qu=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wu="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.$u)}function kf(){this.activeTargetIds=Yi}function Rf(t,e){this.clientId=t,this.onlineState=e}function Lf(t,e){this.clientId=t,this.activeTargetIds=e}function xf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Of(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Pf(u,a,c,h){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).nl("applyBatchState()"),[4,(e=o.La,n=a,i=(r=e).Gn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Zn(e,t):ua.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,o.Bc.hu()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(o.cl(a,h||null),o.La.Gn.Sr(a)):Cr(),t.label=4;case 4:return[4,o.hl(s)];case 5:return t.sent(),[3,7];case 6:Lr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function Cf(h,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return r=h,!0!==f||!0===r.tl?[3,3]:(e=r.Uc.zu(),[4,Vf(r,e.N())]);case 1:return i=t.sent(),r.tl=!0,[4,r.Bc.Su(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Bc.listen(u);return[3,7];case 3:return!1!==f||!1===r.tl?[3,7]:(a=[],c=Promise.resolve(),r.Kc.forEach(function(t,e){r.Uc.ic(e)?a.push(e):c=c.then(function(){return r.rl(e),Dh(r.La,e,!0)}),r.Bc.lu(e)}),[4,c]);case 4:return t.sent(),[4,Vf(r,a)];case 5:return t.sent(),(n=r).Hc.forEach(function(t,e){n.Bc.lu(e)}),n.Yc.Nh(),n.Hc=new Map,n.zc=new xi(si.P),r.tl=!1,[4,r.Bc.Su(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Vf(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Kc.get(s))&&0!==a.length?[4,Sh(e.La,bu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.jc.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,kh((e=i).La,o.query,!0)];case 1:return n=t.sent(),r=o.view.Mc(n),[2,(e.el&&e.il(o.targetId,r.$c),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Rh(e.La,s)];case 8:return d=t.sent(),[4,Sh(e.La,d)];case 9:return u=t.sent(),[4,e.sl(Uf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Wc.Ea(r),n)]}})})}function Uf(t){return vu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Mf(s,u,a,c){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).tl?(Lr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Kc.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.La,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.mh)}).then(function(t){var e=t.Qr,n=t.readTime;return r.mh=n,e}))];case 3:return i=t.sent(),o=eo.zt(u,"current"===a),[4,n.hl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,Dh(n.La,u,!0)];case 6:return t.sent(),n.rl(u,c),[3,8];case 7:Cr(),t.label=8;case 8:return[2]}var r,e})})}function Ff(){this.Pl=void 0,this.listeners=[]}var qf,jf=(Qf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.gl.get(e))||(n=!0,r=new Ff),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.fu.listen(e)];case 2:return i.Pl=t.sent(),[3,4];case 3:return o=t.sent(),s=Wa(o,"Initialization of query '"+Au(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.gl.set(e,r),r.listeners.push(u),u.xc(this.onlineState),r.Pl&&u.yl(r.Pl)&&this.pl(),[2]}})})},Qf.prototype.lu=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.gl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.gl.delete(e),this.fu.lu(e))]:[2]})})},Qf.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},Qf.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},Qf.prototype.al=function(i){this.onlineState=i;var o=!1;this.gl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xc(i)&&(o=!0)}),o&&this.pl()},Qf.prototype.bl=function(t){this.Vl.add(t),t.next()},Qf.prototype.vl=function(t){this.Vl.delete(t)},Qf.prototype.pl=function(){this.Vl.forEach(function(t){t.next()})},Qf),Gf=(Xf.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new to(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},Xf.prototype.onError=function(t){this.Sl.error(t)},Xf.prototype.xc=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},Xf.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},Xf.prototype.Nl=function(t){if(0<t.docChanges.length)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},Xf.prototype.kl=function(t){t=to.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},Xf),Bf=(Yf.prototype.Ph=function(t){this.xl=t},Yf.prototype.ns=function(e,r,i,o){var s=this;return r.hn()||i.isEqual(ei.min())?this.Ol(e,r):this.xl.Zn(e,o).next(function(t){var n=s.Ml(r,t);return(r.an()||r.un())&&s.Nc(r.nn,n,o,i)?s.Ol(e,r):(Rr()<=l.DEBUG&&Lr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(r)),s.xl.ns(e,r,i).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},Yf.prototype.Ml=function(n,t){var r=new Fi(Du(n));return t.forEach(function(t,e){e instanceof uu&&Su(n,e)&&(r=r.add(e))}),r},Yf.prototype.Nc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Yf.prototype.Ol=function(t,e){return Rr()<=l.DEBUG&&Lr("IndexFreeQueryEngine","Using full collection scan to execute query:",Au(e)),this.xl.ns(t,e,ei.min())},Yf),zf=(Kf.prototype.Ir=function(t){return ua.resolve(0===this.Gn.length)},Kf.prototype.mr=function(t,e,n,r){var i=this.Ll;this.Ll++,0<this.Gn.length&&this.Gn[this.Gn.length-1];var o=new oa(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new Oh(a.key,i)),this.zn.Ar(t,a.key.path.p())}return ua.resolve(o)},Kf.prototype.Rr=function(t,e){return ua.resolve(this.Bl(e))},Kf.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return ua.resolve(this.Gn.length>i?this.Gn[i]:null)},Kf.prototype.Vr=function(){return ua.resolve(0===this.Gn.length?-1:this.Ll-1)},Kf.prototype.yr=function(t){return ua.resolve(this.Gn.slice())},Kf.prototype.Yn=function(t,e){var n=this,r=new Oh(e,0),i=new Oh(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],function(t){var e=n.Bl(t.kh);o.push(e)}),ua.resolve(o)},Kf.prototype.es=function(t,e){var r=this,i=new Fi(Fr);return e.forEach(function(t){var e=new Oh(t,0),n=new Oh(t,Number.POSITIVE_INFINITY);r.ql.St([e,n],function(t){i=i.add(t.kh)})}),ua.resolve(this.Ql(i))},Kf.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;si.j(i)||(i=i.child(""));var o=new Oh(new si(i),0),s=new Fi(Fr);return this.ql.Dt(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)},o),ua.resolve(this.Ql(s))},Kf.prototype.Ql=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Bl(t);null!==e&&r.push(e)}),r},Kf.prototype.br=function(n,r){var i=this;Vr(0===this.Wl(r.batchId,"removed")),this.Gn.shift();var o=this.ql;return ua.forEach(r.mutations,function(t){var e=new Oh(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.ql=o})},Kf.prototype.Sr=function(t){},Kf.prototype.Nr=function(t,e){var n=new Oh(e,0),r=this.ql.Ct(n);return ua.resolve(e.isEqual(r&&r.key))},Kf.prototype.Cr=function(t){return this.Gn.length,ua.resolve()},Kf.prototype.Wl=function(t,e){return this.Ul(t)},Kf.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},Kf.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},Kf),Hf=(Wf.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},Wf.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Wf.prototype.Ln=function(t,e){var n=this.docs.get(e);return ua.resolve(n?n.Or:null)},Wf.prototype.getEntries=function(t,e){var n=this,r=ji;return e.forEach(function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)}),ua.resolve(r)},Wf.prototype.ns=function(t,e,n){for(var r=zi,i=new si(e.path.child("")),o=this.docs.ct(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,c=a.Or,h=a.readTime;if(!e.path.D(u.path))break;h.o(n)<=0||c instanceof uu&&Su(e,c)&&(r=r.st(c.key,c))}return ua.resolve(r)},Wf.prototype.Kl=function(t,e){return ua.forEach(this.docs,function(t){return e(t)})},Wf.prototype.jr=function(t){return new Wf.Kr(this)},Wf.prototype.zr=function(t){return ua.resolve(this.size)},Wf);function Wf(t,e){this.zn=t,this.jl=e,this.docs=new xi(si.P),this.size=0}function Kf(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new Fi(Oh.yh)}function Yf(){}function Xf(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}function Qf(t){this.fu=t,this.gl=new Zr(_u,Nu),this.onlineState="Unknown",this.Vl=new Set,this.fu.subscribe(this)}function Zf(t){var e=this;return(e=qf.call(this)||this).Hr=t,e}Hf.Kr=(o(Zf,qf=aa),Zf.prototype.Un=function(n){var r=this,i=[];return this.Fn.forEach(function(t,e){e?i.push(r.Hr.xn(n,e,r.readTime)):r.Hr.Mn(t)}),ua.Cn(i)},Zf.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},Zf.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},Zf);var Jf,$f,tl=(gl.prototype.be=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),ua.resolve()},gl.prototype.ro=function(t){return ua.resolve(this.lastRemoteSnapshotVersion)},gl.prototype.oo=function(t){return ua.resolve(this.zl)},gl.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),ua.resolve(this.highestTargetId)},gl.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),ua.resolve()},gl.prototype.uo=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new rh(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},gl.prototype.ao=function(t,e){return this.uo(e),this.targetCount+=1,ua.resolve()},gl.prototype.lo=function(t,e){return this.uo(e),ua.resolve()},gl.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),--this.targetCount,ua.resolve()},gl.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gl.delete(t),u.push(o.fo(n,e.targetId)),s++)}),ua.Cn(u).next(function(){return s})},gl.prototype.do=function(t){return ua.resolve(this.targetCount)},gl.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return ua.resolve(n)},gl.prototype.To=function(t,e,n){return this.Hl.vh(e,n),ua.resolve()},gl.prototype.Io=function(e,t,n){this.Hl.Dh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),ua.Cn(i)},gl.prototype.fo=function(t,e){return this.Hl.Ch(e),ua.resolve()},gl.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return ua.resolve(n)},gl.prototype.Nr=function(t,e){return ua.resolve(this.Hl.Nr(e))},gl),el=(vl.prototype.start=function(){return Promise.resolve()},vl.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(vl.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),vl.prototype.Bo=function(){},vl.prototype.Uo=function(){},vl.prototype.uh=function(){return this.zn},vl.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new zf(this.zn,this.dr),this.Jl[t.$h()]=e),e},vl.prototype.hh=function(){return this.ko},vl.prototype.ah=function(){return this.Kn},vl.prototype.runTransaction=function(t,e,n){var r=this;Lr("MemoryPersistence","Starting transaction:",t);var i=new nl(this.yo.next());return this.dr.Zl(),n(i).next(function(t){return r.dr.t_(i).next(function(){return t})}).Sn().then(function(t){return i.jn(),t})},vl.prototype.e_=function(e,n){return ua.Nn(Object.values(this.Jl).map(function(t){return function(){return t.Nr(e,n)}}))},vl),nl=(o(yl,$f=ha),yl),rl=(dl.i_=function(t){return new dl(t)},Object.defineProperty(dl.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw Cr()},enumerable:!1,configurable:!0}),dl.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),ua.resolve()},dl.prototype.mo=function(t,e,n){return this.n_.mo(n,e),this.r_.add(n.toString()),ua.resolve()},dl.prototype.Dr=function(t,e){return this.r_.add(e.toString()),ua.resolve()},dl.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach(function(t){return n.r_.add(t.toString())});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.r_.add(t.toString())})}).next(function(){return r._o(t,e)})},dl.prototype.Zl=function(){this.s_=new Set},dl.prototype.t_=function(n){var r=this,i=this.persistence.ah().jr();return ua.forEach(this.r_,function(t){var e=si.B(t);return r.o_(n,e).next(function(t){t||i.Mn(e)})}).next(function(){return r.s_=null,i.apply(n)})},dl.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next(function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())})},dl.prototype.Xl=function(t){return 0},dl.prototype.o_=function(t,e){var n=this;return ua.Nn([function(){return ua.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},dl),il=(pl.prototype.wa=function(t){this.u_=t},pl.prototype.ca=function(t){this.c_=t},pl.prototype.onMessage=function(t){this.l_=t},pl.prototype.close=function(){this.a_()},pl.prototype.send=function(t){this.h_(t)},pl.prototype.__=function(){this.u_()},pl.prototype.f_=function(t){this.c_(t)},pl.prototype.d_=function(t){this.l_(t)},pl),ol={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},sl=(ll.prototype.va=function(e,t,n,r){var i=this.I_(e,t);Lr("RestConnection","Sending: ",i,n);var o={};return this.m_(o,r),this.A_(e,i,o,n).then(function(t){return Lr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},ll.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},ll.prototype.m_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.1",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},ll.prototype.I_=function(t,e){var n=ol[t];return this.T_+"/v1/"+e+":"+n},o(fl,Jf=ll),fl.prototype.A_=function(a,e,n,r){return new Promise(function(o,s){var u=new Ar;u.listenOnce(Nr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Tr.NO_ERROR:var t=u.getResponseJson();Lr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Tr.TIMEOUT:Lr("Connection",'RPC "'+a+'" timed out'),s(new $r(Jr.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:var e,n,r=u.getStatus();Lr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Jr).indexOf(i)?i:Jr.UNKNOWN,s(new $r(n,e.message))):s(new $r(Jr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new $r(Jr.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{Lr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},fl.prototype.Ta=function(t,e){var n,r,i=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.m_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(r=y()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Lr("Connection","Creating WebChannel: "+u,s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new il({h_:function(t){f?Lr("Connection","Not sending because WebChannel is closed:",t):(h||(Lr("Connection","Opening WebChannel transport."),c.open(),h=!0),Lr("Connection","WebChannel sending:",t),c.send(t))},a_:function(){return c.close()}});return a(_r.EventType.OPEN,function(){f||Lr("Connection","WebChannel transport opened.")}),a(_r.EventType.CLOSE,function(){f||(f=!0,Lr("Connection","WebChannel transport closed"),l.f_())}),a(_r.EventType.ERROR,function(t){f||(f=!0,Or("Connection","WebChannel transport errored:",t),l.f_(new $r(Jr.UNAVAILABLE,"The operation could not be completed")))}),a(_r.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Vr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Lr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ai[i];if(void 0!==t)return Li(t)}(),s=r.message,void 0===o&&(o=Jr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.f_(new $r(o,s)),c.close()):(Lr("Connection","WebChannel received:",n),l.d_(n)))}),setTimeout(function(){l.__()},0),l},fl),ul=(hl.prototype.Ka=function(t){this.y_.push(t)},hl.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},hl.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},hl.prototype.P_=function(){Lr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},hl.prototype.V_=function(){Lr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},hl.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},hl),al=(cl.prototype.Ka=function(t){},cl.prototype.th=function(){},cl);function cl(){}function hl(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}function fl(t){var e=this;return(e=Jf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function ll(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function pl(t){this.h_=t.h_,this.a_=t.a_}function dl(t){this.persistence=t,this.n_=new xh,this.s_=null}function yl(t){var e=this;return(e=$f.call(this)||this).Ro=t,e}function vl(t){var e=this;this.Jl={},this.yo=new pa(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new tl(this),this.zn=new Lc,this.Kn=new Hf(this.zn,function(t){return e.dr.Xl(t)})}function gl(t){this.persistence=t,this.Gl=new Zr(bi,Ei),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.zl=0,this.Hl=new xh,this.targetCount=0,this.Yl=rh.to()}function ml(t){return new Co(t,!0)}var wl,bl,El="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Il=(Dl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uc=this.b_(e),this.persistence=this.v_(e),[4,this.persistence.start()];case 1:return t.sent(),this.S_=this.D_(e),this.La=this.C_(e),[2]}})})},Dl.prototype.D_=function(t){return null},Dl.prototype.C_=function(t){return e=this.persistence,n=new Bf,r=t.N_,new Ih(e,n,r);var e,n,r},Dl.prototype.v_=function(t){if(t.k_.F_)throw new $r(Jr.FAILED_PRECONDITION,El);return new el(rl.i_)},Dl.prototype.b_=function(t){return new If},Dl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uc.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},Dl.prototype.clearPersistence=function(t,e){throw new $r(Jr.FAILED_PRECONDITION,El)},Dl),Tl=(o(Sl,bl=Il),Sl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,bl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.mh=t})]})})}(this.La)];case 2:return t.sent(),[2]}})})},Sl.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new $a(e,t.ei)},Sl.prototype.v_=function(t){var e=Eh(t.w_.s,t.w_.persistenceKey),n=ml(t.w_.s);return new ph(t.k_.synchronizeTabs,e,t.clientId,Qa.Ui(t.k_.cacheSizeBytes),t.ei,qa(),ja(),n,this.Uc,t.k_.Vo)},Sl.prototype.b_=function(t){return new If},Sl.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return _a.ks()?(e=n+"main",[4,_a.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Eh(t,e))},o(Al,wl=Sl),Al.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,wl.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.x_.initialize(this,r)];case 2:return t.sent(),e=this.x_.fu,this.Uc instanceof Ef?(this.Uc.fu={Ic:Pf.bind(null,e),mc:Mf.bind(null,e),Ac:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=f).tl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Kc.has(i)?(Lr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Rh(n.La,i)]):[3,6];case 2:return o=t.sent(),[4,Sh(n.La,o)];case 3:return s=t.sent(),[4,n.sl(Uf(o),s.targetId,!1)];case 4:t.sent(),n.Bc.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Kc.has(e)?[4,Dh(n.La,e,!1).then(function(){n.Bc.lu(e),n.rl(e)}).catch(Lh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.La.persistence.rh()}.bind(null,e)},[4,this.Uc.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Cf(this.x_.fu,e)];case 1:return t.sent(),this.S_&&(e&&!this.S_.tr?this.S_.start(this.La):e||this.S_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},Al.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=qa();if(!Ef.ks(e))throw new $r(Jr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Eh(t.w_.s,t.w_.persistenceKey);return new Ef(e,t.ei,n,t.clientId,t.N_)}return new If},Al),Nl=(_l.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.La?[3,3]:(this.La=n.La,this.Uc=n.Uc,this.qa=this.O_(r),this.Bc=this.M_(r),this.fu=this.L_(r),this.q_=this.B_(r),this.Uc.Da=function(t){return e.fu.xc(t,1)},this.Bc.fu=this.fu,[4,this.Bc.start()]);case 1:return t.sent(),[4,this.Bc.Su(this.fu.el)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},_l.prototype.B_=function(t){return new jf(this.fu)},_l.prototype.O_=function(t){var e,n,r=ml(t.w_.s),i=(e=t.w_,new sl(e));return n=t.credentials,new Xh(n,i,r)},_l.prototype.M_=function(t){var e=this;return new Zh(this.La,this.qa,t.ei,function(t){return e.fu.xc(t,0)},new(ul.ks()?ul:al))},_l.prototype.L_=function(t){return e=this.La,n=this.Bc,r=this.qa,i=this.Uc,o=t.N_,s=t.Qc,u=!t.k_.F_||!t.k_.synchronizeTabs,a=new Nf(e,n,r,i,o,s),u&&(a.tl=!0),a;var e,n,r,i,o,s,u,a},_l.prototype.terminate=function(){return this.Bc.th()},_l);function _l(){}function Al(t){var e=this;return(e=wl.call(this)||this).x_=t,e}function Sl(){return null!==bl&&bl.apply(this,arguments)||this}function Dl(){}function kl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Rl=(Ll.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},Ll.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Ll.prototype.Q_=function(){this.muted=!0},Ll.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ll);function Ll(t){this.observer=t,this.muted=!1}function xl(t,e){if(0!==e.length)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ql(e.length,"argument")+".")}function Ol(t,e,n){if(e.length!==n)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires "+Ql(n,"argument")+", but was called with "+Ql(e.length,"argument")+".")}function Pl(t,e,n){if(e.length<n)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ql(n,"argument")+", but was called with "+Ql(e.length,"argument")+".")}function Cl(t,e,n,r){if(e.length<n||e.length>r)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Ql(e.length,"argument")+".")}function Vl(t,e,n,r){Gl(t,e,Xl(n)+" argument",r)}function Ul(t,e,n,r){void 0!==r&&Vl(t,e,n,r)}function Ml(t,e,n,r){Gl(t,e,n+" option",r)}function Fl(t,e,n,r){void 0!==r&&Ml(t,e,n,r)}function ql(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(zl(s))}var u=zl(n);throw new $r(Jr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function jl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new $r(Jr.INVALID_ARGUMENT,"Invalid value "+zl(r)+" provided to function "+t+"() for its "+Xl(n)+" argument. Acceptable values: "+e.join(", "));return r}function Gl(t,e,n,r){if(!("object"===e?Bl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=zl(r);throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Bl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function zl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Cr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Hl(t,e,n){if(void 0===n)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Xl(e)+" argument, but it was undefined.")}function Wl(n,t,r){Wr(t,function(t,e){if(r.indexOf(t)<0)throw new $r(Jr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Kl(t,e,n,r){var i=zl(r);return new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Xl(n)+" argument to be a "+e+", but it was: "+i)}function Yl(t,e,n){if(n<=0)throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Xl(e)+" argument to be a positive number, but it was: "+n+".")}function Xl(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ql(t,e){return t+" "+e+(1===t?"":"s")}function Zl(){if("undefined"==typeof Uint8Array)throw new $r(Jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Jl(){if("undefined"==typeof atob)throw new $r(Jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var $l,tp,ep=(cp.fromBase64String=function(t){Ol("Blob.fromBase64String",arguments,1),Vl("Blob.fromBase64String","string",1,t),Jl();try{return new cp(Ti.fromBase64String(t))}catch(t){throw new $r(Jr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},cp.fromUint8Array=function(t){if(Ol("Blob.fromUint8Array",arguments,1),Zl(),!(t instanceof Uint8Array))throw Kl("Blob.fromUint8Array","Uint8Array",1,t);return new cp(Ti.fromUint8Array(t))},cp.prototype.toBase64=function(){return Ol("Blob.toBase64",arguments,0),Jl(),this.W_.toBase64()},cp.prototype.toUint8Array=function(){return Ol("Blob.toUint8Array",arguments,0),Zl(),this.W_.toUint8Array()},cp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},cp.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},cp),np=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new $r(Jr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Vl("FieldPath","string",e,t[e]),0===t[e].length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new oi(t)},rp=(o(ap,tp=np),ap.documentId=function(){return new ap(oi.L().F())},ap.prototype.isEqual=function(t){if(!(t instanceof ap))throw Kl("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},ap),ip=new RegExp("[~\\*/\\[\\]]"),op=function(){this.K_=this},sp=(o(up,$l=op),up.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},up.prototype.isEqual=function(t){return t instanceof up},up);function up(t){var e=this;return(e=$l.call(this)||this).G_=t,e}function ap(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return tp.call(this,t)||this}function cp(t){Jl(),this.W_=t}function hp(t,e,n){return new Mp({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var fp,lp,pp,dp,yp,vp,gp=(o(Vp,vp=op),Vp.prototype.z_=function(t){return new _s(t.path,new hs)},Vp.prototype.isEqual=function(t){return t instanceof Vp},Vp),mp=(o(Cp,yp=op),Cp.prototype.z_=function(t){var e=hp(this,t,!0),n=this.Z_.map(function(t){return Wp(t,e)}),r=new fs(n);return new _s(t.path,r)},Cp.prototype.isEqual=function(t){return this===t},Cp),wp=(o(Pp,dp=op),Pp.prototype.z_=function(t){var e=hp(this,t,!0),n=this.Z_.map(function(t){return Wp(t,e)}),r=new vs(n);return new _s(t.path,r)},Pp.prototype.isEqual=function(t){return this===t},Pp),bp=(o(Op,pp=op),Op.prototype.z_=function(t){var e=new bs(t.serializer,Mo(t.serializer,this.tf));return new _s(t.path,e)},Op.prototype.isEqual=function(t){return this===t},Op),Ep=(o(xp,lp=op),xp.delete=function(){return xl("FieldValue.delete",arguments),new Ip(new sp("FieldValue.delete"))},xp.serverTimestamp=function(){return xl("FieldValue.serverTimestamp",arguments),new Ip(new gp("FieldValue.serverTimestamp"))},xp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Pl("FieldValue.arrayUnion",arguments,1),new Ip(new mp("FieldValue.arrayUnion",t))},xp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Pl("FieldValue.arrayRemove",arguments,1),new Ip(new wp("FieldValue.arrayRemove",t))},xp.increment=function(t){return Vl("FieldValue.increment","number",1,t),Ol("FieldValue.increment",arguments,1),new Ip(new bp("FieldValue.increment",t))},xp),Ip=(o(Lp,fp=Ep),Lp.prototype.z_=function(t){return this.K_.z_(t)},Lp.prototype.isEqual=function(t){return t instanceof Lp&&this.K_.isEqual(t.K_)},Lp),Tp=(Object.defineProperty(Rp.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),Rp.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},Rp.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},Rp.prototype.T=function(t){return Fr(this.ef,t.ef)||Fr(this.nf,t.nf)},Rp),Np=/^__.*__$/,_p=function(t,e,n){this.sf=t,this.if=e,this.rf=n},Ap=(kp.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new Fs(t,this.data,this.qe,e)):n.push(new Ms(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new zs(t,this.fieldTransforms)),n},kp),Sp=(Dp.prototype.hf=function(t,e){var n=[new Fs(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new zs(t,this.fieldTransforms)),n},Dp);function Dp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function kp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Rp(t,e){if(Ol("GeoPoint",arguments,2),Vl("GeoPoint","number",1,t),Vl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new $r(Jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new $r(Jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}function Lp(t){var e=this;return(e=fp.call(this)||this).K_=t,e.G_=t.G_,e}function xp(){return lp.call(this)||this}function Op(t,e){var n=this;return(n=pp.call(this)||this).G_=t,n.tf=e,n}function Pp(t,e){var n=this;return(n=dp.call(this)||this).G_=t,n.Z_=e,n}function Cp(t,e){var n=this;return(n=yp.call(this)||this).G_=t,n.Z_=e,n}function Vp(t){var e=this;return(e=vp.call(this)||this).G_=t,e}function Up(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Cr()}}var Mp=(Object.defineProperty(jp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(jp.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),jp.prototype.uf=function(t){return new jp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},jp.prototype.cf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.lf(t),r},jp.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.uf({path:n,X_:!1});return r.af(),r},jp.prototype.ff=function(t){return this.uf({path:void 0,X_:!0})},jp.prototype.Y_=function(t){return Jp(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},jp.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},jp.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},jp.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(Up(this.H_)&&Np.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},jp),Fp=(qp.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new Mp({H_:t,methodName:e,J_:n,path:oi.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},qp);function qp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||ml(t)}function jp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}function Gp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);Xp("Data must be an object, but it was:",s,r);var u,a,c=Kp(r,s);if(o.merge)u=new Ns(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof np)d=p.j_;else{if("string"!=typeof p)throw Cr();d=Zp(e,p,n)}if(!s.contains(d))throw new $r(Jr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");$p(h,d)||h.push(d)}u=new Ns(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new Ap(new Zs(c),u,a)}function Bp(t,o,s,e){var u=t.wf(1,o,s);Xp("Data must be an object, but it was:",u,e);var a=[],c=new Js;Wr(e,function(t,e){var n,r=Zp(o,t,s),i=u._f(r);e instanceof op&&e.K_ instanceof sp?a.push(r):null!=(n=Wp(e,i))&&(a.push(r),c.set(r,n))});var n=new Ns(a);return new Sp(c.ze(),n,u.fieldTransforms)}function zp(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[Qp(e,r,n)],a=[i];if(o.length%2!=0)throw new $r(Jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Qp(e,o[c])),a.push(o[c+1]);for(var h,f,l,p,d=[],y=new Js,v=u.length-1;0<=v;--v){$p(d,u[v])||(h=u[v],f=a[v],l=s._f(h),f instanceof op&&f.K_ instanceof sp?d.push(h):null!=(p=Wp(f,l))&&(d.push(h),y.set(h,p)))}var g=new Ns(d);return new Sp(y.ze(),g,s.fieldTransforms)}function Hp(t,e,n,r){return void 0===r&&(r=!1),Wp(n,t.wf(r?4:3,e))}function Wp(s,t){if(Yp(s))return Xp("Unsupported field value:",t,s),Kp(s,t);if(s instanceof op)return function(t,e){if(!Up(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.X_&&4!==t.H_)throw t.Y_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Wp(i[r],t.ff(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Mo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:Fo(e.serializer,n)}}if(t instanceof ti){var r=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Fo(e.serializer,r)}}if(t instanceof Tp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ep)return{bytesValue:qo(e.serializer,t)};if(t instanceof _p){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Go(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+zl(t))}(s,t)}function Kp(t,r){var i={};return Kr(t)?r.path&&0<r.path.length&&r.qe.push(r.path):Wr(t,function(t,e){var n=Wp(e,r.cf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Yp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof Tp||t instanceof ep||t instanceof _p||t instanceof op)}function Xp(t,e,n){if(!Yp(n)||!Bl(n)){var r=zl(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function Qp(t,e,n){if(e instanceof np)return e.j_;if("string"==typeof e)return Zp(t,e);throw Jp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Zp(t,e,n){try{return function(e){if(0<=e.search(ip))throw new $r(Jr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(rp.bind.apply(rp,s([void 0],e.split("."))))}catch(t){throw new $r(Jr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw Jp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Jp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new $r(Jr.INVALID_ARGUMENT,(u+=". ")+t+a)}function $p(t,e){return t.some(function(t){return t.isEqual(e)})}var td=(od.prototype.Af=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),0<this.mutations.length)throw new $r(Jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Yo((i=u).serializer)+"/documents",n={documents:a.map(function(t){return zo(i.serializer,t)})},[4,i.Sa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Vr(!!e.found),e.found.name,e.found.updateTime;var n=Ho(t,e.found.name),r=jo(e.found.updateTime),i=new Zs({mapValue:{fields:e.found.fields}});return new uu(n,r,i,{})}(e,n):"missing"in n?function(t,e){Vr(!!e.missing),Vr(!!e.readTime);var n=Ho(t,e.missing),r=jo(e.readTime);return new au(n,r)}(e,n):Cr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Vr(!!e),s.push(e)}),s)]}})})}(this.qa,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof au||t instanceof uu?n.Pf(t):Cr()}),e)]}})})},od.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.mf.add(t.toString())},od.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.If=t}this.mf.add(t.toString())},od.prototype.delete=function(t){this.write([new Xs(t,this.Qe(t))]),this.mf.add(t.toString())},od.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),this.If)throw this.If;return e=this.Tf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=si.B(e);r.mutations.push(new Qs(n,r.Qe(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Yo((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Zo(e.serializer,t)})},[4,e.va("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qa,this.mutations)];case 1:return t.sent(),this.Ef=!0,[2]}})})},od.prototype.Pf=function(t){var e;if(t instanceof uu)e=t.version;else{if(!(t instanceof au))throw Cr();e=ei.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new $r(Jr.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},od.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.mf.has(t.toString())&&e?Ds.updateTime(e):Ds.We()},od.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(this.mf.has(t.toString())||!e)return Ds.exists(!0);if(e.isEqual(ei.min()))throw new $r(Jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ds.updateTime(e)},od.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},od.prototype.Rf=function(){},od),ed=(id.prototype.run=function(){this.yf()},id.prototype.yf=function(){var t=this;this.Ti.bs(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new td(this.qa),(n=this.pf(e))&&n.then(function(t){r.ei.ai(function(){return e.commit().then(function(){r.ii.resolve(t)}).catch(function(t){r.bf(t)})})}).catch(function(t){r.bf(t)}),[2]})})})},id.prototype.pf=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},id.prototype.bf=function(t){var e=this;0<this.Vf&&this.vf(t)?(--this.Vf,this.ei.ai(function(){return e.yf(),Promise.resolve()})):this.ii.reject(t)},id.prototype.vf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ri(e)},id),nd=(rd.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new Ia,s=!1;return this.credentials.Bh(function(t){return s?void i.ei.gi(function(){return i.Bc.vu(t)}):(s=!0,Lr("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject))}),this.ei.ai(function(){return i.Sf.promise}),o.promise},rd.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!0),t.Bc.enableNetwork()})},rd.prototype.Cf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:u,Qc:100,k_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Uc=i.Uc,this.La=i.La,this.S_=i.S_,this.qa=o.qa,this.Bc=o.Bc,this.fu=o.fu,this.Nf=o.q_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Ff(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Cf(new Il,new Nl,{F_:!1},u,a))];case 4:return[2]}})})},rd.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===Jr.FAILED_PRECONDITION||t.code===Jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},rd.prototype.Df=function(){if(this.ei.Ii)throw new $r(Jr.FAILED_PRECONDITION,"The client has already been terminated.")},rd.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!1),t.Bc.disableNetwork()})},rd.prototype.terminate=function(){var t=this;this.ei.Pi();var r=new Ia;return this.ei.mi(function(){return g(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bc.th()];case 1:return t.sent(),[4,this.Uc.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.Uh(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Wa(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},rd.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new Ia;return this.ei.ai(function(){return t.fu._l(e)}),e.promise},rd.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new Rl(n),o=new Gf(t,i,e);return this.ei.ai(function(){return r.Nf.listen(o)}),function(){i.Q_(),r.ei.ai(function(){return r.Nf.lu(o)})}},rd.prototype.kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,u,a){return g(this,void 0,void 0,function(){var s,e=this;return w(this,function(t){switch(t.label){case 0:return s=new Ia,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Rh.Hn(t,e)}))];case 1:return(r=t.sent())instanceof uu?s.resolve(r):r instanceof au?s.resolve(null):s.reject(new $r(Jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Wa(i,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.ei,this.La,e))]}})})},rd.prototype.$f=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new Ia,s=sd(e,n,gu(r.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new $r(Jr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new $r(Jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},rd.prototype.xf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,a,c){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new Ia,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,kh(a,c,!0)];case 1:return e=t.sent(),n=new Tf(c,e.gh),r=n.Sc(e.documents),i=n.Un(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Wa(o,"Failed to execute query '"+c+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ei,this.La,e))]}})})},rd.prototype.Of=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new Ia,s=sd(e,n,r,{includeMetadataChanges:!0,$l:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new $r(Jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},rd.prototype.write=function(t){var e=this;this.Df();var n=new Ia;return this.ei.ai(function(){return e.fu.write(t,n)}),n.promise},rd.prototype.s=function(){return this.w_.s},rd.prototype.bl=function(t){var e=this;this.Df();var n=new Rl(t);return this.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.bl(n)]})})}),function(){n.Q_(),e.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.vl(n)]})})})}},Object.defineProperty(rd.prototype,"Mf",{get:function(){return this.ei.Ii},enumerable:!1,configurable:!0}),rd.prototype.transaction=function(t){var e=this;this.Df();var n=new Ia;return this.ei.ai(function(){return new ed(e.ei,e.qa,t,n).run(),Promise.resolve()}),n.promise},rd);function rd(t,e){this.credentials=t,this.ei=e,this.clientId=Ur.t(),this.Sf=new Ia}function id(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new Na(this.ei,"transaction_retry")}function od(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.If=null,this.mf=new Set}function sd(t,e,n,r,i){var o=new Rl(i),s=new Gf(n,o,r);return t.ai(function(){return e.listen(s)}),function(){o.Q_(),t.ai(function(){return e.lu(s)})}}var ud,ad,cd=(Sd.prototype.Bf=function(t){switch(mo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return _o(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new ep(Ao(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw Cr()}},Sd.prototype.Gf=function(t){var n=this,r={};return Wr(t.fields||{},function(t,e){r[t]=n.Bf(e)}),r},Sd.prototype.jf=function(t){return new Tp(_o(t.latitude),_o(t.longitude))},Sd.prototype.Kf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Bf(t)})},Sd.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return yo(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(vo(t));default:return null}},Sd.prototype.Uf=function(t){var e=No(t),n=new ti(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Sd.prototype.Wf=function(t){var e=ri.k(t);Vr(os(e));var n=new Br(e.get(1),e.get(3)),r=new si(e.V(5));return n.isEqual(this.s)||xr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},Sd),hd=Qa.ji,fd=(Ad.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ad),ld=(Object.defineProperty(_d.prototype,"rd",{get:function(){return this.od||(this.od=new Fp(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),_d.prototype.settings=function(t){Ol("Firestore.settings",arguments,1),Vl("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.sd),t)).merge;var e=new fd(t);if(this.Zf&&!this.sd.isEqual(e))throw new $r(Jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.sd=e).credentials&&(this.nd=function(t){if(!t)return new Gh;switch(t.type){case"gapi":var e=t.hd;return Vr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Hh(e,t.zh||"0");case"provider":return t.hd;default:throw new $r(Jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},_d.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},_d.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},_d.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new $r(Jr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&xr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new $r(Jr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},_d.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.Zf&&!this.Zf.Mf)throw new $r(Jr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ia,[2,(this.Jf.mi(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},_d.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(_d.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),_d.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},_d.prototype.onSnapshotsInSync=function(t){if(this.Xf(),kl(t))return this.Zf.bl(t);Vl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},_d.prototype.Xf=function(){return this.Zf||this.ad(new Il,new Nl,{F_:!1}),this.Zf},_d.prototype.ld=function(){return new Gr(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.experimentalForceLongPolling)},_d.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new nd(this.nd,this.Jf),this.Zf.start(r,t,e,n)},_d.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new $r(Jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new $r(Jr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Br(n)},Object.defineProperty(_d.prototype,"app",{get:function(){if(!this.Yf)throw new $r(Jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),_d.prototype.collection=function(t){return Ol("Firestore.collection",arguments,1),Vl("Firestore.collection","non-empty string",1,t),this.Xf(),new Cd(ri.k(t),this,null)},_d.prototype.doc=function(t){return Ol("Firestore.doc",arguments,1),Vl("Firestore.doc","non-empty string",1,t),this.Xf(),yd._d(ri.k(t),this,null)},_d.prototype.collectionGroup=function(t){if(Ol("Firestore.collectionGroup",arguments,1),Vl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new Od((e=t,new du(ri.$(),e)),this,null);var e},_d.prototype.runTransaction=function(e){var n=this;return Ol("Firestore.runTransaction",arguments,1),Vl("Firestore.runTransaction","function",1,e),this.Xf().transaction(function(t){return e(new pd(n,t))})},_d.prototype.batch=function(){return this.Xf(),new dd(this)},Object.defineProperty(_d,"logLevel",{get:function(){switch(Rr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),_d.setLogLevel=function(t){Ol("Firestore.setLogLevel",arguments,1),jl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),kr.setLogLevel(t)},_d.prototype.fd=function(){return this.sd.timestampsInSnapshots},_d.prototype.dd=function(){return this.sd},_d),pd=(Nd.prototype.get=function(t){var n=this;Ol("Transaction.get",arguments,1);var r=Gd("Transaction.get",t,this.wd);return this.Td.Af([r.if]).then(function(t){if(!t||1!==t.length)return Cr();var e=t[0];if(e instanceof au)return new gd(n.wd,r.if,null,!1,!1,r.rf);if(e instanceof uu)return new gd(n.wd,r.if,e,!1,!1,r.rf);throw Cr()})},Nd.prototype.set=function(t,e,n){Cl("Transaction.set",arguments,2,3);var r=Gd("Transaction.set",t,this.wd);n=Fd("Transaction.set",n);var i=Bd(r.rf,e,n),o=Gp(this.wd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.Td.set(r.if,o),this},Nd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof rp?(Pl("Transaction.update",arguments,3),r=Gd("Transaction.update",t,this.wd),zp(this.wd.rd,"Transaction.update",r.if,e,n,o)):(Ol("Transaction.update",arguments,2),r=Gd("Transaction.update",t,this.wd),Bp(this.wd.rd,"Transaction.update",r.if,e)),this.Td.update(r.if,i),this},Nd.prototype.delete=function(t){Ol("Transaction.delete",arguments,1);var e=Gd("Transaction.delete",t,this.wd);return this.Td.delete(e.if),this},Nd),dd=(Td.prototype.set=function(t,e,n){Cl("WriteBatch.set",arguments,2,3),this.md();var r=Gd("WriteBatch.set",t,this.wd);n=Fd("WriteBatch.set",n);var i=Bd(r.rf,e,n),o=Gp(this.wd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Ed=this.Ed.concat(o.hf(r.if,Ds.We())),this},Td.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),i="string"==typeof e||e instanceof rp?(Pl("WriteBatch.update",arguments,3),r=Gd("WriteBatch.update",t,this.wd),zp(this.wd.rd,"WriteBatch.update",r.if,e,n,o)):(Ol("WriteBatch.update",arguments,2),r=Gd("WriteBatch.update",t,this.wd),Bp(this.wd.rd,"WriteBatch.update",r.if,e)),this.Ed=this.Ed.concat(i.hf(r.if,Ds.exists(!0))),this},Td.prototype.delete=function(t){Ol("WriteBatch.delete",arguments,1),this.md();var e=Gd("WriteBatch.delete",t,this.wd);return this.Ed=this.Ed.concat(new Xs(e.if,Ds.We())),this},Td.prototype.commit=function(){return this.md(),this.Id=!0,0<this.Ed.length?this.wd.Xf().write(this.Ed):Promise.resolve()},Td.prototype.md=function(){if(this.Id)throw new $r(Jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Td),yd=(o(Id,ad=_p),Id._d=function(t,e,n){if(t.length%2!=0)throw new $r(Jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new Id(new si(t),e,n)},Object.defineProperty(Id.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"parent",{get:function(){return new Cd(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(Id.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),Id.prototype.collection=function(t){if(Ol("DocumentReference.collection",arguments,1),Vl("DocumentReference.collection","non-empty string",1,t),!t)throw new $r(Jr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ri.k(t);return new Cd(this.if.path.child(e),this.firestore,null)},Id.prototype.isEqual=function(t){if(!(t instanceof Id))throw Kl("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},Id.prototype.set=function(t,e){Cl("DocumentReference.set",arguments,1,2),e=Fd("DocumentReference.set",e);var n=Bd(this.rf,t,e),r=Gp(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,Ds.We()))},Id.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof rp?(Pl("DocumentReference.update",arguments,2),zp(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(Ol("DocumentReference.update",arguments,1),Bp(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,Ds.exists(!0)))},Id.prototype.delete=function(){return Ol("DocumentReference.delete",arguments,0),this.Zf.write([new Xs(this.if,Ds.We())])},Id.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Cl("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||kl(i[u])||(Wl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Fl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,c={includeMetadataChanges:s.includeMetadataChanges};kl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Vl("DocumentReference.onSnapshot","function",u,i[u]),Ul("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ul("DocumentReference.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](r.Ad(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(gu(this.if.path),c,h)},Id.prototype.get=function(t){var e=this;Cl("DocumentReference.get",arguments,0,1),jd("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then(function(t){return new gd(e.firestore,e.if,t,!0,t instanceof uu&&t.Ge,e.rf)}):n.$f(this.if,t).then(function(t){return e.Ad(t)})},Id.prototype.withConverter=function(t){return new Id(this.if,this.firestore,t)},Id.prototype.Ad=function(t){var e=t.docs.get(this.if);return new gd(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},Id),vd=(Ed.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ed),gd=(bd.prototype.data=function(t){var e=this;if(Cl("DocumentSnapshot.data",arguments,0,1),t=qd("DocumentSnapshot.data",t),this.Rd){if(this.rf){var n=new md(this.wd,this.if,this.Rd,this.Pd,this.gd,null);return this.rf.fromFirestore(n,t)}return new cd(this.wd.sf,this.wd.fd(),t.serverTimestamps||"none",function(t){return new yd(t,e.wd,null)}).Bf(this.Rd.tn())}},bd.prototype.get=function(t,e){var n=this;if(Cl("DocumentSnapshot.get",arguments,1,2),e=qd("DocumentSnapshot.get",e),this.Rd){var r=this.Rd.data().field(Qp("DocumentSnapshot.get",t,this.if));if(null!==r)return new cd(this.wd.sf,this.wd.fd(),e.serverTimestamps||"none",function(t){return new yd(t,n.wd,n.rf)}).Bf(r)}},Object.defineProperty(bd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"ref",{get:function(){return new yd(this.if,this.wd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"exists",{get:function(){return null!==this.Rd},enumerable:!1,configurable:!0}),Object.defineProperty(bd.prototype,"metadata",{get:function(){return new vd(this.gd,this.Pd)},enumerable:!1,configurable:!0}),bd.prototype.isEqual=function(t){if(!(t instanceof bd))throw Kl("isEqual","DocumentSnapshot",1,t);return this.wd===t.wd&&this.Pd===t.Pd&&this.if.isEqual(t.if)&&(null===this.Rd?null===t.Rd:this.Rd.isEqual(t.Rd))&&this.rf===t.rf},bd),md=(o(wd,ud=gd),wd.prototype.data=function(t){return ud.prototype.data.call(this,t)},wd);function wd(){return null!==ud&&ud.apply(this,arguments)||this}function bd(t,e,n,r,i,o){this.wd=t,this.if=e,this.Rd=n,this.Pd=r,this.gd=i,this.rf=o}function Ed(t,e){this.hasPendingWrites=t,this.fromCache=e}function Id(t,e,n){var r=this;return(r=ad.call(this,e.sf,t,n)||this).if=t,r.firestore=e,r.rf=n,r.Zf=r.firestore.Xf(),r}function Td(t){this.wd=t,this.Ed=[],this.Id=!1}function Nd(t,e){this.wd=t,this.Td=e}function _d(t,e,n,r){var i=this;if(void 0===n&&(n=new Il),void 0===r&&(r=new Nl),this.zf=n,this.Hf=r,this.Yf=null,this.Jf=new Ba,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Yf=o,this.sf=_d.td(o),this.ed=o.name,this.nd=new Bh(e)}else{var s=t;if(!s.projectId)throw new $r(Jr.INVALID_ARGUMENT,"Must provide projectId");this.sf=new Br(s.projectId,s.database),this.ed="[DEFAULT]",this.nd=new Gh}this.sd=new fd({})}function Ad(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new $r(Jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ml("settings","non-empty string","host",t.host),this.host=t.host,Fl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Wl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Fl("settings","object","credentials",t.credentials),this.credentials=t.credentials,Fl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Fl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?xr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&xr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Fl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Qa.Gi;else{if(t.cacheSizeBytes!==hd&&t.cacheSizeBytes<Qa.Ki)throw new $r(Jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Qa.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Fl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Sd(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}function Dd(t,e,n){if("string"==typeof n){if(""===n)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!mu(e)&&-1!==n.indexOf("/"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ri.k(n));if(!si.j(r))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return So(t,new si(r))}if(n instanceof _p)return So(t,n.if);throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+zl(n)+".")}function kd(t,e){if(!Array.isArray(t)||0===t.length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Rd(t,e,n){if(!n.isEqual(e))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ld(t){if(t.un()&&0===t.en.length)throw new $r(Jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var xd,Od=(Md.prototype.where=function(t,e,n){var r;Ol("Query.where",arguments,3),Hl("Query.where",3,n),r="not-in"===e||"!="===e?e:jl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=Qp("Query.where",t),u=function(t,e,n,r,i,o,s){var u;if(i.M()){if("array-contains"===o||"array-contains-any"===o)throw new $r(Jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){kd(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Dd(r,t,f))}u={arrayValue:{values:a}}}else u=Dd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||kd(s,o),u=Hp(n,e,s,"in"===o||"not-in"===o);var l=Ru.create(i,o,u);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.cn();null!==r&&Rd(0,e.field,r)}var i=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new $r(Jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new $r(Jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(this.Vd,"Query.where",this.firestore.rd,this.firestore.sf,s,r,n);return new Md((i=this.Vd,o=i.filters.concat([u]),new du(i.path,i.collectionGroup,i.en.slice(),o,i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.rf)},Md.prototype.orderBy=function(t,e){var n;if(Cl("Query.orderBy",arguments,1,2),Ul("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new $r(Jr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=Qp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new ia(e,n);return i=s,null!==(r=t).cn()||null!==(o=r.ln())&&Rd(0,o,i.field),s}(this.Vd,o,n);return new Md((r=this.Vd,i=r.en.concat([s]),new du(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.rf)},Md.prototype.limit=function(t){return Ol("Query.limit",arguments,1),Vl("Query.limit","number",1,t),Yl("Query.limit",1,t),new Md(Eu(this.Vd,t,"F"),this.firestore,this.rf)},Md.prototype.limitToLast=function(t){return Ol("Query.limitToLast",arguments,1),Vl("Query.limitToLast","number",1,t),Yl("Query.limitToLast",1,t),new Md(Eu(this.Vd,t,"L"),this.firestore,this.rf)},Md.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Pl("Query.startAt",arguments,1);var r=this.yd("Query.startAt",t,e,!0);return new Md(Iu(this.Vd,r),this.firestore,this.rf)},Md.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Pl("Query.startAfter",arguments,1);var r=this.yd("Query.startAfter",t,e,!1);return new Md(Iu(this.Vd,r),this.firestore,this.rf)},Md.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Pl("Query.endBefore",arguments,1);var r=this.yd("Query.endBefore",t,e,!0);return new Md(Tu(this.Vd,r),this.firestore,this.rf)},Md.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Pl("Query.endAt",arguments,1);var r=this.yd("Query.endAt",t,e,!1);return new Md(Tu(this.Vd,r),this.firestore,this.rf)},Md.prototype.isEqual=function(t){if(!(t instanceof Md))throw Kl("isEqual","Query",1,t);return this.firestore===t.firestore&&Nu(this.Vd,t.Vd)&&this.rf===t.rf},Md.prototype.withConverter=function(t){return new Md(this.Vd,this.firestore,t)},Md.prototype.yd=function(h,t,e,n){if(Hl(h,1,t),t instanceof gd)return Ol(h,s([t],e),1),function(t,e,n,r){if(!n)throw new $r(Jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=wu(t);o<s.length;o++){var u=s[o];if(u.field.M())i.push(So(e,n.key));else{var a=n.field(u.field);if(yo(a))throw new $r(Jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var c=u.field.F();throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Qu(i,r)}(this.Vd,this.firestore.sf,t.Rd,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new $r(Jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.M()){if("string"!=typeof c)throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!mu(t)&&-1!==c.indexOf("/"))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ri.k(c));if(!si.j(h))throw new $r(Jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new si(h);u.push(So(e,f))}else{var l=Hp(n,r,c);u.push(l)}}return new Qu(u,o)}(this.Vd,this.firestore.sf,this.firestore.rd,h,r,n)},Md.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Cl("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||kl(i[a])||(Wl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Fl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),kl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Vl("Query.onSnapshot","function",a,i[a]),Ul("Query.onSnapshot","function",a+1,i[a+1]),Ul("Query.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](new Pd(r.firestore,r.Vd,t,r.rf))},error:i[a+1],complete:i[a+2]};return Ld(this.Vd),this.firestore.Xf().listen(this.Vd,u,c)},Md.prototype.get=function(t){var e=this;Cl("Query.get",arguments,0,1),jd("Query.get",t),Ld(this.Vd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.Vd):n.Of(this.Vd,t)).then(function(t){return new Pd(e.firestore,e.Vd,t,e.rf)})},Md),Pd=(Object.defineProperty(Ud.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"empty",{get:function(){return this.bd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Ud.prototype,"size",{get:function(){return this.bd.docs.size},enumerable:!1,configurable:!0}),Ud.prototype.forEach=function(e,n){var r=this;Cl("QuerySnapshot.forEach",arguments,1,2),Vl("QuerySnapshot.forEach","function",1,e),this.bd.docs.forEach(function(t){e.call(n,r.Dd(t,r.metadata.fromCache,r.bd.qt.has(t.key)))})},Object.defineProperty(Ud.prototype,"query",{get:function(){return new Od(this.pd,this.wd,this.rf)},enumerable:!1,configurable:!0}),Ud.prototype.docChanges=function(t){t&&(Wl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Fl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bd.Ut)throw new $r(Jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vd&&this.Sd===e||(this.vd=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.bd,e,this.Dd.bind(this)),this.Sd=e),this.vd},Ud.prototype.isEqual=function(t){if(!(t instanceof Ud))throw Kl("isEqual","QuerySnapshot",1,t);return this.wd===t.wd&&Nu(this.pd,t.pd)&&this.bd.isEqual(t.bd)&&this.rf===t.rf},Ud.prototype.Dd=function(t,e,n){return new md(this.wd,t.key,t,e,n,this.rf)},Ud),Cd=(o(Vd,xd=Od),Object.defineProperty(Vd.prototype,"id",{get:function(){return this.Vd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"parent",{get:function(){var t=this.Vd.path.p();return t._()?null:new yd(new si(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"path",{get:function(){return this.Vd.path.F()},enumerable:!1,configurable:!0}),Vd.prototype.doc=function(t){Cl("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ur.t()),Vl("CollectionReference.doc","non-empty string",1,t);var e=ri.k(t);return yd._d(this.Vd.path.child(e),this.firestore,this.rf)},Vd.prototype.add=function(t){Ol("CollectionReference.add",arguments,1),Vl("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Vd.prototype.withConverter=function(t){return new Vd(this.Cd,this.firestore,t)},Vd);function Vd(t,e,n){var r=this;if(((r=xd.call(this,gu(t),e,n)||this).Cd=t).length%2!=1)throw new $r(Jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Ud(t,e,n,r){this.wd=t,this.pd=e,this.bd=n,this.rf=r,this.vd=null,this.Sd=null,this.metadata=new vd(n.hasPendingWrites,n.fromCache)}function Md(t,e,n){this.Vd=t,this.firestore=e,this.rf=n}function Fd(t,e){if(void 0===e)return{merge:!1};if(Wl(t,e,["merge","mergeFields"]),Fl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+zl(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new $r(Jr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+zl(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof rp}),void 0!==e.mergeFields&&void 0!==e.merge)throw new $r(Jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function qd(t,e){return void 0===e?{}:(Wl(t,e,["serverTimestamps"]),ql(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function jd(t,e){Ul(t,"object",1,e),e&&(Wl(t,e,["source"]),ql(t,0,"source",e.source,["default","server","cache"]))}function Gd(t,e,n){if(e instanceof _p){if(e.firestore!==n)throw new $r(Jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Kl(t,"DocumentReference",1,e)}function Bd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var zd,Hd={Firestore:ld,GeoPoint:Tp,Timestamp:ti,Blob:ep,Transaction:pd,WriteBatch:dd,DocumentReference:yd,DocumentSnapshot:gd,Query:Od,QueryDocumentSnapshot:md,QuerySnapshot:Pd,CollectionReference:Cd,FieldPath:rp,FieldValue:Ep,setLogLevel:ld.setLogLevel,CACHE_SIZE_UNLIMITED:hd};(zd=r.default).INTERNAL.registerComponent(new Sr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Nl,i=new Tl(r),new ld(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Hd))),zd.registerVersion("@firebase/firestore","1.16.6")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
